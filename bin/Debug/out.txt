//////////////////////////////////////////////////////
// \MapCutter.sln
//////////////////////////////////////////////////////

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.4.33110.190
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutter", "MapCutter\MapCutter.csproj", "{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Solution Items", "Solution Items", "{5A9877DF-3D89-497C-8848-44B071D4C82C}"
	ProjectSection(SolutionItems) = preProject
		code.txt = code.txt
		dev-map.txt = dev-map.txt
		dev-vips.txt = dev-vips.txt
		dev-webview.txt = dev-webview.txt
		dev.md = dev.md
		sparkle.txt = sparkle.txt
		task.txt = task.txt
	EndProjectSection
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutterRegistor", "MapCutterRegistor\MapCutterRegistor.csproj", "{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutter.Licenses", "MapCutter.Licenses\MapCutter.Licenses.csproj", "{4C8C1A87-1F81-4E64-909F-C190754849C7}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutterTests", "MapCutterTests\MapCutterTests.csproj", "{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Release", "Release", "{CF5A4063-A082-4E13-9D08-2C09CAD31059}"
	ProjectSection(SolutionItems) = preProject
		MapCutterRelease\readme.md = MapCutterRelease\readme.md
	EndProjectSection
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutter.Components", "MapCutter.Components\MapCutter.Components.csproj", "{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapPainter", "MapPainter\MapPainter.csproj", "{77842350-D27A-4B8D-BBBB-BD4A52B586A3}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "MapCutterConsole", "MapCutterConsole\MapCutterConsole.csproj", "{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Debug|ARM = Debug|ARM
		Debug|ARM64 = Debug|ARM64
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Debug45|Any CPU = Debug45|Any CPU
		Debug45|ARM = Debug45|ARM
		Debug45|ARM64 = Debug45|ARM64
		Debug45|x64 = Debug45|x64
		Debug45|x86 = Debug45|x86
		Release|Any CPU = Release|Any CPU
		Release|ARM = Release|ARM
		Release|ARM64 = Release|ARM64
		Release|x64 = Release|x64
		Release|x86 = Release|x86
		Release45|Any CPU = Release45|Any CPU
		Release45|ARM = Release45|ARM
		Release45|ARM64 = Release45|ARM64
		Release45|x64 = Release45|x64
		Release45|x86 = Release45|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|ARM.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|ARM64.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|x64.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|x64.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|x86.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug|x86.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|ARM.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|x64.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Debug45|x86.Build.0 = Debug|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|Any CPU.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|ARM.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|ARM.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|ARM64.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|ARM64.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|x64.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|x64.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|x86.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release|x86.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|Any CPU.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|ARM.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|ARM.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|ARM64.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|x64.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|x64.Build.0 = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|x86.ActiveCfg = Release|Any CPU
		{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}.Release45|x86.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|ARM.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|ARM64.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|x64.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|x64.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|x86.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug|x86.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|ARM.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|x64.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Debug45|x86.Build.0 = Debug|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|Any CPU.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|ARM.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|ARM.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|ARM64.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|ARM64.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|x64.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|x64.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|x86.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release|x86.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|Any CPU.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|ARM.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|ARM.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|ARM64.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|x64.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|x64.Build.0 = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|x86.ActiveCfg = Release|Any CPU
		{0C74BD95-1DEB-40B2-AEF1-9DB176E60587}.Release45|x86.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|ARM.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|ARM64.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|x64.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|x64.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|x86.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug|x86.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|ARM.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|x64.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Debug45|x86.Build.0 = Debug|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|Any CPU.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|ARM.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|ARM.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|ARM64.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|ARM64.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|x64.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|x64.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|x86.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release|x86.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|Any CPU.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|ARM.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|ARM.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|ARM64.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|x64.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|x64.Build.0 = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|x86.ActiveCfg = Release|Any CPU
		{4C8C1A87-1F81-4E64-909F-C190754849C7}.Release45|x86.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|ARM.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|ARM64.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|x64.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|x64.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|x86.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug|x86.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|ARM.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|x64.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Debug45|x86.Build.0 = Debug|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|Any CPU.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|ARM.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|ARM.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|ARM64.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|ARM64.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|x64.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|x64.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|x86.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release|x86.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|Any CPU.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|ARM.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|ARM.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|ARM64.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|x64.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|x64.Build.0 = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|x86.ActiveCfg = Release|Any CPU
		{3A82EA5F-BA00-4A82-AF51-261FCE840FC7}.Release45|x86.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|ARM.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|ARM64.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|x64.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|x64.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|x86.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug|x86.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|ARM.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|x64.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Debug45|x86.Build.0 = Debug|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|Any CPU.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|ARM.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|ARM.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|ARM64.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|ARM64.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|x64.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|x64.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|x86.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release|x86.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|Any CPU.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|ARM.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|ARM.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|ARM64.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|x64.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|x64.Build.0 = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|x86.ActiveCfg = Release|Any CPU
		{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}.Release45|x86.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|ARM.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|ARM64.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|x64.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|x64.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|x86.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug|x86.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|ARM.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|x64.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Debug45|x86.Build.0 = Debug|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|Any CPU.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|ARM.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|ARM.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|ARM64.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|ARM64.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|x64.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|x64.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|x86.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release|x86.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|Any CPU.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|ARM.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|ARM.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|ARM64.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|x64.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|x64.Build.0 = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|x86.ActiveCfg = Release|Any CPU
		{77842350-D27A-4B8D-BBBB-BD4A52B586A3}.Release45|x86.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|ARM.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|ARM.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|ARM64.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|ARM64.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|x64.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|x64.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|x86.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug|x86.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|Any CPU.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|Any CPU.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|ARM.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|ARM.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|ARM64.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|ARM64.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|x64.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|x64.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|x86.ActiveCfg = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Debug45|x86.Build.0 = Debug|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|Any CPU.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|ARM.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|ARM.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|ARM64.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|ARM64.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|x64.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|x64.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|x86.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release|x86.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|Any CPU.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|Any CPU.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|ARM.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|ARM.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|ARM64.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|ARM64.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|x64.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|x64.Build.0 = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|x86.ActiveCfg = Release|Any CPU
		{C0CB4F0B-2C29-4FA2-AFCE-43FBDA4F63D4}.Release45|x86.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {DC2CE7C1-6D50-4BAA-8295-942A27F6FC96}
	EndGlobalSection
EndGlobal


//////////////////////////////////////////////////////
// \MapCutter\MapCutter.csproj
//////////////////////////////////////////////////////
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{5A9ACF7E-0872-48B6-9324-5FA1B80D153B}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <RootNamespace>MapCutter</RootNamespace>
    <AssemblyName>MapCutter</AssemblyName>
    <TargetFrameworkVersion>v4.6.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <IsWebBootstrapper>false</IsWebBootstrapper>
    <TargetFrameworkProfile />
    <PublishUrl>publish\</PublishUrl>
    <Install>true</Install>
    <InstallFrom>Disk</InstallFrom>
    <UpdateEnabled>true</UpdateEnabled>
    <UpdateMode>Foreground</UpdateMode>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>Days</UpdateIntervalUnits>
    <UpdatePeriodically>false</UpdatePeriodically>
    <UpdateRequired>false</UpdateRequired>
    <MapFileExtensions>true</MapFileExtensions>
    <ApplicationRevision>1</ApplicationRevision>
    <ApplicationVersion>1.0.0.%2a</ApplicationVersion>
    <UseApplicationTrust>false</UseApplicationTrust>
    <PublishWizardCompleted>true</PublishWizardCompleted>
    <BootstrapperEnabled>true</BootstrapperEnabled>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <Prefer32Bit>false</Prefer32Bit>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>map.ico</ApplicationIcon>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestCertificateThumbprint>9D722CB8DBDDBDB78F03F389EBFD4A44260A0454</ManifestCertificateThumbprint>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestKeyFile>MapTiler_TemporaryKey.pfx</ManifestKeyFile>
  </PropertyGroup>
  <PropertyGroup>
    <GenerateManifests>true</GenerateManifests>
  </PropertyGroup>
  <PropertyGroup>
    <SignManifests>false</SignManifests>
  </PropertyGroup>
  <PropertyGroup>
    <SignAssembly>false</SignAssembly>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyOriginatorKeyFile>
    </AssemblyOriginatorKeyFile>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="CommonMark, Version=0.1.0.0, Culture=neutral, PublicKeyToken=001ef8810438905d, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>bin\Debug\CommonMark.dll</HintPath>
    </Reference>
    <Reference Include="DevComponents.DotNetBar.SuperGrid, Version=12.8.0.6, Culture=neutral, PublicKeyToken=7eb7c3a35b91de04, processorArchitecture=MSIL" />
    <Reference Include="DevComponents.DotNetBar2, Version=12.8.0.6, Culture=neutral, PublicKeyToken=7eb7c3a35b91de04, processorArchitecture=MSIL" />
    <Reference Include="DevComponents.Instrumentation, Version=12.8.0.6, Culture=neutral, PublicKeyToken=f90dc37c26666a67" />
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.IO.Compression" />
    <Reference Include="System.IO.Compression.FileSystem" />
    <Reference Include="System.Runtime.Caching" />
    <Reference Include="System.Web" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Deployment" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Components\WebViewLifeSpanHandler.cs" />
    <Compile Include="Components\UICommon.cs" />
    <Compile Include="Components\IUIConfig.cs" />
    <Compile Include="Components\WebViewMenuHandler.cs" />
    <Compile Include="Components\Win\UI.cs" />
    <Compile Include="Components\Win\Win32.cs" />
    <Compile Include="Components\Win\WizardSteps.cs" />
    <Compile Include="Forms\FormMergeMapTiles.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormMergeMapTiles.Designer.cs">
      <DependentUpon>FormMergeMapTiles.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormWebServer.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormWebServer.Designer.cs">
      <DependentUpon>FormWebServer.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormWelcome.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormWelcome.Designer.cs">
      <DependentUpon>FormWelcome.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormAbout.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormAbout.Designer.cs">
      <DependentUpon>FormAbout.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormConfig.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormConfig.Designer.cs">
      <DependentUpon>FormConfig.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormMain.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormMain.Designer.cs">
      <DependentUpon>FormMain.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormMergeMapFolders.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormMergeMapFolders.Designer.cs">
      <DependentUpon>FormMergeMapFolders.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormTest.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormTest.Designer.cs">
      <DependentUpon>FormTest.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormLoading.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormLoading.Designer.cs">
      <DependentUpon>FormLoading.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormWeb.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormWeb.Designer.cs">
      <DependentUpon>FormWeb.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormPosition.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormPosition.Designer.cs">
      <DependentUpon>FormPosition.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\FormRegist.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FormRegist.Designer.cs">
      <DependentUpon>FormRegist.cs</DependentUpon>
    </Compile>
    <Compile Include="Program.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="Forms\StepBasic.cs">
      <SubType>UserControl</SubType>
    </Compile>
    <Compile Include="Forms\StepBasic.Designer.cs">
      <DependentUpon>StepBasic.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\StepPreview.cs">
      <SubType>UserControl</SubType>
    </Compile>
    <Compile Include="Forms\StepPreview.Designer.cs">
      <DependentUpon>StepPreview.cs</DependentUpon>
    </Compile>
    <Compile Include="Components\Win\ComboBoxPro.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Include="Components\Win\ComboBoxPro.designer.cs">
      <DependentUpon>ComboBoxPro.cs</DependentUpon>
    </Compile>
    <EmbeddedResource Include="Forms\FormMergeMapTiles.resx">
      <DependentUpon>FormMergeMapTiles.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormWebServer.resx">
      <DependentUpon>FormWebServer.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormWelcome.resx">
      <DependentUpon>FormWelcome.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormAbout.resx">
      <DependentUpon>FormAbout.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormConfig.resx">
      <DependentUpon>FormConfig.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormMain.resx">
      <DependentUpon>FormMain.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormMergeMapFolders.resx">
      <DependentUpon>FormMergeMapFolders.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormTest.resx">
      <DependentUpon>FormTest.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormLoading.resx">
      <DependentUpon>FormLoading.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormWeb.resx">
      <DependentUpon>FormWeb.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormPosition.resx">
      <DependentUpon>FormPosition.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FormRegist.resx">
      <DependentUpon>FormRegist.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
      <SubType>Designer</SubType>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
      <DesignTime>True</DesignTime>
    </Compile>
    <EmbeddedResource Include="Forms\StepBasic.resx">
      <DependentUpon>StepBasic.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\StepPreview.resx">
      <DependentUpon>StepPreview.cs</DependentUpon>
    </EmbeddedResource>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Components\Win\ComboBoxPro.resx">
      <DependentUpon>ComboBoxPro.cs</DependentUpon>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="CefSharp.WinForms">
      <Version>96.0.170</Version>
    </PackageReference>
    <PackageReference Include="GDAL.Native">
      <Version>3.6.3</Version>
    </PackageReference>
    <PackageReference Include="ICSharpCode.TextEditor">
      <Version>3.2.1.6466</Version>
    </PackageReference>
    <PackageReference Include="Microsoft-WindowsAPICodePack-Shell">
      <Version>1.1.5</Version>
    </PackageReference>
    <PackageReference Include="NetVips.Native.win-x64">
      <Version>8.12.2</Version>
    </PackageReference>
  </ItemGroup>
  <ItemGroup>
    <Content Include="map.ico" />
    <None Include="Resources\wand.png" />
    <None Include="Resources\pencil.png" />
    <None Include="Resources\画板备份%408x.png" />
    <None Include="Resources\arrow_refresh.png" />
    <None Include="Resources\bug.png" />
    <None Include="Resources\forward.png" />
    <None Include="Resources\lightning.png" />
    <None Include="Resources\page_world.png" />
    <None Include="Resources\reverse_green.png" />
    <None Include="Resources\world.png" />
    <None Include="Resources\connect.png" />
    <None Include="Resources\disconnect.png" />
    <None Include="Resources\html.png" />
    <None Include="Resources\link.png" />
    <None Include="Resources\tag.png" />
    <None Include="Resources\bullet_feed.png" />
    <None Include="Resources\folder_home.png" />
    <None Include="Resources\RibbonGeometry.png" />
    <None Include="Resources\RibbonCircuit.png" />
    <None Include="Resources\RibbonCalligraphy2.png" />
    <None Include="Resources\RibbonDoodleDiamonds.png" />
    <None Include="Resources\RibbonSchoolStuff.png" />
    <None Include="Resources\RibbonSpring.png" />
    <None Include="Resources\RibbonUnderwater.png" />
    <None Include="Resources\map %282%29.png" />
    <None Include="Resources\map %283%29.png" />
    <None Include="Resources\book_open.png" />
    <None Include="Resources\help.png" />
    <None Include="Resources\shield.png" />
    <None Include="Resources\bullet_shape.png" />
    <None Include="Resources\clock.png" />
    <None Include="Resources\hourglass.png" />
    <None Include="Resources\bullet_go.png" />
    <None Include="Resources\text_align_justify.png" />
    <None Include="Resources\860abad3f1ca4f3087f182d983716ebd.gif" />
    <None Include="Resources\cog.png" />
    <None Include="Resources\arrow_in_longer.png" />
    <None Include="Resources\world_go.png" />
    <None Include="Resources\arrow_in_longer1.png" />
    <None Include="Resources\arrow_rotate_anticlockwise.png" />
    <None Include="Resources\build.png" />
    <None Include="Resources\folder.png" />
    <None Include="Resources\About.txt" />
    <None Include="Resources\imageUpload%402x.png" />
    <None Include="Resources\image-upload60%402x.png" />
    <None Include="Resources\image-upload%402x.png" />
    <None Include="Resources\image-upload%402x1.png" />
    <None Include="Resources\map.png" />
    <None Include="Resources\add.png" />
    <None Include="Resources\chart_pie_lightning.png" />
    <Content Include="Resources\map_go.png" />
    <None Include="Resources\world_edit.png" />
    <None Include="Resources\magnifier.png" />
    <None Include="Resources\information.png" />
    <None Include="Resources\wrench.png" />
    <None Include="Resources\zoom.png" />
    <None Include="Resources\anchor.png" />
    <None Include="Resources\cancel.png" />
    <None Include="Resources\disk.png" />
  </ItemGroup>
  <ItemGroup>
    <BootstrapperPackage Include=".NETFramework,Version=v4.6.1">
      <Visible>False</Visible>
      <ProductName>Microsoft .NET Framework 4.6.1 %28x86 和 x64%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\MapCutter.Components\MapCutter.Components.csproj">
      <Project>{f2ab397e-239a-47b5-aa7c-ed6eb6819e83}</Project>
      <Name>MapCutter.Components</Name>
    </ProjectReference>
    <ProjectReference Include="..\MapCutter.Licenses\MapCutter.Licenses.csproj">
      <Project>{4c8c1a87-1f81-4e64-909f-c190754849c7}</Project>
      <Name>MapCutter.Licenses</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>


//////////////////////////////////////////////////////
// \MapCutter\Program.cs
//////////////////////////////////////////////////////
using CefSharp;
using CefSharp.WinForms;
using MapCutter.Forms;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO;
using MapCutter.Components;
using MapCutter.Licenses;

namespace MapCutter
{
    static class Program
    {
        /// <summary>应用程序的主入口点</summary>
        [STAThread]
        static void Main()
        {
            // 鉴权挪到这里
            AppLicense.Current.Verify(typeof(Program).Assembly);

            // CefSharp 初始化，避免布局偏移（CefSharp的Bug）
            var settings = new CefSettings();
            settings.CefCommandLineArgs.Add("disable-gpu", "1"); //添加禁用GPU
            Cef.Initialize(settings);

            // 未处理异常捕捉
            Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);
            Application.ThreadException += (_,e) => HandleException(e.Exception);  // 处理 UI 线程异常
            AppDomain.CurrentDomain.UnhandledException += (_,e) => HandleException(e.ExceptionObject as Exception);  // 处理非 UI 线程异常

            // 主入口
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new FormMain());
            //Application.Run(new FormTest());

            //
            Logger.Release();
        }

        /// <summary>处理异常</summary>
        static void HandleException(Exception ex)
        {
            if (ex == null)
                return;
            if (ex is IOException)
            {
                var msg = string.Format("发生读写异常，请检查系统登录账户及文件路径的访问权限。详细原因：{0}", ex.Message);
                Logger.Error(msg + ex.StackTrace);
                return;
            }
            else
            {
                Logger.Error(ex.Message + "\r\n" + ex.StackTrace);
            }
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\IUIConfig.cs
//////////////////////////////////////////////////////
using System;

namespace MapCutter.Components
{
    /// <summary>主窗口接口</summary>
    public interface IMain
    {
        void ShowDoc();
        void DocChanged();
    }

    /// <summary>配置界面接口</summary>
    public interface IUIConfig
    {
        void Set(IMain main, TileConfig cfg);
        void Get();
        CheckResult Check();
    }

    /// <summary>检测结果</summary>
    public class CheckResult
    {
        public string Info { get; set; }
        public Object Control { get; set; }
        public CheckResult(object control, string info)
        {
            this.Control = control;
            this.Info = info;
        }
    }

}


//////////////////////////////////////////////////////
// \MapCutter\Components\UICommon.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using App.Core;
using DevComponents.DotNetBar.Controls;

namespace MapCutter.Components
{
    /// <summary>
    public static class UICommon
    {
        /// <summary>获取应用版本号文本</summary>
        public static string GetVersion()
        {
            var v = Assembly.GetExecutingAssembly().GetName().Version;
            return $"{v.Major}.{v.Minor}.{v.Build}";
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\WebViewLifeSpanHandler.cs
//////////////////////////////////////////////////////
using CefSharp;
using CefSharp.WinForms;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MapCutter.Components
{
    /// <summary>
    internal class WebViewLifeSpanHandler : ILifeSpanHandler
    {
        public bool DoClose(IWebBrowser chromiumWebBrowser, IBrowser browser)
        {
            return false;
        }

        public void OnAfterCreated(IWebBrowser chromiumWebBrowser, IBrowser browser)
        {

        }

        public void OnBeforeClose(IWebBrowser chromiumWebBrowser, IBrowser browser)
        {

        }

        public bool OnBeforePopup(IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, string targetUrl, string targetFrameName, WindowOpenDisposition targetDisposition, bool userGesture, IPopupFeatures popupFeatures, IWindowInfo windowInfo, IBrowserSettings browserSettings, ref bool noJavascriptAccess, out IWebBrowser newBrowser)
        {
            newBrowser = null; //新窗口为空
            var Browser = (ChromiumWebBrowser)chromiumWebBrowser; //获取浏览器对象
            Browser.Load(targetUrl); //浏览器直接跳转url
            return true; //Return true to cancel the popup creation.
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\WebViewMenuHandler.cs
//////////////////////////////////////////////////////
using CefSharp;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MapCutter.Components
{
    /// <summary>
    internal class WebViewMenuHandler : IContextMenuHandler
    {
        public void OnBeforeContextMenu(IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IContextMenuParams parameters, IMenuModel model)
        {
            model.Clear();
        }

        public bool OnContextMenuCommand(IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IContextMenuParams parameters, CefMenuCommand commandId, CefEventFlags eventFlags)
        {
            return false;
        }

        public void OnContextMenuDismissed(IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame)
        {
        }

        public bool RunContextMenu(IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IContextMenuParams parameters, IMenuModel model, IRunContextMenuCallback callback)
        {
            return false;
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\Win\ComboBoxPro.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace MapCutter.Controls
{
    /// <summary>
    public partial class ComboBoxPro : ComboBox
    {
        public ComboBoxPro()
            : base()
        {
            this.SetStyle(ControlStyles.OptimizedDoubleBuffer, true);

            this.DrawMode = DrawMode.OwnerDrawFixed;
            this.DropDownStyle = ComboBoxStyle.DropDownList;
            this.ItemHeight = 15;

            this.DrawItem += new DrawItemEventHandler(ComboBoxPro_DrawItem);
            this.SelectedIndexChanged +=new EventHandler(ComboBoxPro_SelectedIndexChanged);
        }

        private void ComboBoxPro_DrawItem(object sender, System.Windows.Forms.DrawItemEventArgs e)
        {
            if (e.Index < 0)
                return;

            string text = ((ComboBoxPro)sender).Items[e.Index].ToString();
            Rectangle rect = e.Bounds;
            if ((e.State & DrawItemState.Selected) == 0 || text.IndexOf("*") >= 0)
                e.Graphics.FillRectangle(SystemBrushes.Window, rect);
            else
                e.Graphics.FillRectangle(SystemBrushes.Highlight, rect);

            // 对于不可选行用斜体显示
            if (text.IndexOf("*") >= 0)
            {
                Font fnt = new Font(((ComboBoxPro)sender).Font, FontStyle.Italic);
                e.Graphics.DrawString(text, fnt, Brushes.Gray, rect.X, rect.Y);
            }
            else
            {
                e.Graphics.DrawString(text, ((ComboBoxPro)sender).Font, Brushes.Black, rect.X, rect.Y);
            }
        }

        private void ComboBoxPro_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (this.SelectedIndex >= 0)
            {
                string text = this.Items[this.SelectedIndex].ToString();

                //  如果有星号不可选，且尝试选择前后可用选项
                if (text.IndexOf("*") > 0)
                {
                    bool result = false;

                    if (this.SelectedIndex < this.Items.Count - 1)
                    {
                        for (int i = this.SelectedIndex + 1; i < this.Items.Count; i++)
                        {
                            string str = this.Items[i].ToString();
                            if (str.IndexOf("*") < 0)
                            {
                                this.SelectedIndex = i;
                                result = true;
                                break;
                            }
                        }
                    }

                    if (result == false && this.SelectedIndex > 0)
                    {
                        for (int i = this.SelectedIndex - 1; i >= 0; i--)
                        {
                            string str = this.Items[i].ToString();
                            if (str.IndexOf("*") < 0)
                            {
                                this.SelectedIndex = i;
                                break;
                            }
                        }
                    }
                }
            }
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\Win\ComboBoxPro.designer.cs
//////////////////////////////////////////////////////
namespace MapCutter.Controls
{
    partial class ComboBoxPro
    {
        /// <summary> 
        private System.ComponentModel.IContainer components = null;

        /// <summary> 
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region 组件设计器生成的代码

        /// <summary> 
        private void InitializeComponent()
        {
            this.SuspendLayout();
            // 
            this.Name = "myCombo";
            this.ResumeLayout(false);

        }

        #endregion
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\Win\UI.cs
//////////////////////////////////////////////////////
using App.Core;
using DevComponents.DotNetBar.Controls;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Components
{
    public static class UI
    {
        //--------------------------------------------------
        public static Form GetMainForm(string mainFormName = "FormMain")
        {
            if (string.IsNullOrEmpty(mainFormName))
                return null;
            foreach (Form frm in Application.OpenForms)
            {
                if (frm.Name == mainFormName)
                    return frm;
            }
            return null;
        }

        //--------------------------------------------------
        public static void Info(string msg)
        {
            DesktopAlert.Show(msg, Properties.Resources.information, eDesktopAlertColor.Default, eAlertPosition.BottomRight, 2, 0, null);
        }

        // 显示错误提示
        public static void Fail(string info)
        {
            MessageBox.Show(info, "错误", MessageBoxButtons.OK, MessageBoxIcon.Warning);
        }

        //--------------------------------------------------
        public static string GetText(this TextBox textbox)
        {
            return textbox.Text.Trim();
        }

        /// <summary>根据标题获取枚举值</summary>
        public static T GetEnumByTitle<T>(string title) where T : struct
        {
            return typeof(T).GetEnums<T>().FirstOrDefault(t => t.GetTitle() == title);
        }

        //--------------------------------------------------
        public static void BindEnum<T>(this ComboBox cmb, List<T> enums=null) where T : struct
        {
            enums = enums ?? typeof(T).GetEnums<T>();
            cmb.DropDownStyle = ComboBoxStyle.DropDownList;
            cmb.Items.Clear();
            foreach (var item in enums)
                cmb.Items.Add(item.GetTitle());
            //cmb.SelectedIndex = 0;
        }

        /// <summary>获取选中的枚举值</summary>
        public static T GetEnum<T>(this ComboBox cmb) where T : struct
        {
            var enums = typeof(T).GetEnums<T>();
            var item = cmb.SelectedItem;
            return enums.FirstOrDefault(t => t.GetTitle() == item.ToString());
        }

        /// <summary>设置选中的枚举值</summary>
        public static void SetEnum<T>(this ComboBox cmb, T e) where T : struct
        {
            cmb.SelectedItem = e.GetTitle();
            //for (var i = 0; i < cmb.Items.Count; i++)
        }

        //--------------------------------------------------
        public static void BindEnum<T>(this CheckedListBox clb, List<T> enums=null, bool selectAll=true) where T : struct
        {
            enums = enums ?? typeof(T).GetEnums<T>();
            clb.Items.Clear();
            foreach (var item in enums)
                clb.Items.Add(item.GetTitle(), selectAll);
        }

        /// <summary>设置选中的枚举值</summary>
        public static void SetEnums<T>(this CheckedListBox clb, List<T> enums) where T : struct
        {
            var items = new List<T>();
            for (var i=0; i<clb.Items.Count; i++)
            {
                var txt = clb.Items[i].ToString();
                var b = enums.Exists(t => t.GetTitle() == txt);
                clb.SetItemChecked(i, b);
            }
        }

        /// <summary>设置选中的枚举值</summary>
        public static void SetEnumValue<T>(this CheckedListBox clb, T enumValue, bool selected) where T : struct
        {
            for (var i = 0; i < clb.Items.Count; i++)
            {
                var txt = clb.Items[i].ToString();
                var finded = (enumValue.GetTitle() == txt);
                if (finded)
                    clb.SetItemChecked(i, selected);
            }
        }

        /// <summary>转化为对象列表</summary>
        public static List<object> CastObjects<T>(this List<T> items)
        {
            var objects = new List<object>();
            foreach (var item in items)
                objects.Add(item);
            return objects;
        }

        /// <summary>获取选中的枚举值</summary>
        public static List<T> GetEnums<T>(this CheckedListBox clb) where T : struct
        {
            var items = new List<T>();
            var enums = typeof(T).GetEnums<T>();
            foreach (var item in clb.CheckedItems)
            {
                var e = enums.FirstOrDefault(t => t.GetTitle() == item.ToString());
                items.Add(e);
            }
            return items;
        }

        /// <summary>获取选中的枚举值</summary>
        public static List<object> GetEnumObjects<T>(this CheckedListBox clb) where T : struct
        {
            var items = new List<object>();
            var enums = typeof(T).GetEnums<T>();
            foreach (var item in clb.SelectedItems)
            {
                var e = enums.FirstOrDefault(t => t.GetTitle() == item.ToString());
                items.Add(e);
            }
            return items;
        }

        /// <summary>获取选中的枚举值</summary>
        public static Dictionary<string, bool> GetDict(this CheckedListBox clb)
        {
            var dict = new Dictionary<string, bool>();
            foreach (var item in clb.Items)
            {
                var b = clb.SelectedItems.Contains(item);
                dict.Add(item.ToString(), b);
            }
            return dict;
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\Win\Win32.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace MapCutter.Components
{
    /// <summary>
    public static class Win32
    {
        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        public static extern short GetAsyncKeyState(int nVirtKey);
        public const int VK_CONTROL = 0x11;
        public const int VK_ALT = 0x12;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Components\Win\WizardSteps.cs
//////////////////////////////////////////////////////
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Components
{
    /// <summary>向导步骤（含关联的控件信息）</summary>
    public class WizardStep
    {
        public int Index { get; set; }
        public string Title { get; set; }
        public UserControl Control { get; set; }
        public WizardStep( UserControl control, string title, int index)
        {
            this.Control = control;
            this.Title = title;
            this.Index = index;
        }
    }

    /// <summary>
    public class WizardSteps : IEnumerable<WizardStep>
    {
        // 私有成员
        List<WizardStep> _steps = new List<WizardStep>();
        int _n = 0;

        // 公开属性
        public int Count => _steps.Count;
        public WizardStep First => _steps.First();
        public WizardStep Last => _steps.Last();
        public WizardStep Current => _steps[_n];
        public WizardStep this [int i] => _steps [i];
        public bool IsFirst => _n == 0;
        public bool IsLast => _n == _steps.Count - 1;

        /// <summary>索引器</summary>
        public IEnumerator GetEnumerator()
        {
            return ((IEnumerable)_steps).GetEnumerator();
        }
        IEnumerator<WizardStep> IEnumerable<WizardStep>.GetEnumerator()
        {
            return ((IEnumerable<WizardStep>)_steps).GetEnumerator();
        }

        /// <summary>新增</summary>
        public WizardSteps Add(UserControl control, string title)
        {
            var step = new WizardStep(control, title, _steps.Count);
            _steps.Add(step);
            return this;
        }

        /// <summary>前移</summary>
        public WizardStep MoveNext()
        {
            _n++;
            if (_n >= Count - 1)
                _n = Count - 1;
            return _steps[_n];
        }

        /// <summary>后移</summary>
        public WizardStep MovePrev()
        {
            _n--;
            if (_n <= 0)
                _n = 0;
            return _steps[_n];
        }
    }

}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormAbout.cs
//////////////////////////////////////////////////////
using App.Core;
using CefSharp;
using CommonMark;
using System;
using System.Text;
using System.Windows.Forms;

namespace MapCutter
{
    public partial class FormAbout : Form
    {
        public FormAbout()
        {
            InitializeComponent();
        }

        private void btnOk_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void FormAbout_Load(object sender, EventArgs e)
        {
            // 经测试，不知道哪个版本的程序经过 NetReact 合并程序集后资源列表变了，找不到这个资源，查不到原因。改用内部资源。
            var txt = MapCutter.Properties.Resources.About;
            var html = string.Concat("<html><body>", CommonMarkConverter.Convert(txt), "</body></html>");
            webView.LoadHtml(html, IO.AssemblyDirectory, new UTF8Encoding(false));
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormAbout.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormAbout
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormAbout));
            this.label1 = new System.Windows.Forms.Label();
            this.panel1 = new System.Windows.Forms.Panel();
            this.btnOk = new System.Windows.Forms.Button();
            this.webView = new CefSharp.WinForms.ChromiumWebBrowser();
            this.panel1.SuspendLayout();
            this.SuspendLayout();
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("Impact", 36F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label1.ForeColor = System.Drawing.Color.White;
            this.label1.Location = new System.Drawing.Point(21, 11);
            this.label1.Margin = new System.Windows.Forms.Padding(4, 0, 4, 0);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(288, 75);
            this.label1.TabIndex = 0;
            this.label1.Text = "MapCutter";
            // 
            this.panel1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(67)))), ((int)(((byte)(144)))), ((int)(((byte)(247)))));
            this.panel1.Controls.Add(this.label1);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Margin = new System.Windows.Forms.Padding(4, 4, 4, 4);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(1101, 98);
            this.panel1.TabIndex = 16;
            // 
            this.btnOk.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnOk.Location = new System.Drawing.Point(985, 634);
            this.btnOk.Margin = new System.Windows.Forms.Padding(4, 4, 4, 4);
            this.btnOk.Name = "btnOk";
            this.btnOk.Size = new System.Drawing.Size(100, 29);
            this.btnOk.TabIndex = 18;
            this.btnOk.Text = "OK";
            this.btnOk.UseVisualStyleBackColor = true;
            this.btnOk.Click += new System.EventHandler(this.btnOk_Click);
            // 
            this.webView.ActivateBrowserOnCreation = false;
            this.webView.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
// TODO: “”的代码生成失败，原因是出现异常“无效的基元类型: System.IntPtr。请考虑使用 CodeObjectCreateExpression。”。
            this.webView.Location = new System.Drawing.Point(0, 106);
            this.webView.Margin = new System.Windows.Forms.Padding(4, 4, 4, 4);
            this.webView.Name = "webView";
            this.webView.Size = new System.Drawing.Size(1097, 497);
            this.webView.TabIndex = 32;
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 15F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1101, 678);
            this.Controls.Add(this.webView);
            this.Controls.Add(this.btnOk);
            this.Controls.Add(this.panel1);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Margin = new System.Windows.Forms.Padding(4, 4, 4, 4);
            this.Name = "FormAbout";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "About";
            this.Load += new System.EventHandler(this.FormAbout_Load);
            this.panel1.ResumeLayout(false);
            this.panel1.PerformLayout();
            this.ResumeLayout(false);

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.Button btnOk;
        private CefSharp.WinForms.ChromiumWebBrowser webView;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormConfig.cs
//////////////////////////////////////////////////////
using MapCutter.Components;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Forms
{
    public partial class FormConfig : Form
    {
        public FormConfig()
        {
            InitializeComponent();
        }

        private void FormConfig_Load(object sender, EventArgs e)
        {
            this.propertyGrid.SelectedObject = AppConfig.Instance;
        }

        private void FormConfig_FormClosed(object sender, FormClosedEventArgs e)
        {
            AppConfig.Instance.Save();
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormConfig.Designer.cs
//////////////////////////////////////////////////////

namespace MapCutter.Forms
{
    partial class FormConfig
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormConfig));
            this.propertyGrid = new System.Windows.Forms.PropertyGrid();
            this.SuspendLayout();
            // 
            this.propertyGrid.Dock = System.Windows.Forms.DockStyle.Fill;
            this.propertyGrid.Location = new System.Drawing.Point(0, 0);
            this.propertyGrid.Name = "propertyGrid";
            this.propertyGrid.Size = new System.Drawing.Size(805, 528);
            this.propertyGrid.TabIndex = 1;
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(805, 528);
            this.Controls.Add(this.propertyGrid);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormConfig";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "配置";
            this.FormClosed += new System.Windows.Forms.FormClosedEventHandler(this.FormConfig_FormClosed);
            this.Load += new System.EventHandler(this.FormConfig_Load);
            this.ResumeLayout(false);

        }

        #endregion
        private System.Windows.Forms.PropertyGrid propertyGrid;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormLoading.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Forms
{
    public partial class FormLoading : Form
    {
        DateTime _startDt;
        public FormLoading()
        {
            InitializeComponent();
        }

        private void FormWaiting_Load(object sender, EventArgs e)
        {
            _startDt = DateTime.Now;
            timer.Enabled = true;
        }

        private void FormWaiting_FormClosing(object sender, FormClosingEventArgs e)
        {
            timer.Enabled = false;
        }

        private void timer_Tick(object sender, EventArgs e)
        {
            var span = DateTime.Now - _startDt;
            this.lblTime.Text = String.Format("{0:00}:{1:00}:{2:00}", span.Hours, span.Minutes, span.Seconds);
        }

        public void SetText(string text)
        {
            this.lblInfo.Text = text;
        }

        //----------------------------------------------
        private delegate void CloseDelegate();
        private static FormLoading _form;
        private static readonly Object syncLock = new Object();  //加锁使用

        /// <summary>显示loading框</summary>
        public static void ShowForm(string text, Form owner)
        {
            if (_form != null)
                return;
            Thread thread = new Thread(new ThreadStart(() =>
            {
                if (_form != null)
                    _form = null;
                _form = new FormLoading();
                _form.TopMost = true;
                _form.StartPosition = FormStartPosition.Manual;
                _form.Location = new Point(owner.Location.X + owner.Width / 2 - _form.Width / 2, owner.Location.Y + owner.Height / 2 - _form.Height / 2);
                _form.SetText(text);
                _form.ShowDialog();
            }));
            thread.IsBackground = true;
            thread.SetApartmentState(ApartmentState.STA);
            thread.Start();
        }

        /// <summary>关闭窗口</summary>
        public static void CloseForm()
        {
            Thread.Sleep(50); //可能到这里线程还未起来，所以进行延时，可以确保线程起来，彻底关闭窗口
            if (_form != null)
            {
                lock (syncLock)
                {
                    Thread.Sleep(50);
                    if (_form != null)
                    {
                        Thread.Sleep(50);  //通过三次延时，确保可以彻底关闭窗口
                        _form.Invoke(new CloseDelegate(() => {
                            _form.Close();
                            _form = null;
                        }));
                    }
                }
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormLoading.Designer.cs
//////////////////////////////////////////////////////

namespace MapCutter.Forms
{
    partial class FormLoading
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.lblTime = new System.Windows.Forms.Label();
            this.pictureBox1 = new System.Windows.Forms.PictureBox();
            this.timer = new System.Windows.Forms.Timer(this.components);
            this.lblInfo = new System.Windows.Forms.Label();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
            this.SuspendLayout();
            // 
            this.lblTime.AutoSize = true;
            this.lblTime.Location = new System.Drawing.Point(74, 42);
            this.lblTime.Name = "lblTime";
            this.lblTime.Size = new System.Drawing.Size(53, 12);
            this.lblTime.TabIndex = 0;
            this.lblTime.Text = "00:00:00";
            // 
            this.pictureBox1.Image = global::MapCutter.Properties.Resources.hourglass;
            this.pictureBox1.Location = new System.Drawing.Point(28, 16);
            this.pictureBox1.Name = "pictureBox1";
            this.pictureBox1.Size = new System.Drawing.Size(16, 16);
            this.pictureBox1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox1.TabIndex = 1;
            this.pictureBox1.TabStop = false;
            // 
            this.timer.Interval = 1000;
            this.timer.Tick += new System.EventHandler(this.timer_Tick);
            // 
            this.lblInfo.AutoSize = true;
            this.lblInfo.Font = new System.Drawing.Font("宋体", 14.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblInfo.Location = new System.Drawing.Point(60, 16);
            this.lblInfo.Name = "lblInfo";
            this.lblInfo.Size = new System.Drawing.Size(86, 19);
            this.lblInfo.TabIndex = 2;
            this.lblInfo.Text = "Loading";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(199, 73);
            this.ControlBox = false;
            this.Controls.Add(this.lblInfo);
            this.Controls.Add(this.pictureBox1);
            this.Controls.Add(this.lblTime);
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None;
            this.Name = "FormLoading";
            this.ShowIcon = false;
            this.ShowInTaskbar = false;
            this.SizeGripStyle = System.Windows.Forms.SizeGripStyle.Hide;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "Waiting";
            this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.FormWaiting_FormClosing);
            this.Load += new System.EventHandler(this.FormWaiting_Load);
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label lblTime;
        private System.Windows.Forms.PictureBox pictureBox1;
        private System.Windows.Forms.Timer timer;
        private System.Windows.Forms.Label lblInfo;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMain.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Reflection;
using System.Data.Entity.Core.Objects;
using System.Threading;
using MapCutter.Components;
using MapCutter.Licenses;
using App.Core;
using System.Diagnostics;
using System.Net;
using DevComponents.DotNetBar;
using MapCutter.Forms;

namespace MapCutter
{
    /// <summary>
    public partial class FormMain : Office2007RibbonForm, IMain
    {
        // 参数
        TileConfig _cfg = new TileConfig();

        // 步骤
        WizardSteps _steps = new WizardSteps();
        StepBasic   _stepBasic    = new StepBasic();
        StepPreview _stepPreview  = new StepPreview();

        //-----------------------------------------------------
        public FormMain()
        {
            // Init
            InitializeComponent();
            this.ribbonControl1.TitleText = "MapCutter " + UICommon.GetVersion();
            CheckLicense();

            // 显示欢迎屏
            FormWelcome form = new FormWelcome();
            form.ShowDialog();
        }

        // 检测 License 功能
        private void CheckLicense()
        {
            this.btnRegist.Text = AppLicense.Current.IsRegist ? "已注册" : "注册";
            if (!AppLicense.Current.IsRegist) // 如果未注册，只能是调试模式
                _cfg.Debug = true;
        }

        // 动态创建各步骤控件
        private void FormMain_Load(object sender, EventArgs e)
        {
            BuildWizard();
        }

        // 窗口关闭
        private void FormMain_FormClosing(object sender, FormClosingEventArgs e)
        {
            this._stepPreview.CloseWebServer();
            AppConfig.Instance.Save();
            if (!_cfg.IsDirty)
                return;

            // 保存提示
            var result = MessageBox.Show(this, "是否保存配置？", "MapCutter", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Information);
            if (result == DialogResult.Cancel)
            {
                e.Cancel = true;
                return;
            }
            if (result == DialogResult.Yes)
            {
                btnFileSave_Click(null, null);
            }
        }

        // 打开网页
        private void btnOpenWeb_Click(object sender, EventArgs e)
        {
            if (CollectConfig())
            {
                // 生成最终的网页
                var html = MapCutters.GetCutter(_cfg.MapType).BuildTileHtml(_cfg);
                IO.PrepareDirectory(_cfg.HtmlPath);
                using (var w = File.CreateText(_cfg.HtmlPath))
                    w.Write(html);
            }

            // Start web server
            new FormWeb(_cfg.HtmlPath, null, null, null).ShowDialog();
        }

        //-----------------------------------------------------
        private void btnAbout_Click(object sender, EventArgs e)
        {
            new FormAbout().ShowDialog();
        }

        // 软件注册
        private void btnRegist_Click(object sender, EventArgs e)
        {
            var frm = new FormRegist();
            if (frm.ShowDialog() == DialogResult.OK)
            {
                this.btnRegist.Text = "已注册";
                _stepBasic.ShowMapTypes();
                this.UpdateUI(true);
            }
        }

        /// <summary>版本检测</summary>
        private void btnCheckVersion_Click(object sender, EventArgs e)
        {
            try
            {
                var url = "https://api.github.com/repos/surfsky/MapCutterRelease/releases/latest";
                var o = GithubRelease.Get(url);
                var v1 = Assembly.GetExecutingAssembly().GetName().Version;  // 当前版本
                var v2 = Version.Parse(o.tag_name);  // 最新版本
                if ((v2.Major > v1.Major) ||
                    (v2.Major == v1.Major && v2.Minor > v1.Minor) ||
                    (v2.Major == v1.Major && v2.Minor == v1.Minor && v2.Build > v1.Build))
                {
                    var txt = string.Format("检测到最新版本 {0}:\r\n\r\n{1}\r\n\r\n是否下载？", v2, o.body);
                    if (DialogResult.OK == MessageBox.Show(this, txt, "新版本", MessageBoxButtons.OKCancel))
                    {
                        Process.Start(o.assets[0].browser_download_url);
                    }
                }
                else
                {
                    MessageBox.Show(this, "已经是最新版本", "版本检测");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(this, "网络故障，请检查后再试: " + ex.Message, "版本检测");
            }
        }

        // 计时
        private void timer1_Tick(object sender, EventArgs e)
        {
            var span = DateTime.Now - _startDt;
            this.lblTime.Text = String.Format("{0:00}:{1:00}:{2:00}", span.Hours, span.Minutes, span.Seconds);
        }

        // 合并图片对话框
        private void btnMerge_Click(object sender, EventArgs e)
        {
            new FormMergeMapFolders().ShowDialog();
        }

        /// <summary>帮助</summary>
        private void btnHelp_Click(object sender, EventArgs e)
        {
            Process.Start("https://blog.csdn.net/surfsky/article/details/106951716");
        }

        //-----------------------------------------------------
        void BuildWizard()
        {
            // 初始化步骤
            _steps.Add(_stepBasic,   "基础设置");
            _steps.Add(_stepPreview, "坐标区域");

            // 列表、面板
            foreach (WizardStep step in _steps)
            {
                var ctrl = step.Control;
                ctrl.Dock = DockStyle.Fill;
                this.panel.Controls.Add(ctrl);
            }
            this.UpdateUI(true);
        }

        // 前一步按钮
        private void btnPrev_Click(object sender, EventArgs e)
        {
            CollectConfig();
            _steps.MovePrev();
            UpdateUI(true);
        }

        // 后继按钮
        private void btnNext_Click(object sender, EventArgs e)
        {
            var current = _steps.Current;

            // 如果是取消状态
            if (btnNext.Text == "取消")
            {
                _cutter.Cancel();
                return;
            }

            // 采集本步骤的数据
            if (current.Control is IUIConfig s)
            {
                var r = s.Check();
                if (r != null)
                {
                    MessageBox.Show(r.Info, "错误", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    return;
                }
                s.Get();
            }

            // 如果是最后一个页面，直接处理
            if (_steps.IsLast)
            {
                Start();
                return;
            }

            // 计算后继步骤并更新页面
            _steps.MoveNext();
            UpdateUI(true);
        }

        /// <summary>采集配置信息</summary>
        bool CollectConfig()
        {
            foreach (WizardStep step in _steps)
            {
                var ctrl = step.Control as IUIConfig;
                ctrl.Get();
                var r = ctrl.Check();
                if (r != null)
                {
                    //MessageBox.Show(r.Info, "错误", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    return false;
                }
            }
            return true;
        }

        /// <summary>采集配置信息</summary>
        bool SetConfigUIs()
        {
            foreach (WizardStep step in _steps)
            {
                var ctrl = step.Control as IUIConfig;
                ctrl.Set(this, _cfg);
            }
            return true;
        }

        // 更新当前步骤UI
        private void UpdateUI(bool setCurrentStep)
        {
            // 当前页面设置
            var current = _steps.Current;
            if (current.Control is IUIConfig s)
                s.Set(this, _cfg);

            // 按钮、面板、列表控制
            btnNext.Text = _steps.IsLast ? "切图" : "下一步";
            btnPrev.Enabled = !_steps.IsFirst;
            _steps.Each(t => t.Control.Visible = (t == current));
        }

        //-----------------------------------------------------
        DateTime _startDt;
        MapCutterRunner _cutter;

        /// <summary>开始切图</summary>
        public void Start()
        {
            var rect = this._cfg.Rect;
            var tl = rect.TL;
            var br = rect.BR;
            if (tl.X >= br.X || tl.Y <= br.Y)
            {
                MessageBox.Show(this, "两个坐标别设置反了哦（左上角是A点，右下角是C点）。", "MapCutter");
                return;
            }

            //
            this.btnNext.Text = "取消";
            this.btnNext.Image = Properties.Resources.cancel;
            this.btnPrev.Enabled = false;
            this.lblStatus.Text = "PREPARE";
            _startDt = DateTime.Now;
            timer1.Enabled = true;

            //
            _cutter = new MapCutterRunner(this._cfg);
            _cutter.CutPrepare += (txt) =>
            {
                this.Invoke(() => this.lblStatus.Text = txt);
            };
            _cutter.CutStart += (n) =>
            {
                this.Invoke(() =>
                {
                    this.lblStatus.Text = "READY";
                    this.progress.Visible = true;
                    this.progress.Maximum = n;
                    Logger.Info("\r\nSTART " + n.ToString());
                });
            };
            _cutter.CutLevel += (info) =>
            {
                this.Invoke(() =>
                {
                    this.lblZoom.Text = $"ZOOM-{info.Zoom}";
                    this.lblSize.Text = $"{info.Size.Width}x{info.Size.Height}";
                    this.lblTiles.Text = $"0/{info.Tiles}";
                    Logger.Info(info.ToString());
                });
            };
            _cutter.CutItem += (info) =>
            {
                this.Invoke(() =>
                {
                    this.progress.Value = info.TotalDone;
                    this.lblStatus.Text = "PROCESSING";
                    this.lblTiles.Text = $"{info.ZoomDone}/{info.ZoomTasks}";
                    this.lblTask.Text = $"{info.TotalDone}/{info.Total}";
                    Logger.Info(info.ToString());
                });
            };
            _cutter.CutEnd += (n) =>
            {
                this.Invoke(() =>
                {
                    this.btnPrev.Enabled = true;
                    this.btnNext.Enabled = true;
                    this.progress.Value = this.progress.Maximum;
                    this.lblStatus.Text = "FINISHED";
                    this.progress.Visible = false;
                    this.btnWeb.Visible = true;
                    timer1.Enabled = false;
                    this.btnNext.Text = "开始";
                    this.btnNext.Image = Properties.Resources.forward;
                    Logger.Info("END " + lblTime.Text);
                    this.btnOpenWeb_Click(null, null);
                });
            };
            _cutter.CutError += (ex) =>
            {
                this.Invoke(() =>
                {
                    var msg = "切图中遇到异常：" + ex.Message + ex.InnerException?.Message;
                    MessageBox.Show(msg);
                    Logger.Error(msg + ex.StackTrace);
                    this.btnPrev.Enabled = true;
                    this.btnNext.Enabled = true;
                });
            };

            //
            Logger.Info(_cfg.ToJson());
            var task = new Thread(new ThreadStart(_cutter.Start));
            task.Start();
        }

        /// <summary>处理UI</summary>
        public void Invoke(Action action)
        {
            if (InvokeRequired)
                BeginInvoke(action);
            else
                action.Invoke();
        }

        //-----------------------------------------------------
        string _fileName = "";

        // 新建
        private void btnFileNew_Click(object sender, EventArgs e)
        {
            _fileName = "";
        }

        // 打开
        private void btnFileOpen_Click(object sender, EventArgs e)
        {
            var dlg = new OpenFileDialog();
            dlg.Filter = "MapCutter config file|*.mct";
            if (DialogResult.OK == dlg.ShowDialog())
            {
                _fileName = dlg.FileName;
                try
                {
                    _cfg = JsonHelper.LoadJsonFile<TileConfig>(dlg.FileName);
                    _cfg.Fix();
                    CheckLicense();
                    SetConfigUIs();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(this, "配置读取错误。MapCutter 4.0 起使用了简化格式的配置文件，请重新保存配置或用记事本修改后使用，非常抱歉给您带来不便。详细错误原因: " + ex.Message, "MapCutter");
                }
            }
        }

        // 保存
        private void btnFileSave_Click(object sender, EventArgs e)
        {
            if (_fileName.IsEmpty())
                btnFileSaveAs_Click(null, null);
            else
            {
                CollectConfig();
                _cfg.Version = UICommon.GetVersion();
                _cfg.SaveJsonFile(_fileName);
                UpdateDirtyStatus(false);
                UI.Info("配置保存成功: " + _fileName);
            }
        }

        // 另存为
        private void btnFileSaveAs_Click(object sender, EventArgs e)
        {
            CollectConfig();
            var dlg = new SaveFileDialog();
            dlg.Filter = "MapCutter config file|*.mct";
            dlg.AddExtension = true;
            dlg.FileName = string.Format("{0}-{1}.mct", _cfg.MapType.ToString().ToLower(), _cfg.BuildType?.ToLower());
            if (DialogResult.OK == dlg.ShowDialog())
            {
                _fileName = dlg.FileName;
                CollectConfig();
                _cfg.Version = UICommon.GetVersion();
                _cfg.SaveJsonFile(dlg.FileName);
                UpdateDirtyStatus(false);
                UI.Info("配置另存为成功: " + _fileName);
            }
        }

        // 退出
        private void btnExit_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        // 配置
        private void btnConfig_Click(object sender, EventArgs e)
        {
            new FormConfig().ShowDialog();
        }

        // 绘制
        private void btnPaint_Click(object sender, EventArgs e)
        {
            //if (_config.ImagePath.IsEmpty())
                Process.Start("MapPainter.exe");
            //else
        }

        // 合并切片
        private void btnMergeTiles_Click(object sender, EventArgs e)
        {
            var dlg = new FormMergeMapTiles();
            dlg.ShowDialog();
        }

        //----------------------------------------------------------
        public void ShowDoc()
        {
            this.ShowImageInfo();
        }

        // 文档变更后，找个地方显示变更文本，退出时会提示保存
        public void DocChanged()
        {
            UpdateDirtyStatus(true);
        }

        /// <summary>更新文件肮脏状态</summary>
        void UpdateDirtyStatus(bool dirty)
        {
            _cfg.IsDirty = dirty;
            this.ribbonControl1.TitleText = this.ribbonControl1.TitleText.TrimEnd('*');
            if (dirty)
                this.ribbonControl1.TitleText = this.ribbonControl1.TitleText + "*";
        }

        /// <summary>显示图片信息</summary>
        public void ShowImageInfo()
        {
            if (_cfg != null)
            {
                this.lblSize.Text = string.Format("{0}x{1}", _cfg.ImageSize.Width, _cfg.ImageSize.Height);
                this.lblTiles.Text = string.Format("{0}", _cfg.Gps);
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMain.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormMain
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows 窗体设计器生成的代码

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormMain));
            this.panel = new System.Windows.Forms.Panel();
            this.timer1 = new System.Windows.Forms.Timer(this.components);
            this.toolTip = new System.Windows.Forms.ToolTip(this.components);
            this.styleManager1 = new DevComponents.DotNetBar.StyleManager(this.components);
            this.barStatus = new DevComponents.DotNetBar.Bar();
            this.lblStatus = new DevComponents.DotNetBar.LabelItem();
            this.lblZoom = new DevComponents.DotNetBar.LabelItem();
            this.lblSize = new DevComponents.DotNetBar.LabelItem();
            this.lblTiles = new DevComponents.DotNetBar.LabelItem();
            this.lblTask = new DevComponents.DotNetBar.LabelItem();
            this.progress = new DevComponents.DotNetBar.ProgressBarItem();
            this.lblTime = new DevComponents.DotNetBar.LabelItem();
            this.ribbonControl1 = new DevComponents.DotNetBar.RibbonControl();
            this.ribbonPanel2 = new DevComponents.DotNetBar.RibbonPanel();
            this.ribbonBar3 = new DevComponents.DotNetBar.RibbonBar();
            this.btnConfig = new DevComponents.DotNetBar.ButtonItem();
            this.btnCheckVersion = new DevComponents.DotNetBar.ButtonItem();
            this.btnHelp = new DevComponents.DotNetBar.ButtonItem();
            this.btnRegist = new DevComponents.DotNetBar.ButtonItem();
            this.btnAbout = new DevComponents.DotNetBar.ButtonItem();
            this.ribbonBar2 = new DevComponents.DotNetBar.RibbonBar();
            this.btnWeb = new DevComponents.DotNetBar.ButtonItem();
            this.btnPaint = new DevComponents.DotNetBar.ButtonItem();
            this.btnMergeFolder = new DevComponents.DotNetBar.ButtonItem();
            this.btnMergeTiles = new DevComponents.DotNetBar.ButtonItem();
            this.ribbonBar1 = new DevComponents.DotNetBar.RibbonBar();
            this.btnPrev = new DevComponents.DotNetBar.ButtonItem();
            this.btnNext = new DevComponents.DotNetBar.ButtonItem();
            this.applicationButton1 = new DevComponents.DotNetBar.ApplicationButton();
            this.itemContainer1 = new DevComponents.DotNetBar.ItemContainer();
            this.itemContainer2 = new DevComponents.DotNetBar.ItemContainer();
            this.itemContainer3 = new DevComponents.DotNetBar.ItemContainer();
            this.btnFileNew = new DevComponents.DotNetBar.ButtonItem();
            this.btnFileOpen = new DevComponents.DotNetBar.ButtonItem();
            this.btnFileSave = new DevComponents.DotNetBar.ButtonItem();
            this.btnFileSaveAs = new DevComponents.DotNetBar.ButtonItem();
            this.itemContainer4 = new DevComponents.DotNetBar.ItemContainer();
            this.btnExit = new DevComponents.DotNetBar.ButtonItem();
            this.ribbonTabItem2 = new DevComponents.DotNetBar.RibbonTabItem();
            ((System.ComponentModel.ISupportInitialize)(this.barStatus)).BeginInit();
            this.ribbonControl1.SuspendLayout();
            this.ribbonPanel2.SuspendLayout();
            this.SuspendLayout();
            // 
            this.panel.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel.Location = new System.Drawing.Point(5, 124);
            this.panel.Name = "panel";
            this.panel.Size = new System.Drawing.Size(1262, 634);
            this.panel.TabIndex = 12;
            // 
            this.timer1.Interval = 1000;
            this.timer1.Tick += new System.EventHandler(this.timer1_Tick);
            // 
            this.styleManager1.ManagerStyle = DevComponents.DotNetBar.eStyle.Office2016;
            this.styleManager1.MetroColorParameters = new DevComponents.DotNetBar.Metro.ColorTables.MetroColorGeneratorParameters(System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255))))), System.Drawing.Color.DodgerBlue);
            // 
            this.barStatus.AccessibleDescription = "DotNetBar Bar (barStatus)";
            this.barStatus.AccessibleName = "DotNetBar Bar";
            this.barStatus.AccessibleRole = System.Windows.Forms.AccessibleRole.StatusBar;
            this.barStatus.AntiAlias = true;
            this.barStatus.BarType = DevComponents.DotNetBar.eBarType.StatusBar;
            this.barStatus.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.barStatus.Font = new System.Drawing.Font("Microsoft YaHei UI", 9F);
            this.barStatus.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.ResizeHandle;
            this.barStatus.IsMaximized = false;
            this.barStatus.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.lblStatus,
            this.lblZoom,
            this.lblSize,
            this.lblTiles,
            this.lblTask,
            this.progress,
            this.lblTime});
            this.barStatus.ItemSpacing = 2;
            this.barStatus.Location = new System.Drawing.Point(5, 739);
            this.barStatus.Margin = new System.Windows.Forms.Padding(2);
            this.barStatus.Name = "barStatus";
            this.barStatus.PaddingBottom = 0;
            this.barStatus.PaddingLeft = 0;
            this.barStatus.PaddingRight = 0;
            this.barStatus.PaddingTop = 0;
            this.barStatus.Size = new System.Drawing.Size(1262, 19);
            this.barStatus.Stretch = true;
            this.barStatus.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.barStatus.TabIndex = 0;
            this.barStatus.TabStop = false;
            // 
            this.lblStatus.Name = "lblStatus";
            this.lblStatus.Text = "STS";
            // 
            this.lblZoom.Name = "lblZoom";
            this.lblZoom.Text = "ZOOM";
            // 
            this.lblSize.Name = "lblSize";
            this.lblSize.Text = "SIZE";
            // 
            this.lblTiles.Name = "lblTiles";
            this.lblTiles.Text = "TILES";
            // 
            this.lblTask.Name = "lblTask";
            this.lblTask.Text = "TASK";
            // 
            this.progress.BackStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.progress.ChunkGradientAngle = 0F;
            this.progress.MenuVisibility = DevComponents.DotNetBar.eMenuVisibility.VisibleAlways;
            this.progress.Name = "progress";
            this.progress.RecentlyUsed = false;
            this.progress.Visible = false;
            this.progress.Width = 500;
            // 
            this.lblTime.Name = "lblTime";
            this.lblTime.Text = "TIME";
            // 
            this.ribbonControl1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(255)))), ((int)(((byte)(255)))));
            this.ribbonControl1.BackgroundImage = global::MapCutter.Properties.Resources.RibbonSpring;
            // 
            this.ribbonControl1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.ribbonControl1.CanCustomize = false;
            this.ribbonControl1.CaptionFont = new System.Drawing.Font("Impact", 14.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.ribbonControl1.CaptionVisible = true;
            this.ribbonControl1.Controls.Add(this.ribbonPanel2);
            this.ribbonControl1.Dock = System.Windows.Forms.DockStyle.Top;
            this.ribbonControl1.ForeColor = System.Drawing.Color.Maroon;
            this.ribbonControl1.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.applicationButton1,
            this.ribbonTabItem2});
            this.ribbonControl1.KeyTipsFont = new System.Drawing.Font("Tahoma", 7F);
            this.ribbonControl1.Location = new System.Drawing.Point(5, 1);
            this.ribbonControl1.Margin = new System.Windows.Forms.Padding(2);
            this.ribbonControl1.Name = "ribbonControl1";
            this.ribbonControl1.Size = new System.Drawing.Size(1262, 123);
            this.ribbonControl1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.ribbonControl1.SystemText.MaximizeRibbonText = "&Maximize the Ribbon";
            this.ribbonControl1.SystemText.MinimizeRibbonText = "Mi&nimize the Ribbon";
            this.ribbonControl1.SystemText.QatAddItemText = "&Add to Quick Access Toolbar";
            this.ribbonControl1.SystemText.QatCustomizeMenuLabel = "<b>Customize Quick Access Toolbar</b>";
            this.ribbonControl1.SystemText.QatCustomizeText = "&Customize Quick Access Toolbar...";
            this.ribbonControl1.SystemText.QatDialogAddButton = "&Add >>";
            this.ribbonControl1.SystemText.QatDialogCancelButton = "Cancel";
            this.ribbonControl1.SystemText.QatDialogCaption = "Customize Quick Access Toolbar";
            this.ribbonControl1.SystemText.QatDialogCategoriesLabel = "&Choose commands from:";
            this.ribbonControl1.SystemText.QatDialogOkButton = "OK";
            this.ribbonControl1.SystemText.QatDialogPlacementCheckbox = "&Place Quick Access Toolbar below the Ribbon";
            this.ribbonControl1.SystemText.QatDialogRemoveButton = "&Remove";
            this.ribbonControl1.SystemText.QatPlaceAboveRibbonText = "&Place Quick Access Toolbar above the Ribbon";
            this.ribbonControl1.SystemText.QatPlaceBelowRibbonText = "&Place Quick Access Toolbar below the Ribbon";
            this.ribbonControl1.SystemText.QatRemoveItemText = "&Remove from Quick Access Toolbar";
            this.ribbonControl1.TabGroupHeight = 14;
            this.ribbonControl1.TabIndex = 21;
            // 
            this.ribbonPanel2.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.ribbonPanel2.Controls.Add(this.ribbonBar3);
            this.ribbonPanel2.Controls.Add(this.ribbonBar2);
            this.ribbonPanel2.Controls.Add(this.ribbonBar1);
            this.ribbonPanel2.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ribbonPanel2.Location = new System.Drawing.Point(0, 56);
            this.ribbonPanel2.Margin = new System.Windows.Forms.Padding(2);
            this.ribbonPanel2.Name = "ribbonPanel2";
            this.ribbonPanel2.Padding = new System.Windows.Forms.Padding(2, 0, 2, 2);
            this.ribbonPanel2.Size = new System.Drawing.Size(1262, 67);
            // 
            this.ribbonPanel2.Style.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonPanel2.StyleMouseDown.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonPanel2.StyleMouseOver.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.ribbonPanel2.TabIndex = 2;
            // 
            this.ribbonBar3.AutoOverflowEnabled = true;
            // 
            this.ribbonBar3.BackgroundMouseOverStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.ribbonBar3.ContainerControlProcessDialogKey = true;
            this.ribbonBar3.Dock = System.Windows.Forms.DockStyle.Left;
            this.ribbonBar3.DragDropSupport = true;
            this.ribbonBar3.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnConfig,
            this.btnCheckVersion,
            this.btnHelp,
            this.btnRegist,
            this.btnAbout});
            this.ribbonBar3.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.ribbonBar3.Location = new System.Drawing.Point(482, 0);
            this.ribbonBar3.Margin = new System.Windows.Forms.Padding(2);
            this.ribbonBar3.Name = "ribbonBar3";
            this.ribbonBar3.Size = new System.Drawing.Size(247, 65);
            this.ribbonBar3.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.ribbonBar3.TabIndex = 16;
            this.ribbonBar3.Text = "帮助";
            // 
            this.ribbonBar3.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar3.TitleStyleMouseOver.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.btnConfig.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnConfig.Image = global::MapCutter.Properties.Resources.cog;
            this.btnConfig.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnConfig.Name = "btnConfig";
            this.btnConfig.SubItemsExpandWidth = 14;
            this.btnConfig.Text = "配置";
            this.btnConfig.Click += new System.EventHandler(this.btnConfig_Click);
            // 
            this.btnCheckVersion.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnCheckVersion.Image = global::MapCutter.Properties.Resources.disconnect;
            this.btnCheckVersion.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnCheckVersion.Name = "btnCheckVersion";
            this.btnCheckVersion.SubItemsExpandWidth = 14;
            this.btnCheckVersion.Text = "版本检测";
            this.btnCheckVersion.Click += new System.EventHandler(this.btnCheckVersion_Click);
            // 
            this.btnHelp.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnHelp.Image = global::MapCutter.Properties.Resources.book_open;
            this.btnHelp.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnHelp.Name = "btnHelp";
            this.btnHelp.SubItemsExpandWidth = 14;
            this.btnHelp.Text = "帮助";
            this.btnHelp.Click += new System.EventHandler(this.btnHelp_Click);
            // 
            this.btnRegist.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnRegist.Image = global::MapCutter.Properties.Resources.shield;
            this.btnRegist.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnRegist.Name = "btnRegist";
            this.btnRegist.SubItemsExpandWidth = 14;
            this.btnRegist.Text = "注册";
            this.btnRegist.Click += new System.EventHandler(this.btnRegist_Click);
            // 
            this.btnAbout.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnAbout.Image = global::MapCutter.Properties.Resources.information;
            this.btnAbout.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnAbout.Name = "btnAbout";
            this.btnAbout.SubItemsExpandWidth = 14;
            this.btnAbout.Text = "关于";
            this.btnAbout.Click += new System.EventHandler(this.btnAbout_Click);
            // 
            this.ribbonBar2.AutoOverflowEnabled = true;
            // 
            this.ribbonBar2.BackgroundMouseOverStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.ribbonBar2.ContainerControlProcessDialogKey = true;
            this.ribbonBar2.Dock = System.Windows.Forms.DockStyle.Left;
            this.ribbonBar2.DragDropSupport = true;
            this.ribbonBar2.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnWeb,
            this.btnPaint,
            this.btnMergeFolder,
            this.btnMergeTiles});
            this.ribbonBar2.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.ribbonBar2.Location = new System.Drawing.Point(156, 0);
            this.ribbonBar2.Margin = new System.Windows.Forms.Padding(2);
            this.ribbonBar2.Name = "ribbonBar2";
            this.ribbonBar2.Size = new System.Drawing.Size(326, 65);
            this.ribbonBar2.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.ribbonBar2.TabIndex = 0;
            this.ribbonBar2.Text = "工具";
            // 
            this.ribbonBar2.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar2.TitleStyleMouseOver.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.btnWeb.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnWeb.Image = global::MapCutter.Properties.Resources.world;
            this.btnWeb.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnWeb.Name = "btnWeb";
            this.btnWeb.SubItemsExpandWidth = 14;
            this.btnWeb.Text = "打开网页";
            this.btnWeb.Tooltip = "打开网页";
            this.btnWeb.Click += new System.EventHandler(this.btnOpenWeb_Click);
            // 
            this.btnPaint.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnPaint.Image = global::MapCutter.Properties.Resources.pencil;
            this.btnPaint.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnPaint.Name = "btnPaint";
            this.btnPaint.SubItemsExpandWidth = 14;
            this.btnPaint.Text = "预处理";
            this.btnPaint.Tooltip = "预处理地图工具";
            this.btnPaint.Click += new System.EventHandler(this.btnPaint_Click);
            // 
            this.btnMergeFolder.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnMergeFolder.Image = global::MapCutter.Properties.Resources.build;
            this.btnMergeFolder.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnMergeFolder.Name = "btnMergeFolder";
            this.btnMergeFolder.SubItemsExpandWidth = 14;
            this.btnMergeFolder.Text = "合并地图目录";
            this.btnMergeFolder.Tooltip = "该功能可合并多个地图切片目录，并自动拼接图片，可用于实现超大城市地图的绘制。步骤如下：";
            this.btnMergeFolder.Click += new System.EventHandler(this.btnMerge_Click);
            // 
            this.btnMergeTiles.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnMergeTiles.Image = global::MapCutter.Properties.Resources.chart_pie_lightning;
            this.btnMergeTiles.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnMergeTiles.Name = "btnMergeTiles";
            this.btnMergeTiles.SubItemsExpandWidth = 14;
            this.btnMergeTiles.Text = "合并切片";
            this.btnMergeTiles.Tooltip = "合并切片，组成一个大图片（该功能由大图版本提供）";
            this.btnMergeTiles.Click += new System.EventHandler(this.btnMergeTiles_Click);
            // 
            this.ribbonBar1.AutoOverflowEnabled = false;
            // 
            this.ribbonBar1.BackgroundMouseOverStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.ribbonBar1.ContainerControlProcessDialogKey = true;
            this.ribbonBar1.Dock = System.Windows.Forms.DockStyle.Left;
            this.ribbonBar1.DragDropSupport = true;
            this.ribbonBar1.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnPrev,
            this.btnNext});
            this.ribbonBar1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.ribbonBar1.Location = new System.Drawing.Point(2, 0);
            this.ribbonBar1.Margin = new System.Windows.Forms.Padding(2);
            this.ribbonBar1.Name = "ribbonBar1";
            this.ribbonBar1.Size = new System.Drawing.Size(154, 65);
            this.ribbonBar1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.ribbonBar1.TabIndex = 18;
            this.ribbonBar1.Text = "操作";
            // 
            this.ribbonBar1.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.ribbonBar1.TitleStyleMouseOver.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.btnPrev.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnPrev.Image = global::MapCutter.Properties.Resources.reverse_green;
            this.btnPrev.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnPrev.Name = "btnPrev";
            this.btnPrev.SubItemsExpandWidth = 14;
            this.btnPrev.Text = "上一步";
            this.btnPrev.Click += new System.EventHandler(this.btnPrev_Click);
            // 
            this.btnNext.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnNext.Image = global::MapCutter.Properties.Resources.forward;
            this.btnNext.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnNext.Name = "btnNext";
            this.btnNext.SubItemsExpandWidth = 14;
            this.btnNext.Text = "下一步";
            this.btnNext.Click += new System.EventHandler(this.btnNext_Click);
            // 
            this.applicationButton1.AutoExpandOnClick = true;
            this.applicationButton1.CanCustomize = false;
            this.applicationButton1.HotTrackingStyle = DevComponents.DotNetBar.eHotTrackingStyle.Image;
            this.applicationButton1.Image = ((System.Drawing.Image)(resources.GetObject("applicationButton1.Image")));
            this.applicationButton1.ImageFixedSize = new System.Drawing.Size(16, 16);
            this.applicationButton1.ImagePaddingHorizontal = 0;
            this.applicationButton1.ImagePaddingVertical = 1;
            this.applicationButton1.Name = "applicationButton1";
            this.applicationButton1.ShowSubItems = false;
            this.applicationButton1.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.itemContainer1});
            this.applicationButton1.Text = "文件";
            // 
            this.itemContainer1.BackgroundStyle.Class = "RibbonFileMenuContainer";
            this.itemContainer1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.itemContainer1.LayoutOrientation = DevComponents.DotNetBar.eOrientation.Vertical;
            this.itemContainer1.Name = "itemContainer1";
            this.itemContainer1.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.itemContainer2,
            this.itemContainer4});
            // 
            this.itemContainer1.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.itemContainer2.BackgroundStyle.Class = "RibbonFileMenuTwoColumnContainer";
            this.itemContainer2.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.itemContainer2.ItemSpacing = 0;
            this.itemContainer2.Name = "itemContainer2";
            this.itemContainer2.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.itemContainer3});
            // 
            this.itemContainer2.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.itemContainer3.BackgroundStyle.Class = "RibbonFileMenuColumnOneContainer";
            this.itemContainer3.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.itemContainer3.LayoutOrientation = DevComponents.DotNetBar.eOrientation.Vertical;
            this.itemContainer3.MinimumSize = new System.Drawing.Size(120, 0);
            this.itemContainer3.Name = "itemContainer3";
            this.itemContainer3.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnFileNew,
            this.btnFileOpen,
            this.btnFileSave,
            this.btnFileSaveAs});
            // 
            this.itemContainer3.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.btnFileNew.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnFileNew.Image = ((System.Drawing.Image)(resources.GetObject("btnFileNew.Image")));
            this.btnFileNew.Name = "btnFileNew";
            this.btnFileNew.SubItemsExpandWidth = 24;
            this.btnFileNew.Text = "新建(&N)";
            this.btnFileNew.Visible = false;
            this.btnFileNew.Click += new System.EventHandler(this.btnFileNew_Click);
            // 
            this.btnFileOpen.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnFileOpen.Image = ((System.Drawing.Image)(resources.GetObject("btnFileOpen.Image")));
            this.btnFileOpen.Name = "btnFileOpen";
            this.btnFileOpen.SubItemsExpandWidth = 24;
            this.btnFileOpen.Text = "打开(&O)";
            this.btnFileOpen.Click += new System.EventHandler(this.btnFileOpen_Click);
            // 
            this.btnFileSave.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnFileSave.Image = ((System.Drawing.Image)(resources.GetObject("btnFileSave.Image")));
            this.btnFileSave.Name = "btnFileSave";
            this.btnFileSave.SubItemsExpandWidth = 24;
            this.btnFileSave.Text = "保存(&S)";
            this.btnFileSave.Click += new System.EventHandler(this.btnFileSave_Click);
            // 
            this.btnFileSaveAs.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnFileSaveAs.Image = ((System.Drawing.Image)(resources.GetObject("btnFileSaveAs.Image")));
            this.btnFileSaveAs.Name = "btnFileSaveAs";
            this.btnFileSaveAs.SubItemsExpandWidth = 24;
            this.btnFileSaveAs.Text = "另存为(&A)";
            this.btnFileSaveAs.Click += new System.EventHandler(this.btnFileSaveAs_Click);
            // 
            this.itemContainer4.BackgroundStyle.Class = "RibbonFileMenuBottomContainer";
            this.itemContainer4.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.itemContainer4.HorizontalItemAlignment = DevComponents.DotNetBar.eHorizontalItemsAlignment.Right;
            this.itemContainer4.Name = "itemContainer4";
            this.itemContainer4.SubItems.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnExit});
            // 
            this.itemContainer4.TitleStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            // 
            this.btnExit.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnExit.ColorTable = DevComponents.DotNetBar.eButtonColor.OrangeWithBackground;
            this.btnExit.Image = ((System.Drawing.Image)(resources.GetObject("btnExit.Image")));
            this.btnExit.Name = "btnExit";
            this.btnExit.SubItemsExpandWidth = 24;
            this.btnExit.Text = "退出(&X)";
            this.btnExit.Click += new System.EventHandler(this.btnExit_Click);
            // 
            this.ribbonTabItem2.Checked = true;
            this.ribbonTabItem2.Name = "ribbonTabItem2";
            this.ribbonTabItem2.Panel = this.ribbonPanel2;
            this.ribbonTabItem2.Text = "处理";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1272, 760);
            this.Controls.Add(this.barStatus);
            this.Controls.Add(this.panel);
            this.Controls.Add(this.ribbonControl1);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormMain";
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.Text = "MapCutter";
            this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.FormMain_FormClosing);
            this.Load += new System.EventHandler(this.FormMain_Load);
            ((System.ComponentModel.ISupportInitialize)(this.barStatus)).EndInit();
            this.ribbonControl1.ResumeLayout(false);
            this.ribbonControl1.PerformLayout();
            this.ribbonPanel2.ResumeLayout(false);
            this.ResumeLayout(false);

        }

        #endregion
        private System.Windows.Forms.Panel panel;
        private System.Windows.Forms.Timer timer1;
        private System.Windows.Forms.ToolTip toolTip;
        private DevComponents.DotNetBar.RibbonControl ribbonControl1;
        private DevComponents.DotNetBar.RibbonPanel ribbonPanel2;
        private DevComponents.DotNetBar.RibbonBar ribbonBar3;
        private DevComponents.DotNetBar.ButtonItem btnRegist;
        private DevComponents.DotNetBar.ButtonItem btnAbout;
        private DevComponents.DotNetBar.RibbonBar ribbonBar2;
        private DevComponents.DotNetBar.ButtonItem btnWeb;
        private DevComponents.DotNetBar.ButtonItem btnMergeFolder;
        private DevComponents.DotNetBar.ApplicationButton applicationButton1;
        private DevComponents.DotNetBar.ItemContainer itemContainer1;
        private DevComponents.DotNetBar.ItemContainer itemContainer2;
        private DevComponents.DotNetBar.ItemContainer itemContainer3;
        private DevComponents.DotNetBar.ButtonItem btnFileNew;
        private DevComponents.DotNetBar.ButtonItem btnFileOpen;
        private DevComponents.DotNetBar.ButtonItem btnFileSave;
        private DevComponents.DotNetBar.ItemContainer itemContainer4;
        private DevComponents.DotNetBar.ButtonItem btnExit;
        private DevComponents.DotNetBar.RibbonTabItem ribbonTabItem2;
        private DevComponents.DotNetBar.StyleManager styleManager1;
        private DevComponents.DotNetBar.ButtonItem btnCheckVersion;
        private DevComponents.DotNetBar.RibbonBar ribbonBar1;
        private DevComponents.DotNetBar.ButtonItem btnPrev;
        private DevComponents.DotNetBar.ButtonItem btnNext;
        private DevComponents.DotNetBar.Bar barStatus;
        private DevComponents.DotNetBar.LabelItem lblStatus;
        private DevComponents.DotNetBar.LabelItem lblZoom;
        private DevComponents.DotNetBar.LabelItem lblSize;
        private DevComponents.DotNetBar.LabelItem lblTiles;
        private DevComponents.DotNetBar.LabelItem lblTask;
        private DevComponents.DotNetBar.ProgressBarItem progress;
        private DevComponents.DotNetBar.LabelItem lblTime;
        private DevComponents.DotNetBar.ButtonItem btnHelp;
        private DevComponents.DotNetBar.ButtonItem btnFileSaveAs;
        private DevComponents.DotNetBar.ButtonItem btnConfig;
        private DevComponents.DotNetBar.ButtonItem btnPaint;
        private DevComponents.DotNetBar.ButtonItem btnMergeTiles;
    }
}



//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMergeMapFolders.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MapCutter.Components;
using System.IO;
using System.Drawing.Drawing2D;
using System.Drawing.Text;
using MapCutter.Licenses;
using System.Threading;
using MapCutter.Components.Mergers;
using Microsoft.WindowsAPICodePack.Dialogs;

namespace MapCutter
{
    [ComVisible(true)]
    public partial class FormMergeMapFolders : Form
    {
        public class Folder
        {
            public string Name { get; set; }
            public Folder(string name)
            {
                this.Name = name;
            }
        }

        static string _lastFolder;
        private BindingList<Folder> _folders = new BindingList<Folder>();

        //---------------------------------------------
        public FormMergeMapFolders()
        {
            InitializeComponent();
        }
        private void FormMergeMapFolders_Load(object sender, EventArgs e)
        {
            this.grid.AllowUserToAddRows = false;
            this.grid.AutoGenerateColumns = true;
            this.grid.DataSource = _folders;
        }

        //---------------------------------------------
        private void btnTargeFolder_Click(object sender, EventArgs e)
        {
            var dlg = new CommonOpenFileDialog("请设置合并文件夹");
            dlg.IsFolderPicker = true;
            dlg.Multiselect = false;
            if (CommonFileDialogResult.Ok == dlg.ShowDialog())
            {
                this.tbTargeFolder.Text = dlg.FileName;
            }
        }

        // 删除选中行
        private void btnDelete_Click(object sender, EventArgs e)
        {
            int n = grid.CurrentRow.Index;
            if (n != -1)
            {
                //var folder = grid.CurrentRow.DataBoundItem as Folder;
                this._folders.RemoveAt(n);
            }
        }

        // 清空
        private void btnClear_Click(object sender, EventArgs e)
        {
            _folders.Clear();
        }

        // set source folders
        private void btnAdd_Click(object sender, EventArgs e)
        {
            var dlg = new CommonOpenFileDialog("请选择多个源切片文件夹");
            dlg.IsFolderPicker = true;
            dlg.Multiselect = true;
            //dlg.RestoreDirectory = true;
            if (CommonFileDialogResult.Ok == dlg.ShowDialog())
            {
                foreach (var name in dlg.FileNames)
                {
                    if (_folders.FirstOrDefault(t => t.Name == name) == null)
                       _folders.Add(new Folder(name));
                }

                if (_folders.Count > 0)
                    this.tbTargeFolder.Text = _folders.FirstOrDefault().Name + "_merge";
            }
        }

        // 绘制行号
        private void grid_RowPostPaint(object sender, DataGridViewRowPostPaintEventArgs e)
        {
            Rectangle rectangle = new Rectangle(
                e.RowBounds.Location.X,
                e.RowBounds.Location.Y,
                grid.RowHeadersWidth - 4,
                e.RowBounds.Height
                );
            TextRenderer.DrawText(
                e.Graphics,
                (e.RowIndex + 1).ToString(),
                grid.RowHeadersDefaultCellStyle.Font,
                rectangle,
                grid.RowHeadersDefaultCellStyle.ForeColor,
                TextFormatFlags.VerticalCenter | TextFormatFlags.Right
                );
        }

        //---------------------------------------------
        private void btnGo_Click(object sender, EventArgs e)
        {
            var targetFolder = this.tbTargeFolder.Text;
            if (_folders.IsEmpty())
            {
                MessageBox.Show("请输入待合并目录列表");
                return;
            }
            if (targetFolder.IsEmpty())
            {
                MessageBox.Show("请输入目标目录");
                return;
            }

            // 合并处理
            this.btnGo.Enabled = false;
            var showBg = !AppLicense.Current.Apply.Features.Contains(AppFeature.HugeImage.ToString());
            var merger = new MapFolderMerger();
            merger.Progress += ShowProgress;
            merger.End += ShowEnd;
            merger.Merge(_folders.Cast(t=>t.Name), targetFolder, showBg);
        }

        // 显示进度
        void ShowProgress(string status, string file, int count)
        {
            Action action = () =>
            {
                if (status.IsNotEmpty()) this.lblStatus.Text = status;
                if (file.IsNotEmpty())   this.lblFile.Text = file;
                if (count != 0)          this.lblCount.Text = count.ToString();
            };
            this.Invoke(action);
        }

        // 显示处理结果
        void ShowEnd(string msg, string htmlFile)
        {
            Action action = () =>
            {
                this.btnGo.Enabled = true;
                MessageBox.Show(this, msg, "图片目录合并");
                if (htmlFile.IsNotEmpty())
                    System.Diagnostics.Process.Start(htmlFile);
            };
            this.Invoke(action);
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMergeMapFolders.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormMergeMapFolders
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormMergeMapFolders));
            this.toolStrip1 = new System.Windows.Forms.ToolStrip();
            this.btnAdd = new System.Windows.Forms.ToolStripButton();
            this.btnClear = new System.Windows.Forms.ToolStripButton();
            this.btnGo = new System.Windows.Forms.ToolStripButton();
            this.toolStripSeparator1 = new System.Windows.Forms.ToolStripSeparator();
            this.btnTargeFolder = new System.Windows.Forms.ToolStripButton();
            this.tbTargeFolder = new System.Windows.Forms.ToolStripTextBox();
            this.toolStripSeparator2 = new System.Windows.Forms.ToolStripSeparator();
            this.statusStrip1 = new System.Windows.Forms.StatusStrip();
            this.lblStatus = new System.Windows.Forms.ToolStripStatusLabel();
            this.lblFolder = new System.Windows.Forms.ToolStripStatusLabel();
            this.lblFile = new System.Windows.Forms.ToolStripStatusLabel();
            this.lblCount = new System.Windows.Forms.ToolStripStatusLabel();
            this.grid = new System.Windows.Forms.DataGridView();
            this.btnDelete = new System.Windows.Forms.ToolStripButton();
            this.toolStrip1.SuspendLayout();
            this.statusStrip1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grid)).BeginInit();
            this.SuspendLayout();
            // 
            this.toolStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.btnAdd,
            this.btnDelete,
            this.btnClear,
            this.btnGo,
            this.toolStripSeparator1,
            this.tbTargeFolder,
            this.btnTargeFolder,
            this.toolStripSeparator2});
            this.toolStrip1.Location = new System.Drawing.Point(0, 0);
            this.toolStrip1.Name = "toolStrip1";
            this.toolStrip1.Size = new System.Drawing.Size(840, 25);
            this.toolStrip1.TabIndex = 0;
            this.toolStrip1.Text = "toolStrip1";
            // 
            this.btnAdd.Image = global::MapCutter.Properties.Resources.add;
            this.btnAdd.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnAdd.Name = "btnAdd";
            this.btnAdd.Size = new System.Drawing.Size(52, 22);
            this.btnAdd.Text = "添加";
            this.btnAdd.ToolTipText = "添加多个待合并的地图目录，如 mapa_gaode, mapb_gaode";
            this.btnAdd.Click += new System.EventHandler(this.btnAdd_Click);
            // 
            this.btnClear.Image = global::MapCutter.Properties.Resources.wand;
            this.btnClear.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnClear.Name = "btnClear";
            this.btnClear.Size = new System.Drawing.Size(52, 22);
            this.btnClear.Text = "清空";
            this.btnClear.ToolTipText = "清空所有行";
            this.btnClear.Click += new System.EventHandler(this.btnClear_Click);
            // 
            this.btnGo.Image = global::MapCutter.Properties.Resources.forward;
            this.btnGo.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnGo.Name = "btnGo";
            this.btnGo.Size = new System.Drawing.Size(52, 22);
            this.btnGo.Text = "处理";
            this.btnGo.ToolTipText = "开始地图目录合并处理";
            this.btnGo.Click += new System.EventHandler(this.btnGo_Click);
            // 
            this.toolStripSeparator1.Name = "toolStripSeparator1";
            this.toolStripSeparator1.Size = new System.Drawing.Size(6, 25);
            // 
            this.btnTargeFolder.Image = global::MapCutter.Properties.Resources.folder;
            this.btnTargeFolder.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnTargeFolder.Name = "btnTargeFolder";
            this.btnTargeFolder.Size = new System.Drawing.Size(76, 22);
            this.btnTargeFolder.Text = "保存目录";
            this.btnTargeFolder.ToolTipText = "合并地图保存的目录";
            this.btnTargeFolder.Click += new System.EventHandler(this.btnTargeFolder_Click);
            // 
            this.tbTargeFolder.Font = new System.Drawing.Font("Microsoft YaHei UI", 9F);
            this.tbTargeFolder.Name = "tbTargeFolder";
            this.tbTargeFolder.Size = new System.Drawing.Size(500, 25);
            // 
            this.toolStripSeparator2.Name = "toolStripSeparator2";
            this.toolStripSeparator2.Size = new System.Drawing.Size(6, 25);
            // 
            this.statusStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.lblStatus,
            this.lblFolder,
            this.lblFile,
            this.lblCount});
            this.statusStrip1.Location = new System.Drawing.Point(0, 462);
            this.statusStrip1.Name = "statusStrip1";
            this.statusStrip1.Size = new System.Drawing.Size(840, 22);
            this.statusStrip1.TabIndex = 1;
            this.statusStrip1.Text = "statusStrip1";
            // 
            this.lblStatus.Name = "lblStatus";
            this.lblStatus.Size = new System.Drawing.Size(44, 17);
            this.lblStatus.Text = "Ready";
            // 
            this.lblFolder.Name = "lblFolder";
            this.lblFolder.Size = new System.Drawing.Size(45, 17);
            this.lblFolder.Text = "Folder";
            this.lblFolder.Visible = false;
            // 
            this.lblFile.Name = "lblFile";
            this.lblFile.Size = new System.Drawing.Size(27, 17);
            this.lblFile.Text = "File";
            // 
            this.lblCount.Name = "lblCount";
            this.lblCount.Size = new System.Drawing.Size(42, 17);
            this.lblCount.Text = "Count";
            // 
            this.grid.AutoSizeColumnsMode = System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill;
            this.grid.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.grid.Dock = System.Windows.Forms.DockStyle.Fill;
            this.grid.Location = new System.Drawing.Point(0, 25);
            this.grid.Name = "grid";
            this.grid.RowTemplate.Height = 23;
            this.grid.ShowEditingIcon = false;
            this.grid.Size = new System.Drawing.Size(840, 437);
            this.grid.TabIndex = 2;
            this.grid.RowPostPaint += new System.Windows.Forms.DataGridViewRowPostPaintEventHandler(this.grid_RowPostPaint);
            // 
            this.btnDelete.Image = global::MapCutter.Properties.Resources.cancel;
            this.btnDelete.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnDelete.Name = "btnDelete";
            this.btnDelete.Size = new System.Drawing.Size(52, 22);
            this.btnDelete.Text = "移除";
            this.btnDelete.ToolTipText = "移除选中的行";
            this.btnDelete.Click += new System.EventHandler(this.btnDelete_Click);
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(840, 484);
            this.Controls.Add(this.grid);
            this.Controls.Add(this.statusStrip1);
            this.Controls.Add(this.toolStrip1);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormMergeMapFolders";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "地图目录合并工具";
            this.Load += new System.EventHandler(this.FormMergeMapFolders_Load);
            this.toolStrip1.ResumeLayout(false);
            this.toolStrip1.PerformLayout();
            this.statusStrip1.ResumeLayout(false);
            this.statusStrip1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grid)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.ToolStrip toolStrip1;
        private System.Windows.Forms.ToolStripSeparator toolStripSeparator1;
        private System.Windows.Forms.ToolStripTextBox tbTargeFolder;
        private System.Windows.Forms.ToolStripButton btnAdd;
        private System.Windows.Forms.ToolStripButton btnGo;
        private System.Windows.Forms.ToolStripButton btnTargeFolder;
        private System.Windows.Forms.ToolStripSeparator toolStripSeparator2;
        private System.Windows.Forms.StatusStrip statusStrip1;
        private System.Windows.Forms.ToolStripStatusLabel lblStatus;
        private System.Windows.Forms.DataGridView grid;
        private System.Windows.Forms.ToolStripStatusLabel lblFolder;
        private System.Windows.Forms.ToolStripStatusLabel lblFile;
        private System.Windows.Forms.ToolStripStatusLabel lblCount;
        private System.Windows.Forms.ToolStripButton btnClear;
        private System.Windows.Forms.ToolStripButton btnDelete;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMergeMapTiles.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Web.UI.WebControls.WebParts;
using System.Windows.Forms;
using App.Core;
using CefSharp.DevTools.IndexedDB;
using MapCutter.Components;
using MapCutter.Components.Mergers;
using MapCutter.Licenses;
using NetVips;
using NetVips.Extensions;

namespace MapCutter.Forms
{
    public partial class FormMergeMapTiles : Form
    {
        static string _lastFolder;

        public FormMergeMapTiles()
        {
            InitializeComponent();
            this.cmbNameMode.SelectedIndex = 0;
            this.cmbCoodination.SelectedIndex = 0;
        }

        // 设置源切片目录
        private void btnSrcFolder_Click(object sender, EventArgs e)
        {
            FolderBrowserDialog dlg = new FolderBrowserDialog();
            if (_lastFolder.IsNotEmpty())
                dlg.SelectedPath = _lastFolder;
            if (DialogResult.OK == dlg.ShowDialog())
            {
                // source folders
                var folder = dlg.SelectedPath;
                _lastFolder = folder;
                this.tbSrcFolder.Text = folder;
                var dir = folder.GetFileFolder();
                var name = folder.GetFileName();

                // target folder
                var targetFile = string.Format(@"{0}\{1}_merge.png", dir, name);
                this.tbTgtFile.Text = targetFile;
            }
        }

        // 设置合并图片完整路径
        private void btnTgtFile_Click(object sender, EventArgs e)
        {
            SaveFileDialog dlg = new SaveFileDialog();
            dlg.Filter = "Png Images|*.png|All image files|*.png;*.jpg;*.jpeg;*.bmp;*.gif;*.tif;*.tiff;*.webp|All files|*.*";
            if (DialogResult.OK == dlg.ShowDialog())
            {
                this.tbTgtFile.Text = dlg.FileName;
            }
        }

        // 开始处理
        private void btnStart_Click(object sender, EventArgs e)
        {
            this.btnStart.Enabled = false;
            var srcFolder = this.tbSrcFolder.Text;
            var tgtFile = this.tbTgtFile.Text;
            var mode = this.cmbNameMode.SelectedItem.ToString();   //  x-y, y-x, /x/y, /y/x
            var cood = this.cmbCoodination.SelectedItem.ToString(); // Y Down, Y Up
            bool yDown = (cood == "Y Down");

            //
            var merger = new MapTileMerger();
            merger.Error += ShowError;
            merger.Ready += ShowReady;
            merger.Progress += ShowProgress;
            merger.End += ShowEnd;
            merger.MergeTiles(srcFolder, tgtFile, mode, yDown, !AppLicense.Current.IsRegist);
        }

        // 错误处理
        void ShowError(string info)
        {
            MessageBox.Show(this, info);
        }

        // 显示准备就绪
        private void ShowReady(int w, int h, int cnt)
        {
            this.lblStatus.Text = "GO";
            this.lblSize.Text = string.Format("{0}x{1}", w, h);
            this.lblCount.Text = cnt.ToString();
            this.progress.Maximum = cnt;
            this.progress.Minimum = 0;
            this.progress.Value = 0;
        }

        // 显示进度
        void ShowProgress(string status, int current, int total)
        {
            Action action = () =>
            {
                if (status.IsNotEmpty()) this.lblStatus.Text = status;
                if (current != 0) this.progress.Value = current;
                this.lblCount.Text = string.Format("{0}/{1}", current, total);
            };
            this.Invoke(action);
        }

        // 显示结果
        void ShowEnd(string status, string msg)
        {
            Action action = () =>
            {
                this.lblStatus.Text = status;
                this.btnStart.Enabled = true;
                MessageBox.Show(this, msg);
            };
            this.Invoke(action);
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormMergeMapTiles.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter.Forms
{
    partial class FormMergeMapTiles
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormMergeMapTiles));
            this.label1 = new System.Windows.Forms.Label();
            this.tbSrcFolder = new System.Windows.Forms.TextBox();
            this.btnSrcFolder = new System.Windows.Forms.Button();
            this.btnTgtFile = new System.Windows.Forms.Button();
            this.tbTgtFile = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.statusStrip1 = new System.Windows.Forms.StatusStrip();
            this.lblStatus = new System.Windows.Forms.ToolStripStatusLabel();
            this.lblCount = new System.Windows.Forms.ToolStripStatusLabel();
            this.progress = new System.Windows.Forms.ToolStripProgressBar();
            this.btnStart = new System.Windows.Forms.Button();
            this.label3 = new System.Windows.Forms.Label();
            this.cmbNameMode = new System.Windows.Forms.ComboBox();
            this.label4 = new System.Windows.Forms.Label();
            this.cmbCoodination = new System.Windows.Forms.ComboBox();
            this.toolTip1 = new System.Windows.Forms.ToolTip(this.components);
            this.lblSize = new System.Windows.Forms.ToolStripStatusLabel();
            this.statusStrip1.SuspendLayout();
            this.SuspendLayout();
            // 
            this.label1.AutoSize = true;
            this.label1.Location = new System.Drawing.Point(27, 18);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(65, 12);
            this.label1.TabIndex = 0;
            this.label1.Text = "源切片目录";
            // 
            this.tbSrcFolder.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbSrcFolder.Location = new System.Drawing.Point(112, 12);
            this.tbSrcFolder.Name = "tbSrcFolder";
            this.tbSrcFolder.Size = new System.Drawing.Size(503, 21);
            this.tbSrcFolder.TabIndex = 1;
            this.toolTip1.SetToolTip(this.tbSrcFolder, "请设置为某一级别的地图目录，如 /tiles/16/");
            // 
            this.btnSrcFolder.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnSrcFolder.Location = new System.Drawing.Point(621, 11);
            this.btnSrcFolder.Name = "btnSrcFolder";
            this.btnSrcFolder.Size = new System.Drawing.Size(75, 23);
            this.btnSrcFolder.TabIndex = 2;
            this.btnSrcFolder.Text = "设置";
            this.btnSrcFolder.UseVisualStyleBackColor = true;
            this.btnSrcFolder.Click += new System.EventHandler(this.btnSrcFolder_Click);
            // 
            this.btnTgtFile.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnTgtFile.Location = new System.Drawing.Point(621, 43);
            this.btnTgtFile.Name = "btnTgtFile";
            this.btnTgtFile.Size = new System.Drawing.Size(75, 23);
            this.btnTgtFile.TabIndex = 5;
            this.btnTgtFile.Text = "设置";
            this.btnTgtFile.UseVisualStyleBackColor = true;
            this.btnTgtFile.Click += new System.EventHandler(this.btnTgtFile_Click);
            // 
            this.tbTgtFile.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbTgtFile.Location = new System.Drawing.Point(112, 43);
            this.tbTgtFile.Name = "tbTgtFile";
            this.tbTgtFile.Size = new System.Drawing.Size(503, 21);
            this.tbTgtFile.TabIndex = 4;
            this.toolTip1.SetToolTip(this.tbTgtFile, "合成图片的完整路径");
            // 
            this.label2.AutoSize = true;
            this.label2.Location = new System.Drawing.Point(27, 49);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(77, 12);
            this.label2.TabIndex = 3;
            this.label2.Text = "合并图片文件";
            // 
            this.statusStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.lblStatus,
            this.lblSize,
            this.lblCount,
            this.progress});
            this.statusStrip1.Location = new System.Drawing.Point(0, 209);
            this.statusStrip1.Name = "statusStrip1";
            this.statusStrip1.Size = new System.Drawing.Size(711, 22);
            this.statusStrip1.TabIndex = 6;
            this.statusStrip1.Text = "statusStrip1";
            // 
            this.lblStatus.Name = "lblStatus";
            this.lblStatus.Size = new System.Drawing.Size(47, 17);
            this.lblStatus.Text = "READY";
            // 
            this.lblCount.Name = "lblCount";
            this.lblCount.Size = new System.Drawing.Size(52, 17);
            this.lblCount.Text = "COUNT";
            // 
            this.progress.Name = "progress";
            this.progress.Size = new System.Drawing.Size(200, 16);
            // 
            this.btnStart.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.btnStart.Location = new System.Drawing.Point(277, 173);
            this.btnStart.Name = "btnStart";
            this.btnStart.Size = new System.Drawing.Size(116, 23);
            this.btnStart.TabIndex = 7;
            this.btnStart.Text = "开始";
            this.btnStart.UseVisualStyleBackColor = true;
            this.btnStart.Click += new System.EventHandler(this.btnStart_Click);
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(27, 79);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(65, 12);
            this.label3.TabIndex = 8;
            this.label3.Text = "切片名模式";
            // 
            this.cmbNameMode.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbNameMode.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbNameMode.FormattingEnabled = true;
            this.cmbNameMode.Items.AddRange(new object[] {
            "/x/y",
            "/y/x",
            "x_y",
            "y_x"});
            this.cmbNameMode.Location = new System.Drawing.Point(112, 74);
            this.cmbNameMode.Name = "cmbNameMode";
            this.cmbNameMode.Size = new System.Drawing.Size(503, 20);
            this.cmbNameMode.TabIndex = 9;
            this.toolTip1.SetToolTip(this.cmbNameMode, "常用的模式有：\r\n（1）x_y，对应类似 3424_32422.png 的切片\r\n（2）x/y，对应类似 /3424/32422.png 的切片");
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(27, 109);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(53, 12);
            this.label4.TabIndex = 10;
            this.label4.Text = "坐标系统";
            // 
            this.cmbCoodination.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbCoodination.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbCoodination.FormattingEnabled = true;
            this.cmbCoodination.Items.AddRange(new object[] {
            "Y Down",
            "Y Up"});
            this.cmbCoodination.Location = new System.Drawing.Point(112, 104);
            this.cmbCoodination.Name = "cmbCoodination";
            this.cmbCoodination.Size = new System.Drawing.Size(503, 20);
            this.cmbCoodination.TabIndex = 11;
            this.toolTip1.SetToolTip(this.cmbCoodination, "Y Down 表示Y坐标轴朝下，切块 Y 坐标值越大，切块位于地图的越下方；\r\nY UP 表示Y坐标轴朝上，切块 Y 坐标值越大，切块位于地图的越上方；");
            // 
            this.lblSize.Name = "lblSize";
            this.lblSize.Size = new System.Drawing.Size(33, 17);
            this.lblSize.Text = "SIZE";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(711, 231);
            this.Controls.Add(this.cmbCoodination);
            this.Controls.Add(this.label4);
            this.Controls.Add(this.cmbNameMode);
            this.Controls.Add(this.label3);
            this.Controls.Add(this.btnStart);
            this.Controls.Add(this.statusStrip1);
            this.Controls.Add(this.btnTgtFile);
            this.Controls.Add(this.tbTgtFile);
            this.Controls.Add(this.label2);
            this.Controls.Add(this.btnSrcFolder);
            this.Controls.Add(this.tbSrcFolder);
            this.Controls.Add(this.label1);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormMergeTiles";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "合并切片（此操作需海量内存）";
            this.statusStrip1.ResumeLayout(false);
            this.statusStrip1.PerformLayout();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox tbSrcFolder;
        private System.Windows.Forms.Button btnSrcFolder;
        private System.Windows.Forms.Button btnTgtFile;
        private System.Windows.Forms.TextBox tbTgtFile;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.StatusStrip statusStrip1;
        private System.Windows.Forms.ToolStripStatusLabel lblStatus;
        private System.Windows.Forms.ToolStripStatusLabel lblCount;
        private System.Windows.Forms.ToolStripProgressBar progress;
        private System.Windows.Forms.Button btnStart;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.ComboBox cmbNameMode;
        private System.Windows.Forms.Label label4;
        private System.Windows.Forms.ComboBox cmbCoodination;
        private System.Windows.Forms.ToolTip toolTip1;
        private System.Windows.Forms.ToolStripStatusLabel lblSize;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormPosition.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MapCutter.Components;
using CefSharp;

namespace MapCutter
{
    [ComVisible(true)]
    public partial class FormPosition : Form
    {
        /// <summary>经纬度位置</summary>
        public PointD Position { get; set; }
        public MapType MapType { get; set; }

        //
        StepPreview _parentForm;
        TileConfig _config;

        //---------------------------------------------
        public FormPosition()
        {
            InitializeComponent();
            this.Position = new PointD(116.398, 39.9295);
        }
        public FormPosition(StepPreview form, TileConfig config, PointD p)
        {
            InitializeComponent();
            this._config = config;
            this._parentForm = form;
            this.MapType = config.MapType;
            this.Position = p;
        }
        private void FormPosition_Load(object sender, EventArgs e)
        {
            this.webView.JavascriptMessageReceived += webView_JavascriptMessageReceived;
            this.webView.LoadUrl("");
            this.tbPoint.Text = this.Position.ToString();
            ShowHtml(this.Position);
        }

        //---------------------------------------------
        private void btnCancel_Click(object sender, EventArgs e)
        {
            this.DialogResult = DialogResult.Cancel;
            this.Close();
        }

        // 保存并关闭
        private void btnSave_Click(object sender, EventArgs e)
        {
            this.DialogResult = DialogResult.OK;
            this.Position = PointD.Parse(tbPoint.Text);
            this.Close();
        }

        //---------------------------------------------
        private void tbGoLocation_Click(object sender, EventArgs e)
        {
            if (this.tbPoint.Text.IsNotEmpty())
            {
                var lnglat = this.tbPoint.Text;
                var n = lnglat.IndexOf(',');
                if (n != -1)
                {
                    var lng = lnglat.Substring(0, n);
                    var lat = lnglat.Substring(n + 1);
                    InvokeGoto(lng, lat);
                }
            }
        }

        // 查找。调用js方法 search(addr)
        private void btnSearch_Click(object sender, EventArgs e)
        {
            var addr = this.tbAddr.Text;
            if (addr.IsNotEmpty())
            {
                InvokeSearch(addr);
            }
        }

        //---------------------------------------------
        public void ShowHtml(PointD p)
        {
            var html = MapCutters.GetCutter(this.MapType).BuildPositionHtml(this.Position);
            var url = _parentForm.StartWebServer(_config.ImagePath.GetFileFolder(), "/position", html);
            webView.LoadUrl(url);

            //var encoding = new UTF8Encoding(false); // 默认文本都是带UTF-8 BOM头的（EFBBBF），这个参数false表示去除 BOM
        }

        // 调用js方法 goto(lng, lat)
        private void InvokeGoto(string lng, string lat)
        {
            var func = string.Format("goto('{0}', '{1}')", lng, lat);
            webView.ExecuteScriptAsync(func);
        }

        // 调用js方法 search(addr)
        private void InvokeSearch(string addr)
        {
            var func = string.Format("search('{0}')", addr);
            webView.ExecuteScriptAsync(func);
        }

        /// <summary>隐藏滚动条</summary>
        private void webView_FrameLoadEnd(object sender, FrameLoadEndEventArgs e)
        {
            if (e.Frame.IsMain)
                e.Browser.MainFrame.ExecuteJavaScriptAsync("document.body.style.overflow = 'hidden'");
        }

        /// <summary>调用宿主方法, 处理 js 发来的命令</summary>
        private void webView_JavascriptMessageReceived(object sender, JavascriptMessageReceivedEventArgs e)
        {
            Action action = () =>
            {
                var cmd = e.Message.ToString();
                var p = cmd.SplitString();
                if (p[0] == "ShowLngLat")
                    ShowLngLat(p[1], p[2]);
                else if (p[0] == "ShowAddr")
                    ShowAddr(p[1]);
            };
            Invoke(action);
        }

        /// <summary>显示经纬度。js 回调时会触发该方法（切勿删除）</summary>
        public void ShowLngLat(string lng, string lat)
        {
            this.tbPoint.Text = string.Format("{0}, {1}", lng, lat);
        }

        /// <summary>显示文本地址。js 回调时会触发该方法（切勿删除）</summary>
        public void ShowAddr(string addr)
        {
            this.tbAddr.Text = addr;
        }

        // <summary>彩蛋：出于开发方便，打开开发工具（ctrl+alt+双击）</summary>
        private void toolStrip_DoubleClick(object sender, EventArgs e)
        {
            if (Win32.GetAsyncKeyState(Win32.VK_CONTROL) < 0 && Win32.GetAsyncKeyState(Win32.VK_ALT) < 0)
                webView.ShowDevTools();
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormPosition.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormPosition
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormPosition));
            this.toolStrip = new System.Windows.Forms.ToolStrip();
            this.btnSave = new System.Windows.Forms.ToolStripButton();
            this.btnCancel = new System.Windows.Forms.ToolStripButton();
            this.toolStripSeparator1 = new System.Windows.Forms.ToolStripSeparator();
            this.tbPoint = new System.Windows.Forms.ToolStripTextBox();
            this.tbGoLocation = new System.Windows.Forms.ToolStripButton();
            this.tbAddr = new System.Windows.Forms.ToolStripTextBox();
            this.btnSearch = new System.Windows.Forms.ToolStripButton();
            this.webView = new CefSharp.WinForms.ChromiumWebBrowser();
            this.toolStrip.SuspendLayout();
            this.SuspendLayout();
            // 
            this.toolStrip.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
            this.btnSave,
            this.btnCancel,
            this.toolStripSeparator1,
            this.tbPoint,
            this.tbGoLocation,
            this.tbAddr,
            this.btnSearch});
            this.toolStrip.Location = new System.Drawing.Point(0, 0);
            this.toolStrip.Name = "toolStrip";
            this.toolStrip.Size = new System.Drawing.Size(840, 25);
            this.toolStrip.TabIndex = 0;
            this.toolStrip.Text = "toolStrip1";
            this.toolStrip.DoubleClick += new System.EventHandler(this.toolStrip_DoubleClick);
            // 
            this.btnSave.Image = global::MapCutter.Properties.Resources.disk;
            this.btnSave.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnSave.Name = "btnSave";
            this.btnSave.Size = new System.Drawing.Size(52, 22);
            this.btnSave.Text = "保存";
            this.btnSave.Click += new System.EventHandler(this.btnSave_Click);
            // 
            this.btnCancel.Image = global::MapCutter.Properties.Resources.cancel;
            this.btnCancel.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnCancel.Name = "btnCancel";
            this.btnCancel.Size = new System.Drawing.Size(52, 22);
            this.btnCancel.Text = "取消";
            this.btnCancel.Click += new System.EventHandler(this.btnCancel_Click);
            // 
            this.toolStripSeparator1.Name = "toolStripSeparator1";
            this.toolStripSeparator1.Size = new System.Drawing.Size(6, 25);
            // 
            this.tbPoint.Font = new System.Drawing.Font("Microsoft YaHei UI", 9F);
            this.tbPoint.Name = "tbPoint";
            this.tbPoint.Size = new System.Drawing.Size(250, 25);
            // 
            this.tbGoLocation.Image = global::MapCutter.Properties.Resources.arrow_in_longer1;
            this.tbGoLocation.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.tbGoLocation.Name = "tbGoLocation";
            this.tbGoLocation.Size = new System.Drawing.Size(88, 22);
            this.tbGoLocation.Text = "移到该坐标";
            this.tbGoLocation.Click += new System.EventHandler(this.tbGoLocation_Click);
            // 
            this.tbAddr.Font = new System.Drawing.Font("Microsoft YaHei UI", 9F);
            this.tbAddr.Name = "tbAddr";
            this.tbAddr.Size = new System.Drawing.Size(250, 25);
            // 
            this.btnSearch.Image = global::MapCutter.Properties.Resources.magnifier;
            this.btnSearch.ImageTransparentColor = System.Drawing.Color.Magenta;
            this.btnSearch.Name = "btnSearch";
            this.btnSearch.Size = new System.Drawing.Size(76, 22);
            this.btnSearch.Text = "查找地址";
            this.btnSearch.Click += new System.EventHandler(this.btnSearch_Click);
            // 
            this.webView.ActivateBrowserOnCreation = false;
            this.webView.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
// TODO: “”的代码生成失败，原因是出现异常“无效的基元类型: System.IntPtr。请考虑使用 CodeObjectCreateExpression。”。
            this.webView.Location = new System.Drawing.Point(5, 28);
            this.webView.Name = "webView";
            this.webView.Size = new System.Drawing.Size(830, 453);
            this.webView.TabIndex = 1;
            this.webView.FrameLoadEnd += new System.EventHandler<CefSharp.FrameLoadEndEventArgs>(this.webView_FrameLoadEnd);
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(840, 484);
            this.Controls.Add(this.webView);
            this.Controls.Add(this.toolStrip);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormPosition";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "位置（请拖动地图设置地图中心点）";
            this.Load += new System.EventHandler(this.FormPosition_Load);
            this.toolStrip.ResumeLayout(false);
            this.toolStrip.PerformLayout();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.ToolStrip toolStrip;
        private System.Windows.Forms.ToolStripButton btnSave;
        private System.Windows.Forms.ToolStripButton btnCancel;
        private System.Windows.Forms.ToolStripSeparator toolStripSeparator1;
        private System.Windows.Forms.ToolStripTextBox tbPoint;
        private System.Windows.Forms.ToolStripButton tbGoLocation;
        private System.Windows.Forms.ToolStripTextBox tbAddr;
        private System.Windows.Forms.ToolStripButton btnSearch;
        private CefSharp.WinForms.ChromiumWebBrowser webView;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormRegist.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MapCutter.Components;
using MapCutter.Licenses;
using System.Reflection;

namespace MapCutter
{
    public partial class FormRegist : Form
    {
        static string _machine = HardwareHelper.GetCPU();

        public FormRegist()
        {
            InitializeComponent();
            clbFeature.BindEnum<AppFeature>(null, true);
            clbFeature.SetEnumValue(AppFeature.HugeImage, false);
            //clbFeature.SetEnumValue(AppFeature.Console, false);
            ShowApplyCode();
            this.clbFeature.CheckOnClick = true;
            this.clbFeature.ItemCheck += new ItemCheckEventHandler(this.clbFeature_ItemCheck);
        }

        // 项变更时触发（此时还未修改值，非常绕，可以以下方法获取变更后的值）
        private void clbFeature_ItemCheck(object sender, ItemCheckEventArgs e)
        {
            // 手工设置一下其 Check 状态(CheckedItems 才会变更)
            this.clbFeature.ItemCheck -= new ItemCheckEventHandler(this.clbFeature_ItemCheck);
            clbFeature.SetItemCheckState(e.Index, e.NewValue);
            this.clbFeature.ItemCheck += new ItemCheckEventHandler(this.clbFeature_ItemCheck);

            //
            BuildApplyCode();
        }

        // 授权时间变更，刷新申请码
        private void tbMonth_ValueChanged(object sender, EventArgs e)
        {
            BuildApplyCode();
        }

        /// <summary>创建请求码</summary>
        void ShowApplyCode()
        {
            var license = AppLicense.Current;
            if (!license.IsRegist)
            {
                BuildApplyCode();
            }
            else
            {
                this.lblId.Text = license.ID;
                this.tbUser.Text = license.Apply.User;
                this.tbMonth.Value = license.Apply.Months;
                if (license.ExpireDate != null)
                {
                    var localDate = TimeZoneInfo.ConvertTimeFromUtc(license.ExpireDate.Value, TimeZoneInfo.Local);
                    this.lblExpireDt.Text = localDate.ToString("yyyy-MM-dd");
                }
                this.tbApplyCode.Text = AppLicense.GetApplyCode(license.Apply);
                this.tbRegistCode.Text = license.RegistCode;
                var enums = license.Apply.Features.Cast(t => t.ParseEnum<AppFeature>().Value);
                UI.SetEnums(this.clbFeature, enums);
            }
        }

        // 生成申请码并显示
        private void BuildApplyCode()
        {
            var user = UI.GetText(tbUser);
            var assembly = typeof(Program).Assembly;
            var app = assembly.GetAssemblyTitle();
            var version = assembly.GetName().Version.ToString();
            var months = (int)this.tbMonth.Value;
            var features = UI.GetEnums<AppFeature>(this.clbFeature).CastString();
            var info = new ApplyInfo(user, app, version, _machine, months, features);
            this.tbApplyCode.Text = AppLicense.GetApplyCode(info);
        }

        // 取消
        private void btnCancel_Click(object sender, EventArgs e)
        {
            this.DialogResult = DialogResult.Cancel;
            this.Close();
        }

        // 注册
        private void btnRegist_Click(object sender, EventArgs e)
        {
            var applyCode = this.tbApplyCode.Text;
            var registCode = this.tbRegistCode.Text;
            var license = AppLicense.Check(applyCode, registCode);
            if (license != null)
            {
                try
                {
                    license.Save();
                    AppLicense.Current = license;
                    MessageBox.Show("注册成功，请备份保存好生成的 app.license 文件。");
                    this.DialogResult = DialogResult.OK;
                    this.Close();
                }
                catch (Exception ex)
                {
                    MessageBox.Show(
                        "保存 license 文件时发生异常，请检查当前用户是否有该目录的写入权限。错误原因："
                        + ex.Message
                        );
                }
            }
            else
            {
                MessageBox.Show("注册码不正确");
            }
        }

        /// <summary>彩蛋，让月份框可输入，按住ctrl键双击label</summary>
        private void lblMonth_DoubleClick(object sender, EventArgs e)
        {
            if (Win32.GetAsyncKeyState(Win32.VK_CONTROL) < 0)
                this.tbMonth.Enabled = true;
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormRegist.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormRegist
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormRegist));
            this.label1 = new System.Windows.Forms.Label();
            this.panel1 = new System.Windows.Forms.Panel();
            this.lblId = new System.Windows.Forms.Label();
            this.lblExpireDt = new System.Windows.Forms.Label();
            this.btnCancel = new System.Windows.Forms.Button();
            this.btnRegist = new System.Windows.Forms.Button();
            this.tbApplyCode = new System.Windows.Forms.TextBox();
            this.label9 = new System.Windows.Forms.Label();
            this.tbRegistCode = new System.Windows.Forms.TextBox();
            this.label12 = new System.Windows.Forms.Label();
            this.label2 = new System.Windows.Forms.Label();
            this.pictureBox1 = new System.Windows.Forms.PictureBox();
            this.pictureBox3 = new System.Windows.Forms.PictureBox();
            this.label4 = new System.Windows.Forms.Label();
            this.label3 = new System.Windows.Forms.Label();
            this.clbFeature = new System.Windows.Forms.CheckedListBox();
            this.tbUser = new System.Windows.Forms.TextBox();
            this.label5 = new System.Windows.Forms.Label();
            this.lblMonth = new System.Windows.Forms.Label();
            this.tbMonth = new System.Windows.Forms.NumericUpDown();
            this.label7 = new System.Windows.Forms.Label();
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.tbMonth)).BeginInit();
            this.SuspendLayout();
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("Impact", 36F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label1.ForeColor = System.Drawing.Color.White;
            this.label1.Location = new System.Drawing.Point(16, 9);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(232, 60);
            this.label1.TabIndex = 0;
            this.label1.Text = "MapCutter";
            // 
            this.panel1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(67)))), ((int)(((byte)(144)))), ((int)(((byte)(247)))));
            this.panel1.Controls.Add(this.lblId);
            this.panel1.Controls.Add(this.label1);
            this.panel1.Controls.Add(this.lblExpireDt);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(597, 78);
            this.panel1.TabIndex = 16;
            // 
            this.lblId.AutoSize = true;
            this.lblId.ForeColor = System.Drawing.Color.White;
            this.lblId.Location = new System.Drawing.Point(267, 25);
            this.lblId.Name = "lblId";
            this.lblId.Size = new System.Drawing.Size(23, 12);
            this.lblId.TabIndex = 40;
            this.lblId.Text = "...";
            this.lblId.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            // 
            this.lblExpireDt.AutoSize = true;
            this.lblExpireDt.ForeColor = System.Drawing.Color.White;
            this.lblExpireDt.Location = new System.Drawing.Point(267, 50);
            this.lblExpireDt.Name = "lblExpireDt";
            this.lblExpireDt.Size = new System.Drawing.Size(23, 12);
            this.lblExpireDt.TabIndex = 39;
            this.lblExpireDt.Text = "...";
            this.lblExpireDt.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            // 
            this.btnCancel.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnCancel.Location = new System.Drawing.Point(510, 590);
            this.btnCancel.Name = "btnCancel";
            this.btnCancel.Size = new System.Drawing.Size(75, 23);
            this.btnCancel.TabIndex = 18;
            this.btnCancel.Text = "取消";
            this.btnCancel.UseVisualStyleBackColor = true;
            this.btnCancel.Click += new System.EventHandler(this.btnCancel_Click);
            // 
            this.btnRegist.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnRegist.Location = new System.Drawing.Point(429, 590);
            this.btnRegist.Name = "btnRegist";
            this.btnRegist.Size = new System.Drawing.Size(75, 23);
            this.btnRegist.TabIndex = 20;
            this.btnRegist.Text = "注册";
            this.btnRegist.UseVisualStyleBackColor = true;
            this.btnRegist.Click += new System.EventHandler(this.btnRegist_Click);
            // 
            this.tbApplyCode.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbApplyCode.Location = new System.Drawing.Point(90, 251);
            this.tbApplyCode.Multiline = true;
            this.tbApplyCode.Name = "tbApplyCode";
            this.tbApplyCode.ReadOnly = true;
            this.tbApplyCode.Size = new System.Drawing.Size(498, 79);
            this.tbApplyCode.TabIndex = 24;
            // 
            this.label9.AutoSize = true;
            this.label9.Location = new System.Drawing.Point(23, 254);
            this.label9.Name = "label9";
            this.label9.Size = new System.Drawing.Size(41, 12);
            this.label9.TabIndex = 23;
            this.label9.Text = "申请码";
            // 
            this.tbRegistCode.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbRegistCode.Location = new System.Drawing.Point(90, 336);
            this.tbRegistCode.Name = "tbRegistCode";
            this.tbRegistCode.Size = new System.Drawing.Size(498, 21);
            this.tbRegistCode.TabIndex = 22;
            // 
            this.label12.AutoSize = true;
            this.label12.Location = new System.Drawing.Point(23, 339);
            this.label12.Name = "label12";
            this.label12.Size = new System.Drawing.Size(41, 12);
            this.label12.TabIndex = 21;
            this.label12.Text = "注册码";
            // 
            this.label2.AutoSize = true;
            this.label2.Location = new System.Drawing.Point(115, 531);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(65, 12);
            this.label2.TabIndex = 26;
            this.label2.Text = "微信联系我\r\n";
            this.label2.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
            // 
            this.pictureBox1.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox1.Image")));
            this.pictureBox1.Location = new System.Drawing.Point(91, 396);
            this.pictureBox1.Name = "pictureBox1";
            this.pictureBox1.Size = new System.Drawing.Size(125, 122);
            this.pictureBox1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
            this.pictureBox1.TabIndex = 25;
            this.pictureBox1.TabStop = false;
            // 
            this.pictureBox3.Image = ((System.Drawing.Image)(resources.GetObject("pictureBox3.Image")));
            this.pictureBox3.Location = new System.Drawing.Point(235, 396);
            this.pictureBox3.Name = "pictureBox3";
            this.pictureBox3.Size = new System.Drawing.Size(125, 122);
            this.pictureBox3.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
            this.pictureBox3.TabIndex = 29;
            this.pictureBox3.TabStop = false;
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(267, 531);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(53, 12);
            this.label4.TabIndex = 30;
            this.label4.Text = "QQ联系我";
            this.label4.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(24, 121);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(29, 12);
            this.label3.TabIndex = 31;
            this.label3.Text = "功能";
            // 
            this.clbFeature.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.clbFeature.FormattingEnabled = true;
            this.clbFeature.Location = new System.Drawing.Point(90, 121);
            this.clbFeature.MultiColumn = true;
            this.clbFeature.Name = "clbFeature";
            this.clbFeature.Size = new System.Drawing.Size(498, 84);
            this.clbFeature.TabIndex = 32;
            // 
            this.tbUser.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbUser.Location = new System.Drawing.Point(90, 93);
            this.tbUser.Name = "tbUser";
            this.tbUser.Size = new System.Drawing.Size(498, 21);
            this.tbUser.TabIndex = 34;
            // 
            this.label5.AutoSize = true;
            this.label5.Location = new System.Drawing.Point(23, 96);
            this.label5.Name = "label5";
            this.label5.Size = new System.Drawing.Size(29, 12);
            this.label5.TabIndex = 33;
            this.label5.Text = "用户";
            // 
            this.lblMonth.AutoSize = true;
            this.lblMonth.Location = new System.Drawing.Point(23, 219);
            this.lblMonth.Name = "lblMonth";
            this.lblMonth.Size = new System.Drawing.Size(53, 12);
            this.lblMonth.TabIndex = 35;
            this.lblMonth.Text = "授权时长";
            this.lblMonth.DoubleClick += new System.EventHandler(this.lblMonth_DoubleClick);
            // 
            this.tbMonth.Enabled = false;
            this.tbMonth.Location = new System.Drawing.Point(90, 217);
            this.tbMonth.Maximum = new decimal(new int[] {
            1200,
            0,
            0,
            0});
            this.tbMonth.Name = "tbMonth";
            this.tbMonth.Size = new System.Drawing.Size(120, 21);
            this.tbMonth.TabIndex = 36;
            this.tbMonth.Value = new decimal(new int[] {
            1200,
            0,
            0,
            0});
            this.tbMonth.ValueChanged += new System.EventHandler(this.tbMonth_ValueChanged);
            // 
            this.label7.AutoSize = true;
            this.label7.Location = new System.Drawing.Point(216, 219);
            this.label7.Name = "label7";
            this.label7.Size = new System.Drawing.Size(29, 12);
            this.label7.TabIndex = 37;
            this.label7.Text = "个月";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(597, 625);
            this.Controls.Add(this.label7);
            this.Controls.Add(this.tbMonth);
            this.Controls.Add(this.lblMonth);
            this.Controls.Add(this.tbUser);
            this.Controls.Add(this.label5);
            this.Controls.Add(this.clbFeature);
            this.Controls.Add(this.label3);
            this.Controls.Add(this.label4);
            this.Controls.Add(this.pictureBox3);
            this.Controls.Add(this.label2);
            this.Controls.Add(this.pictureBox1);
            this.Controls.Add(this.tbApplyCode);
            this.Controls.Add(this.label9);
            this.Controls.Add(this.tbRegistCode);
            this.Controls.Add(this.label12);
            this.Controls.Add(this.btnRegist);
            this.Controls.Add(this.btnCancel);
            this.Controls.Add(this.panel1);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormRegist";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "Regist";
            this.panel1.ResumeLayout(false);
            this.panel1.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.tbMonth)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.Button btnCancel;
        private System.Windows.Forms.Button btnRegist;
        private System.Windows.Forms.TextBox tbApplyCode;
        private System.Windows.Forms.Label label9;
        private System.Windows.Forms.TextBox tbRegistCode;
        private System.Windows.Forms.Label label12;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.PictureBox pictureBox1;
        private System.Windows.Forms.PictureBox pictureBox3;
        private System.Windows.Forms.Label label4;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.CheckedListBox clbFeature;
        private System.Windows.Forms.TextBox tbUser;
        private System.Windows.Forms.Label label5;
        private System.Windows.Forms.Label lblMonth;
        private System.Windows.Forms.NumericUpDown tbMonth;
        private System.Windows.Forms.Label label7;
        private System.Windows.Forms.Label lblExpireDt;
        private System.Windows.Forms.Label lblId;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormTest.cs
//////////////////////////////////////////////////////
using CefSharp;
using CefSharp.WinForms;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Forms
{
    public partial class FormTest : Form
    {
        public FormTest()
        {
            InitializeComponent();
        }

        private void FormTest_Load(object sender, EventArgs e)
        {
            var settings = new CefSettings();
            settings.CefCommandLineArgs.Add("disable-gpu", "1"); //添加禁用GPU cefsharp 63.0
            Cef.Initialize(settings);
            this.webView.LoadUrl("http://baidu.com/");
            //this.webView.LoadHtml("Hello world");
        }

        /// <summary>获取当前是否处于设计器模式</summary>
        private bool IsDesignMode()
        {
            return (this.GetService(typeof(System.ComponentModel.Design.IDesignerHost)) != null
                || LicenseManager.UsageMode == LicenseUsageMode.Designtime);
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormTest.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter.Forms
{
    partial class FormTest
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.dotNetBarManager1 = new DevComponents.DotNetBar.DotNetBarManager(this.components);
            this.dockSite1 = new DevComponents.DotNetBar.DockSite();
            this.dockSite2 = new DevComponents.DotNetBar.DockSite();
            this.dockSite3 = new DevComponents.DotNetBar.DockSite();
            this.dockSite4 = new DevComponents.DotNetBar.DockSite();
            this.dockSite5 = new DevComponents.DotNetBar.DockSite();
            this.dockSite6 = new DevComponents.DotNetBar.DockSite();
            this.dockSite7 = new DevComponents.DotNetBar.DockSite();
            this.dockSite8 = new DevComponents.DotNetBar.DockSite();
            this.bar1 = new DevComponents.DotNetBar.Bar();
            this.dockContainerItem1 = new DevComponents.DotNetBar.DockContainerItem();
            this.panelDockContainer1 = new DevComponents.DotNetBar.PanelDockContainer();
            this.checkBoxX1 = new DevComponents.DotNetBar.Controls.CheckBoxX();
            this.webView = new CefSharp.WinForms.ChromiumWebBrowser();
            this.dockSite1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.bar1)).BeginInit();
            this.bar1.SuspendLayout();
            this.panelDockContainer1.SuspendLayout();
            this.SuspendLayout();
            // 
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.F1);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlC);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlA);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlV);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlX);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlZ);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlY);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Del);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Ins);
            this.dotNetBarManager1.BottomDockSite = this.dockSite4;
            this.dotNetBarManager1.EnableFullSizeDock = false;
            this.dotNetBarManager1.LeftDockSite = this.dockSite1;
            this.dotNetBarManager1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.dotNetBarManager1.ParentForm = this;
            this.dotNetBarManager1.RightDockSite = this.dockSite2;
            this.dotNetBarManager1.Style = DevComponents.DotNetBar.eDotNetBarStyle.Office2003;
            this.dotNetBarManager1.ToolbarBottomDockSite = this.dockSite8;
            this.dotNetBarManager1.ToolbarLeftDockSite = this.dockSite5;
            this.dotNetBarManager1.ToolbarRightDockSite = this.dockSite6;
            this.dotNetBarManager1.ToolbarTopDockSite = this.dockSite7;
            this.dotNetBarManager1.TopDockSite = this.dockSite3;
            // 
            this.dockSite1.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite1.Controls.Add(this.bar1);
            this.dockSite1.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite1.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer(new DevComponents.DotNetBar.DocumentBaseContainer[] {
            ((DevComponents.DotNetBar.DocumentBaseContainer)(new DevComponents.DotNetBar.DocumentBarContainer(this.bar1, 187, 520)))}, DevComponents.DotNetBar.eOrientation.Horizontal);
            this.dockSite1.Location = new System.Drawing.Point(0, 0);
            this.dockSite1.Name = "dockSite1";
            this.dockSite1.Size = new System.Drawing.Size(190, 520);
            this.dockSite1.TabIndex = 0;
            this.dockSite1.TabStop = false;
            // 
            this.dockSite2.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite2.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite2.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite2.Location = new System.Drawing.Point(1083, 0);
            this.dockSite2.Name = "dockSite2";
            this.dockSite2.Size = new System.Drawing.Size(0, 520);
            this.dockSite2.TabIndex = 1;
            this.dockSite2.TabStop = false;
            // 
            this.dockSite3.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite3.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite3.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite3.Location = new System.Drawing.Point(0, 0);
            this.dockSite3.Name = "dockSite3";
            this.dockSite3.Size = new System.Drawing.Size(1083, 0);
            this.dockSite3.TabIndex = 2;
            this.dockSite3.TabStop = false;
            // 
            this.dockSite4.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite4.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite4.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite4.Location = new System.Drawing.Point(0, 520);
            this.dockSite4.Name = "dockSite4";
            this.dockSite4.Size = new System.Drawing.Size(1083, 0);
            this.dockSite4.TabIndex = 3;
            this.dockSite4.TabStop = false;
            // 
            this.dockSite5.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite5.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite5.Location = new System.Drawing.Point(0, 0);
            this.dockSite5.Name = "dockSite5";
            this.dockSite5.Size = new System.Drawing.Size(0, 520);
            this.dockSite5.TabIndex = 4;
            this.dockSite5.TabStop = false;
            // 
            this.dockSite6.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite6.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite6.Location = new System.Drawing.Point(1083, 0);
            this.dockSite6.Name = "dockSite6";
            this.dockSite6.Size = new System.Drawing.Size(0, 520);
            this.dockSite6.TabIndex = 5;
            this.dockSite6.TabStop = false;
            // 
            this.dockSite7.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite7.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite7.Location = new System.Drawing.Point(0, 0);
            this.dockSite7.Name = "dockSite7";
            this.dockSite7.Size = new System.Drawing.Size(1083, 0);
            this.dockSite7.TabIndex = 6;
            this.dockSite7.TabStop = false;
            // 
            this.dockSite8.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite8.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite8.Location = new System.Drawing.Point(0, 520);
            this.dockSite8.Name = "dockSite8";
            this.dockSite8.Size = new System.Drawing.Size(1083, 0);
            this.dockSite8.TabIndex = 7;
            this.dockSite8.TabStop = false;
            // 
            this.bar1.AccessibleDescription = "DotNetBar Bar (bar1)";
            this.bar1.AccessibleName = "DotNetBar Bar";
            this.bar1.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
            this.bar1.AutoSyncBarCaption = true;
            this.bar1.CloseSingleTab = true;
            this.bar1.Controls.Add(this.panelDockContainer1);
            this.bar1.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.bar1.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
            this.bar1.IsMaximized = false;
            this.bar1.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.dockContainerItem1});
            this.bar1.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
            this.bar1.Location = new System.Drawing.Point(0, 0);
            this.bar1.Name = "bar1";
            this.bar1.Size = new System.Drawing.Size(187, 520);
            this.bar1.Stretch = true;
            this.bar1.Style = DevComponents.DotNetBar.eDotNetBarStyle.Office2003;
            this.bar1.TabIndex = 0;
            this.bar1.TabStop = false;
            this.bar1.Text = "dockContainerItem1";
            // 
            this.dockContainerItem1.Control = this.panelDockContainer1;
            this.dockContainerItem1.Name = "dockContainerItem1";
            this.dockContainerItem1.Text = "dockContainerItem1";
            // 
            this.panelDockContainer1.Controls.Add(this.checkBoxX1);
            this.panelDockContainer1.DisabledBackColor = System.Drawing.Color.Empty;
            this.panelDockContainer1.Location = new System.Drawing.Point(3, 23);
            this.panelDockContainer1.Name = "panelDockContainer1";
            this.panelDockContainer1.Size = new System.Drawing.Size(181, 494);
            this.panelDockContainer1.Style.Alignment = System.Drawing.StringAlignment.Center;
            this.panelDockContainer1.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.BarBackground;
            this.panelDockContainer1.Style.BorderColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.BarDockedBorder;
            this.panelDockContainer1.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
            this.panelDockContainer1.Style.GradientAngle = 90;
            this.panelDockContainer1.TabIndex = 0;
            // 
            this.checkBoxX1.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.checkBoxX1.Location = new System.Drawing.Point(48, 66);
            this.checkBoxX1.Name = "checkBoxX1";
            this.checkBoxX1.Size = new System.Drawing.Size(100, 23);
            this.checkBoxX1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.checkBoxX1.TabIndex = 0;
            this.checkBoxX1.Text = "checkBoxX1";
            // 
            this.webView.ActivateBrowserOnCreation = false;
// TODO: “”的代码生成失败，原因是出现异常“无效的基元类型: System.IntPtr。请考虑使用 CodeObjectCreateExpression。”。
            this.webView.Location = new System.Drawing.Point(243, 44);
            this.webView.Name = "webView";
            this.webView.Size = new System.Drawing.Size(678, 416);
            this.webView.TabIndex = 8;
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1083, 520);
            this.Controls.Add(this.webView);
            this.Controls.Add(this.dockSite2);
            this.Controls.Add(this.dockSite1);
            this.Controls.Add(this.dockSite3);
            this.Controls.Add(this.dockSite4);
            this.Controls.Add(this.dockSite5);
            this.Controls.Add(this.dockSite6);
            this.Controls.Add(this.dockSite7);
            this.Controls.Add(this.dockSite8);
            this.Margin = new System.Windows.Forms.Padding(2, 2, 2, 2);
            this.Name = "FormTest";
            this.Text = "FormTest";
            this.Load += new System.EventHandler(this.FormTest_Load);
            this.dockSite1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.bar1)).EndInit();
            this.bar1.ResumeLayout(false);
            this.panelDockContainer1.ResumeLayout(false);
            this.ResumeLayout(false);

        }

        #endregion

        private DevComponents.DotNetBar.DotNetBarManager dotNetBarManager1;
        private DevComponents.DotNetBar.DockSite dockSite4;
        private DevComponents.DotNetBar.DockSite dockSite1;
        private DevComponents.DotNetBar.Bar bar1;
        private DevComponents.DotNetBar.PanelDockContainer panelDockContainer1;
        private DevComponents.DotNetBar.Controls.CheckBoxX checkBoxX1;
        private DevComponents.DotNetBar.DockContainerItem dockContainerItem1;
        private DevComponents.DotNetBar.DockSite dockSite2;
        private DevComponents.DotNetBar.DockSite dockSite3;
        private DevComponents.DotNetBar.DockSite dockSite5;
        private DevComponents.DotNetBar.DockSite dockSite6;
        private DevComponents.DotNetBar.DockSite dockSite7;
        private DevComponents.DotNetBar.DockSite dockSite8;
        private CefSharp.WinForms.ChromiumWebBrowser webView;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWeb.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MapCutter.Components;
using CefSharp;
using ICSharpCode.TextEditor.Document;
using System.Net;
using System.IO;
using MapCutter.Forms;
using DevComponents.DotNetBar;
using DevComponents.DotNetBar.Controls;

namespace MapCutter
{
    [ComVisible(true)]
    public partial class FormWeb : Form
    {
        string _page;              // 网页文件路径
        string _url;               // 网页URL
        string _html;              // 网页代码
        string _root;              // 根目录
        TinyWebServer _server = new TinyWebServer();

        //---------------------------------------------
        public FormWeb()
        {
            InitializeComponent();
        }

        /// <summary>初始化。支持网页、URL、HTML代码</summary>
        public FormWeb(string page, string url, string html, string root)
        {
            InitializeComponent();
            webView.WaitForInitialLoadAsync();
            webView.LifeSpanHandler = new WebViewLifeSpanHandler();  // 避免点击链接弹出新窗口
            this._page = page;
            this._url = url;
            this._html = html;
            this._root = root;
        }

        /// <summary>根据构造函数进行初始化</summary>
        private void FormPosition_Load(object sender, EventArgs e)
        {
            tbHtml.Document.HighlightingStrategy = HighlightingStrategyFactory.CreateHighlightingStrategy("XML");  // TODO: HTML JS 样式太丑了，以后再想办法美化
            webView.LoadingStateChanged += Browser_LoadingStateChanged;
            webView.AddressChanged += Browser_AddressChanged;
            webView.FrameLoadEnd += Browser_FrameLoadEnd;

            // 加载网页、URL、代码
            if (_page.IsNotEmpty())
            {
                ShowPage(_page, _root);
            }
            else if (_url.IsNotEmpty())
            {
                this.tbUrl.Text = _url;
                btnLoadUrl_Click(null, null);
            }
            else if (_html.IsNotEmpty())
            {
                this._server.Root = _root;
                this.tbHtml.Text = _html;
                btnLoadHtml_Click(null, null);
            }
        }

        private void FormWeb_FormClosing(object sender, FormClosingEventArgs e)
        {
            this._server.Close();
        }

        //-------------------------------------------------------
        private void Browser_FrameLoadEnd(object sender, FrameLoadEndEventArgs e)
        {
            var url = this.tbUrl.Text;
            if (url.Contains("127.0.0.1") || url.Contains("localhost"))
                return;

            // 非本机网页，进行网页解析
            try
            {
                var task = e.Frame.GetSourceAsync();
                task.ContinueWith(t =>
                {
                    if (!t.IsFaulted)
                        Invoke(() => { this.tbHtml.Text = t.Result; });
                });
            }
            catch {}
        }

        private void Browser_AddressChanged(object sender, AddressChangedEventArgs e)
        {
            Invoke(() =>
            {
                this.tbUrl.Text = e.Address.UrlDecode();  // e.Address 是目录不是文件
            });
        }

        private void Browser_LoadingStateChanged(object sender, LoadingStateChangedEventArgs e)
        {
            Invoke(() =>
            {
                var status  = e.IsLoading ? "Loading" : "Ready";
                this.btnBack.Enabled = e.CanGoBack;
                this.btnForward.Enabled = e.CanGoForward;
            });
        }

        public void Invoke(Action action)
        {
            if (InvokeRequired)
                BeginInvoke(action);
            else
                action.Invoke();
        }

        //-------------------------------------------------------
        private void tbUrl_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
                this.btnLoadUrl_Click(null, null);
        }

        /// <summary>后退</summary>
        private void btnBack_Click(object sender, EventArgs e)
        {
            this.webView.Back();
        }

        /// <summary>前进</summary>
        private void btnForward_Click(object sender, EventArgs e)
        {
            this.webView.Forward();
        }

        /// <summary>刷新页面</summary>
        private void btnRefresh_Click(object sender, EventArgs e)
        {
            this.webView.Reload();
        }

        /// <summary>加载URL</summary>
        private void btnLoadUrl_Click(object sender, EventArgs e)
        {
            var url = this.tbUrl.Text;
            this.webView.LoadUrl(this.tbUrl.Text);
        }

        // <summary>加载网页(开启 Web 服务器浏览)</summary>
        private void btnLoadPage_Click(object sender, EventArgs e)
        {
            OpenFileDialog dlg = new OpenFileDialog();
            if (DialogResult.OK == dlg.ShowDialog())
            {
                var page = dlg.FileName;
                ShowPage(page, "");
            }
        }

        /// <summary>启用服务器展示网页</summary>
        private void ShowPage(string filePath, string root)
        {
            var name = filePath.GetFileName();
            if (root.IsEmpty())
                root = filePath.GetFileFolder();
            else
                name = GetRelativeName(root, filePath, false);
            var ip = IPAddress.Parse("127.0.0.1");
            var port = TinyWebServer.SearchEmptyPort(5000);
            var url = string.Format("http://127.0.0.1:{0}/{1}", port, name);
            _server.DefaultFile = @"/" + name;
            _server.Close();
            _server.Start(root, port, ip);
            webView.LoadUrl(url);
            this.tbHtml.Text = File.ReadAllText(filePath);
            this.tbUrl.Text = url;
        }

        /// <summary>获取相对路径</summary>
        string GetRelativeName(string root, string filePath, bool winOrWeb)
        {
            var n = filePath.IndexOf(root);
            if (n <= 0)
                return filePath;
            else
            {
                var last = filePath.SubText(n);
                if (winOrWeb)
                    return last;
                else
                    return last.Replace(@"\", @"/");
            }
        }

        // <summary>加载网页(开启 Web 服务器浏览)</summary>
        private void btnLoadHtml_Click(object sender, EventArgs e)
        {
            _page = "";
            var url = StartWebServerWithHtml(this.tbHtml.Text, _server.Root);
            webView.LoadUrl(url);
        }

        /// <summary>启用 Web 服务器，并配置将源码映射到某个网页地址</summary>
        public string StartWebServerWithHtml(string html, string root)
        {
            var path = @"/" + Guid.NewGuid().ToString("N");
            var ip = IPAddress.Parse("127.0.0.1");
            var port = TinyWebServer.SearchEmptyPort(5000);
            var url = string.Format("http://{0}:{1}{2}", ip, port, path);
            _server.Close();
            _server.DefaultFile = path;
            _server.AddTextRoute(path, () => html);
            _server.Start(root, port, ip);
            return url;
        }

        // <summary>网站配置</summary>
        private void btnServerConfig_Click(object sender, EventArgs e)
        {
            var dlg = new FormWebServer(_server);
            dlg.Show(this);
        }

        // <summary>网站调试</summary>
        private void btnDebug_Click(object sender, EventArgs e)
        {
            webView.ShowDevTools();
        }

        // <summary>保存文件</summary>
        private void btnSave_Click(object sender, EventArgs e)
        {
            if (this._page.IsEmpty())
            {
                SaveFileDialog dlg = new SaveFileDialog();
                dlg.Filter = "HTML|*.html,*.htm;All Files|*.*;";
                if (DialogResult.OK == dlg.ShowDialog())
                {
                    this._page = dlg.FileName;
                }
            }
            if (_page.IsNotEmpty())
            {
                File.WriteAllText(this._page, this.tbHtml.Text, Encoding.UTF8);
                this.btnRefresh_Click(null, null);
                var msg = "文件已保存到：" + this._page;

                //
                DesktopAlert.Show(msg, Properties.Resources.information, eDesktopAlertColor.Default, eAlertPosition.BottomRight, 2, 0, null);
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWeb.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormWeb
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormWeb));
            this.dotNetBarManager1 = new DevComponents.DotNetBar.DotNetBarManager(this.components);
            this.dockSite4 = new DevComponents.DotNetBar.DockSite();
            this.dockSite1 = new DevComponents.DotNetBar.DockSite();
            this.dockSite2 = new DevComponents.DotNetBar.DockSite();
            this.barSource = new DevComponents.DotNetBar.Bar();
            this.panelDockContainer1 = new DevComponents.DotNetBar.PanelDockContainer();
            this.tbHtml = new ICSharpCode.TextEditor.TextEditorControl();
            this.dockContainerItem1 = new DevComponents.DotNetBar.DockContainerItem();
            this.dockSite8 = new DevComponents.DotNetBar.DockSite();
            this.dockSite5 = new DevComponents.DotNetBar.DockSite();
            this.dockSite6 = new DevComponents.DotNetBar.DockSite();
            this.dockSite7 = new DevComponents.DotNetBar.DockSite();
            this.barTool = new DevComponents.DotNetBar.Bar();
            this.btnBack = new DevComponents.DotNetBar.ButtonItem();
            this.btnForward = new DevComponents.DotNetBar.ButtonItem();
            this.btnRefresh = new DevComponents.DotNetBar.ButtonItem();
            this.tbUrl = new DevComponents.DotNetBar.TextBoxItem();
            this.btnLoadUrl = new DevComponents.DotNetBar.ButtonItem();
            this.btnLoadPage = new DevComponents.DotNetBar.ButtonItem();
            this.btnLoadHtml = new DevComponents.DotNetBar.ButtonItem();
            this.btnSave = new DevComponents.DotNetBar.ButtonItem();
            this.btnServerConfig = new DevComponents.DotNetBar.ButtonItem();
            this.btnDebug = new DevComponents.DotNetBar.ButtonItem();
            this.dockSite3 = new DevComponents.DotNetBar.DockSite();
            this.webView = new CefSharp.WinForms.ChromiumWebBrowser();
            this.dockSite2.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.barSource)).BeginInit();
            this.barSource.SuspendLayout();
            this.panelDockContainer1.SuspendLayout();
            this.dockSite7.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.barTool)).BeginInit();
            this.SuspendLayout();
            // 
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.F1);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlC);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlA);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlV);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlX);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlZ);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlY);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Del);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Ins);
            this.dotNetBarManager1.BottomDockSite = this.dockSite4;
            this.dotNetBarManager1.EnableFullSizeDock = false;
            this.dotNetBarManager1.LeftDockSite = this.dockSite1;
            this.dotNetBarManager1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.dotNetBarManager1.ParentForm = null;
            this.dotNetBarManager1.RightDockSite = this.dockSite2;
            this.dotNetBarManager1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.dotNetBarManager1.ToolbarBottomDockSite = this.dockSite8;
            this.dotNetBarManager1.ToolbarLeftDockSite = this.dockSite5;
            this.dotNetBarManager1.ToolbarRightDockSite = this.dockSite6;
            this.dotNetBarManager1.ToolbarTopDockSite = this.dockSite7;
            this.dotNetBarManager1.TopDockSite = this.dockSite3;
            // 
            this.dockSite4.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite4.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite4.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite4.Location = new System.Drawing.Point(0, 690);
            this.dockSite4.Name = "dockSite4";
            this.dockSite4.Size = new System.Drawing.Size(682, 0);
            this.dockSite4.TabIndex = 29;
            this.dockSite4.TabStop = false;
            // 
            this.dockSite1.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite1.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite1.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite1.Location = new System.Drawing.Point(0, 44);
            this.dockSite1.Name = "dockSite1";
            this.dockSite1.Size = new System.Drawing.Size(0, 646);
            this.dockSite1.TabIndex = 26;
            this.dockSite1.TabStop = false;
            // 
            this.dockSite2.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite2.Controls.Add(this.barSource);
            this.dockSite2.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite2.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer(new DevComponents.DotNetBar.DocumentBaseContainer[] {
            ((DevComponents.DotNetBar.DocumentBaseContainer)(new DevComponents.DotNetBar.DocumentBarContainer(this.barSource, 672, 646)))}, DevComponents.DotNetBar.eOrientation.Horizontal);
            this.dockSite2.Location = new System.Drawing.Point(682, 44);
            this.dockSite2.Name = "dockSite2";
            this.dockSite2.Size = new System.Drawing.Size(675, 646);
            this.dockSite2.TabIndex = 27;
            this.dockSite2.TabStop = false;
            // 
            this.barSource.AccessibleDescription = "DotNetBar Bar (barSource)";
            this.barSource.AccessibleName = "DotNetBar Bar";
            this.barSource.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
            this.barSource.AutoHide = true;
            this.barSource.AutoSyncBarCaption = true;
            this.barSource.CanDockBottom = false;
            this.barSource.CanDockTop = false;
            this.barSource.CloseSingleTab = true;
            this.barSource.Controls.Add(this.panelDockContainer1);
            this.barSource.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.barSource.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
            this.barSource.IsMaximized = false;
            this.barSource.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.dockContainerItem1});
            this.barSource.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
            this.barSource.Location = new System.Drawing.Point(3, 0);
            this.barSource.Name = "barSource";
            this.barSource.Size = new System.Drawing.Size(672, 646);
            this.barSource.Stretch = true;
            this.barSource.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.barSource.TabIndex = 0;
            this.barSource.TabStop = false;
            this.barSource.Text = "源代码";
            // 
            this.panelDockContainer1.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.panelDockContainer1.Controls.Add(this.tbHtml);
            this.panelDockContainer1.DisabledBackColor = System.Drawing.Color.Empty;
            this.panelDockContainer1.Location = new System.Drawing.Point(3, 23);
            this.panelDockContainer1.Name = "panelDockContainer1";
            this.panelDockContainer1.Size = new System.Drawing.Size(666, 620);
            this.panelDockContainer1.Style.Alignment = System.Drawing.StringAlignment.Center;
            this.panelDockContainer1.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.BarBackground;
            this.panelDockContainer1.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
            this.panelDockContainer1.Style.GradientAngle = 90;
            this.panelDockContainer1.TabIndex = 0;
            // 
            this.tbHtml.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tbHtml.IsReadOnly = false;
            this.tbHtml.Location = new System.Drawing.Point(0, 0);
            this.tbHtml.Name = "tbHtml";
            this.tbHtml.Size = new System.Drawing.Size(666, 620);
            this.tbHtml.TabIndex = 1;
            // 
            this.dockContainerItem1.Control = this.panelDockContainer1;
            this.dockContainerItem1.Name = "dockContainerItem1";
            this.dockContainerItem1.Text = "源代码";
            // 
            this.dockSite8.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite8.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite8.Location = new System.Drawing.Point(0, 690);
            this.dockSite8.Name = "dockSite8";
            this.dockSite8.Size = new System.Drawing.Size(1357, 0);
            this.dockSite8.TabIndex = 35;
            this.dockSite8.TabStop = false;
            // 
            this.dockSite5.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite5.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite5.Location = new System.Drawing.Point(0, 44);
            this.dockSite5.Name = "dockSite5";
            this.dockSite5.Size = new System.Drawing.Size(0, 646);
            this.dockSite5.TabIndex = 32;
            this.dockSite5.TabStop = false;
            // 
            this.dockSite6.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite6.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite6.Location = new System.Drawing.Point(1357, 44);
            this.dockSite6.Name = "dockSite6";
            this.dockSite6.Size = new System.Drawing.Size(0, 646);
            this.dockSite6.TabIndex = 33;
            this.dockSite6.TabStop = false;
            // 
            this.dockSite7.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite7.Controls.Add(this.barTool);
            this.dockSite7.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite7.Location = new System.Drawing.Point(0, 0);
            this.dockSite7.Name = "dockSite7";
            this.dockSite7.Size = new System.Drawing.Size(1357, 44);
            this.dockSite7.TabIndex = 34;
            this.dockSite7.TabStop = false;
            // 
            this.barTool.AccessibleDescription = "DotNetBar Bar (barTool)";
            this.barTool.AccessibleName = "DotNetBar Bar";
            this.barTool.AccessibleRole = System.Windows.Forms.AccessibleRole.ToolBar;
            this.barTool.DockSide = DevComponents.DotNetBar.eDockSide.Top;
            this.barTool.Font = new System.Drawing.Font("Microsoft YaHei UI", 9F);
            this.barTool.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Office2003;
            this.barTool.IsMaximized = false;
            this.barTool.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.btnBack,
            this.btnForward,
            this.btnRefresh,
            this.tbUrl,
            this.btnLoadUrl,
            this.btnLoadPage,
            this.btnLoadHtml,
            this.btnSave,
            this.btnServerConfig,
            this.btnDebug});
            this.barTool.Location = new System.Drawing.Point(0, 0);
            this.barTool.Name = "barTool";
            this.barTool.Size = new System.Drawing.Size(1143, 44);
            this.barTool.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.barTool.TabIndex = 0;
            this.barTool.TabStop = false;
            this.barTool.Text = "bar3";
            // 
            this.btnBack.Image = global::MapCutter.Properties.Resources.reverse_green;
            this.btnBack.Name = "btnBack";
            this.btnBack.Text = "btnBack2";
            this.btnBack.Click += new System.EventHandler(this.btnBack_Click);
            // 
            this.btnForward.Image = global::MapCutter.Properties.Resources.forward;
            this.btnForward.Name = "btnForward";
            this.btnForward.Text = "buttonItem2";
            this.btnForward.Click += new System.EventHandler(this.btnForward_Click);
            // 
            this.btnRefresh.Image = global::MapCutter.Properties.Resources.arrow_refresh;
            this.btnRefresh.Name = "btnRefresh";
            this.btnRefresh.Text = "buttonItem3";
            this.btnRefresh.Click += new System.EventHandler(this.btnRefresh_Click);
            // 
            this.tbUrl.Name = "tbUrl";
            this.tbUrl.TextBoxWidth = 700;
            this.tbUrl.WatermarkColor = System.Drawing.SystemColors.GrayText;
            this.tbUrl.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tbUrl_KeyUp);
            // 
            this.btnLoadUrl.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnLoadUrl.Image = global::MapCutter.Properties.Resources.world;
            this.btnLoadUrl.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnLoadUrl.Name = "btnLoadUrl";
            this.btnLoadUrl.Text = "加载URL";
            this.btnLoadUrl.Click += new System.EventHandler(this.btnLoadUrl_Click);
            // 
            this.btnLoadPage.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnLoadPage.Image = global::MapCutter.Properties.Resources.page_world;
            this.btnLoadPage.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnLoadPage.Name = "btnLoadPage";
            this.btnLoadPage.Text = "加载网页";
            this.btnLoadPage.Click += new System.EventHandler(this.btnLoadPage_Click);
            // 
            this.btnLoadHtml.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnLoadHtml.Image = global::MapCutter.Properties.Resources.html;
            this.btnLoadHtml.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnLoadHtml.Name = "btnLoadHtml";
            this.btnLoadHtml.Text = "加载源码";
            this.btnLoadHtml.Click += new System.EventHandler(this.btnLoadHtml_Click);
            // 
            this.btnSave.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnSave.Image = global::MapCutter.Properties.Resources.disk;
            this.btnSave.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnSave.Name = "btnSave";
            this.btnSave.Text = "保存网页";
            this.btnSave.Click += new System.EventHandler(this.btnSave_Click);
            // 
            this.btnServerConfig.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnServerConfig.Image = global::MapCutter.Properties.Resources.cog;
            this.btnServerConfig.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnServerConfig.Name = "btnServerConfig";
            this.btnServerConfig.Text = "网站配置";
            this.btnServerConfig.Click += new System.EventHandler(this.btnServerConfig_Click);
            // 
            this.btnDebug.ButtonStyle = DevComponents.DotNetBar.eButtonStyle.ImageAndText;
            this.btnDebug.Image = global::MapCutter.Properties.Resources.bug;
            this.btnDebug.ImagePosition = DevComponents.DotNetBar.eImagePosition.Top;
            this.btnDebug.Name = "btnDebug";
            this.btnDebug.Text = "调试";
            this.btnDebug.Click += new System.EventHandler(this.btnDebug_Click);
            // 
            this.dockSite3.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite3.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite3.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite3.Location = new System.Drawing.Point(0, 44);
            this.dockSite3.Name = "dockSite3";
            this.dockSite3.Size = new System.Drawing.Size(682, 0);
            this.dockSite3.TabIndex = 28;
            this.dockSite3.TabStop = false;
            // 
            this.webView.ActivateBrowserOnCreation = false;
// TODO: “”的代码生成失败，原因是出现异常“无效的基元类型: System.IntPtr。请考虑使用 CodeObjectCreateExpression。”。
            this.webView.Dock = System.Windows.Forms.DockStyle.Fill;
            this.webView.Location = new System.Drawing.Point(0, 44);
            this.webView.Name = "webView";
            this.webView.Size = new System.Drawing.Size(682, 646);
            this.webView.TabIndex = 31;
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1357, 690);
            this.Controls.Add(this.webView);
            this.Controls.Add(this.dockSite3);
            this.Controls.Add(this.dockSite4);
            this.Controls.Add(this.dockSite1);
            this.Controls.Add(this.dockSite2);
            this.Controls.Add(this.dockSite5);
            this.Controls.Add(this.dockSite6);
            this.Controls.Add(this.dockSite7);
            this.Controls.Add(this.dockSite8);
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormWeb";
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
            this.Text = "MapCutter TinyBrowser";
            this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.FormWeb_FormClosing);
            this.Load += new System.EventHandler(this.FormPosition_Load);
            this.dockSite2.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.barSource)).EndInit();
            this.barSource.ResumeLayout(false);
            this.panelDockContainer1.ResumeLayout(false);
            this.dockSite7.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.barTool)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion
        private DevComponents.DotNetBar.DotNetBarManager dotNetBarManager1;
        private DevComponents.DotNetBar.DockSite dockSite4;
        private DevComponents.DotNetBar.DockSite dockSite1;
        private DevComponents.DotNetBar.DockSite dockSite2;
        private DevComponents.DotNetBar.Bar barSource;
        private DevComponents.DotNetBar.PanelDockContainer panelDockContainer1;
        private ICSharpCode.TextEditor.TextEditorControl tbHtml;
        private DevComponents.DotNetBar.DockContainerItem dockContainerItem1;
        private DevComponents.DotNetBar.DockSite dockSite3;
        private CefSharp.WinForms.ChromiumWebBrowser webView;
        private DevComponents.DotNetBar.DockSite dockSite8;
        private DevComponents.DotNetBar.DockSite dockSite5;
        private DevComponents.DotNetBar.DockSite dockSite6;
        private DevComponents.DotNetBar.DockSite dockSite7;
        private DevComponents.DotNetBar.Bar barTool;
        private DevComponents.DotNetBar.ButtonItem btnBack;
        private DevComponents.DotNetBar.ButtonItem btnForward;
        private DevComponents.DotNetBar.ButtonItem btnRefresh;
        private DevComponents.DotNetBar.TextBoxItem tbUrl;
        private DevComponents.DotNetBar.ButtonItem btnLoadUrl;
        private DevComponents.DotNetBar.ButtonItem btnLoadPage;
        private DevComponents.DotNetBar.ButtonItem btnServerConfig;
        private DevComponents.DotNetBar.ButtonItem btnLoadHtml;
        private DevComponents.DotNetBar.ButtonItem btnSave;
        private DevComponents.DotNetBar.ButtonItem btnDebug;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWebServer.cs
//////////////////////////////////////////////////////
using App.Core;
using MapCutter.Components;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MapCutter.Forms
{
    public partial class FormWebServer : Form
    {
        TinyWebServer _server;

        public FormWebServer()
        {
            InitializeComponent();
        }
        public FormWebServer(TinyWebServer server)
        {
            _server = server;
            InitializeComponent();
            this.tbFolder.Text = server.Root;
            this.tbFile.Text = server.DefaultFile;
            this.tbPort.Value = server.Port;
            this.tbIP.Text = server.IP.ToString();
        }

        private void btnFolder_Click(object sender, EventArgs e)
        {
            FolderBrowserDialog dlg = new FolderBrowserDialog();
            if (DialogResult.OK == dlg.ShowDialog())
            {
                this.tbFolder.Text = dlg.SelectedPath;
                _server.Root = this.tbFolder.Text;
            }
        }

        private void btnFile_Click(object sender, EventArgs e)
        {
            var dlg = new OpenFileDialog();
            if (DialogResult.OK == dlg.ShowDialog())
            {
                this.tbFile.Text = dlg.FileName;
                this.tbFolder.Text = dlg.FileName.GetFileFolder();
                _server.Root = this.tbFolder.Text;
            }
        }

        private void btnOk_Click(object sender, EventArgs e)
        {
            this.DialogResult = DialogResult.OK;
            this.Close();
        }
    }

    /// <summary>
    public class WebServerConfig
    {
        public string RootFolder { get; set; }
        public string DefaultFile { get; set; }
        public int Port { get; set; }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWebServer.Designer.cs
//////////////////////////////////////////////////////

namespace MapCutter.Forms
{
    partial class FormWebServer
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.label1 = new System.Windows.Forms.Label();
            this.tbFolder = new System.Windows.Forms.TextBox();
            this.btnFolder = new System.Windows.Forms.Button();
            this.btnFile = new System.Windows.Forms.Button();
            this.tbFile = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.label3 = new System.Windows.Forms.Label();
            this.tbPort = new System.Windows.Forms.NumericUpDown();
            this.btnOk = new System.Windows.Forms.Button();
            this.tbIP = new System.Windows.Forms.TextBox();
            this.label4 = new System.Windows.Forms.Label();
            ((System.ComponentModel.ISupportInitialize)(this.tbPort)).BeginInit();
            this.SuspendLayout();
            // 
            this.label1.AutoSize = true;
            this.label1.Location = new System.Drawing.Point(25, 16);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(41, 12);
            this.label1.TabIndex = 0;
            this.label1.Text = "根目录";
            // 
            this.tbFolder.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbFolder.Location = new System.Drawing.Point(82, 13);
            this.tbFolder.Name = "tbFolder";
            this.tbFolder.Size = new System.Drawing.Size(475, 21);
            this.tbFolder.TabIndex = 1;
            // 
            this.btnFolder.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnFolder.Location = new System.Drawing.Point(572, 11);
            this.btnFolder.Name = "btnFolder";
            this.btnFolder.Size = new System.Drawing.Size(75, 23);
            this.btnFolder.TabIndex = 2;
            this.btnFolder.Text = "设置";
            this.btnFolder.UseVisualStyleBackColor = true;
            this.btnFolder.Click += new System.EventHandler(this.btnFolder_Click);
            // 
            this.btnFile.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnFile.Enabled = false;
            this.btnFile.Location = new System.Drawing.Point(572, 38);
            this.btnFile.Name = "btnFile";
            this.btnFile.Size = new System.Drawing.Size(75, 23);
            this.btnFile.TabIndex = 5;
            this.btnFile.Text = "设置";
            this.btnFile.UseVisualStyleBackColor = true;
            this.btnFile.Visible = false;
            this.btnFile.Click += new System.EventHandler(this.btnFile_Click);
            // 
            this.tbFile.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbFile.Location = new System.Drawing.Point(82, 40);
            this.tbFile.Name = "tbFile";
            this.tbFile.ReadOnly = true;
            this.tbFile.Size = new System.Drawing.Size(475, 21);
            this.tbFile.TabIndex = 4;
            // 
            this.label2.AutoSize = true;
            this.label2.Location = new System.Drawing.Point(25, 43);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(53, 12);
            this.label2.TabIndex = 3;
            this.label2.Text = "网页文件";
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(25, 96);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(29, 12);
            this.label3.TabIndex = 6;
            this.label3.Text = "端口";
            // 
            this.tbPort.Location = new System.Drawing.Point(82, 94);
            this.tbPort.Maximum = new decimal(new int[] {
            10000,
            0,
            0,
            0});
            this.tbPort.Name = "numericUpDown1";
            this.tbPort.ReadOnly = true;
            this.tbPort.Size = new System.Drawing.Size(120, 21);
            this.tbPort.TabIndex = 7;
            this.tbPort.Value = new decimal(new int[] {
            5000,
            0,
            0,
            0});
            // 
            this.btnOk.Location = new System.Drawing.Point(299, 157);
            this.btnOk.Name = "btnOk";
            this.btnOk.Size = new System.Drawing.Size(75, 23);
            this.btnOk.TabIndex = 8;
            this.btnOk.Text = "确定";
            this.btnOk.UseVisualStyleBackColor = true;
            this.btnOk.Click += new System.EventHandler(this.btnOk_Click);
            // 
            this.tbIP.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbIP.Location = new System.Drawing.Point(82, 67);
            this.tbIP.Name = "tbIP";
            this.tbIP.ReadOnly = true;
            this.tbIP.Size = new System.Drawing.Size(475, 21);
            this.tbIP.TabIndex = 10;
            this.tbIP.Text = "127.0.0.1";
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(25, 70);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(17, 12);
            this.label4.TabIndex = 9;
            this.label4.Text = "IP";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(664, 199);
            this.ControlBox = false;
            this.Controls.Add(this.tbIP);
            this.Controls.Add(this.label4);
            this.Controls.Add(this.btnOk);
            this.Controls.Add(this.tbPort);
            this.Controls.Add(this.label3);
            this.Controls.Add(this.btnFile);
            this.Controls.Add(this.tbFile);
            this.Controls.Add(this.label2);
            this.Controls.Add(this.btnFolder);
            this.Controls.Add(this.tbFolder);
            this.Controls.Add(this.label1);
            this.Name = "FormWebServer";
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.Text = "网站服务器配置";
            ((System.ComponentModel.ISupportInitialize)(this.tbPort)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox tbFolder;
        private System.Windows.Forms.Button btnFolder;
        private System.Windows.Forms.Button btnFile;
        private System.Windows.Forms.TextBox tbFile;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.NumericUpDown tbPort;
        private System.Windows.Forms.Button btnOk;
        private System.Windows.Forms.TextBox tbIP;
        private System.Windows.Forms.Label label4;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWelcome.cs
//////////////////////////////////////////////////////
using MapCutter.Components;
using System;
using System.Windows.Forms;

namespace MapCutter
{
    public partial class FormWelcome : Form
    {
        private int _n = 8;

        public FormWelcome()
        {
            InitializeComponent();
        }

        private void FormWelcome_Load(object sender, EventArgs e)
        {
            this.lblVersion.Text = UICommon.GetVersion(); ;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (_n-- <= 0)
            {
                this.timer1.Enabled = false;
                this.DialogResult = DialogResult.OK;
                this.Close();
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\FormWelcome.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class FormWelcome
    {
        /// <summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormWelcome));
            this.label1 = new System.Windows.Forms.Label();
            this.panel1 = new System.Windows.Forms.Panel();
            this.lblVersion = new System.Windows.Forms.Label();
            this.timer1 = new System.Windows.Forms.Timer(this.components);
            this.panel1.SuspendLayout();
            this.SuspendLayout();
            // 
            this.label1.AutoSize = true;
            this.label1.Font = new System.Drawing.Font("Impact", 36F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.label1.ForeColor = System.Drawing.Color.White;
            this.label1.Location = new System.Drawing.Point(213, 113);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(232, 60);
            this.label1.TabIndex = 0;
            this.label1.Text = "MapCutter";
            // 
            this.panel1.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(67)))), ((int)(((byte)(144)))), ((int)(((byte)(247)))));
            this.panel1.Controls.Add(this.lblVersion);
            this.panel1.Controls.Add(this.label1);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(637, 347);
            this.panel1.TabIndex = 16;
            // 
            this.lblVersion.AutoSize = true;
            this.lblVersion.Font = new System.Drawing.Font("Impact", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblVersion.ForeColor = System.Drawing.Color.White;
            this.lblVersion.Location = new System.Drawing.Point(293, 188);
            this.lblVersion.Name = "lblVersion";
            this.lblVersion.Size = new System.Drawing.Size(59, 20);
            this.lblVersion.TabIndex = 1;
            this.lblVersion.Text = "version";
            // 
            this.timer1.Enabled = true;
            this.timer1.Tick += new System.EventHandler(this.timer1_Tick);
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(637, 347);
            this.ControlBox = false;
            this.Controls.Add(this.panel1);
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None;
            this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
            this.Name = "FormWelcome";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.Text = "About";
            this.Load += new System.EventHandler(this.FormWelcome_Load);
            this.panel1.ResumeLayout(false);
            this.panel1.PerformLayout();
            this.ResumeLayout(false);

        }

        #endregion

        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.Label lblVersion;
        private System.Windows.Forms.Timer timer1;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\StepBasic.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Drawing.Imaging;
using System.Runtime.InteropServices;
using System.Diagnostics;
using System.IO;
using App.Core;
using MapCutter.Components;
using MapCutter.Licenses;
using MapCutter.Forms;
using MapCutter.Components.GIS;

namespace MapCutter
{
    public partial class StepBasic : UserControl, IUIConfig
    {
        public StepBasic()
        {
            InitializeComponent();
            ShowMapTypes();
            this.cmbTileImageType.BindEnum<ImageType>();
            this.cmbTileImageQuality.BindEnum<ImageQuality>();
        }

        //------------------------------------------
        public void ShowMapTypes()
        {
            this.cmbMapType.Items.Clear();
            if (!AppLicense.Current.IsRegist)
                this.cmbMapType.BindEnum<MapType>();
            else
            {
                var allMapTypes = typeof(MapType).GetEnums<MapType>();
                foreach (var type in allMapTypes)
                {
                    var feature = AppLicense.Current.Apply.Features.FirstOrDefault(t => t == type.ToString());
                    if (feature != null)
                        this.cmbMapType.Items.Add(type.GetTitle());
                    else
                        this.cmbMapType.Items.Add(type.GetTitle() + "*");  // 加星号的无法选择
                }
            }
        }

        // 自绘列表项
        private void CmbMapType_DrawItem(object sender, DrawItemEventArgs e)
        {
            var cmb = sender as ComboBox;
            if (e.Index < 0)
                return;
            e.DrawBackground();
            e.DrawFocusRectangle();
            e.Graphics.DrawString(cmb.Items[e.Index].ToString(), e.Font, new SolidBrush(e.ForeColor), e.Bounds.X, e.Bounds.Y + 3);
        }

        // 输出目录变更
        private void btnChooseOutputPath_Click(object sender, EventArgs e)
        {
            if (dlg.ShowDialog() == DialogResult.OK)
                tbSaveFolder.Text = dlg.SelectedPath;
        }

        //------------------------------------------
        IMain _main;
        TileConfig _cfg;

        public void Set(IMain main, TileConfig cfg)
        {
            _main = main;
            _cfg = cfg;
            this.tbImagePath.Text = cfg.ImagePath;
            this.tbSaveFolder.Text = cfg.OutFolder;
            this.tbAPIKey.Text = cfg.MapKey;
            this.tbHtmlName.Text = cfg.OutHtmlName;
            UI.SetEnum<MapType>(cmbMapType, cfg.MapType);
            this.cmbBuildType.SelectedItem = cfg.BuildType ?? "JS";
            this.tbBuildTemplate.Text = cfg.BuildTemplatePath;
            this.chkUseTemplate.Checked = cfg.UserBuildTemplate;

            this.chkDebug.Checked = cfg.Debug;
            this.chkDebug.Enabled = AppLicense.Current.IsRegist;  //
            this.chkClearOutFolder.Checked = cfg.ClearOutFolder;
            this.tbTileNameFormat.Text = cfg.TileNameFormat;
            UI.SetEnum(this.cmbTileImageType, cfg.TileImageType);
            UI.SetEnum(this.cmbTileImageQuality, cfg.TileImageQuality);

            // 放缩级别和默认级别
            this.rangeZoom.Value = new DevComponents.DotNetBar.RangeValue(cfg.Zoom.Min, cfg.Zoom.Max);
            this.sliderZoom.Value = cfg.Zoom.Display;
            this.lblRangeZoom.Text = string.Format("{0}-{1}", this.rangeZoom.Value.Min, this.rangeZoom.Value.Max);
            this.chkHDMode.Checked = cfg.HDMode;
            this.picThrumbnail.ImageLocation = File.Exists(cfg.ThrumbnailPath) ? cfg.ThrumbnailPath : "";

            // 从配置中恢复时，如果基图不存在，尝试生成基图片
            if (_cfg.BaseImage == null && _cfg.ImagePath.IsNotEmpty())
                PreprocessImage();
        }
        public void Get()
        {
            // 获取
            _cfg.MapType = UI.GetEnum<MapType>(this.cmbMapType); 
            _cfg.ImagePath = this.tbImagePath.Text;
            _cfg.OutFolder = tbSaveFolder.Text;
            _cfg.MapKey = tbAPIKey.Text;
            _cfg.OutHtmlName = tbHtmlName.Text;
            _cfg.Debug = chkDebug.Checked;
            _cfg.ClearOutFolder = chkClearOutFolder.Checked;
            _cfg.TileNameFormat = tbTileNameFormat.Text;
            _cfg.TileImageType = UI.GetEnum<ImageType>(this.cmbTileImageType);
            _cfg.TileImageQuality = UI.GetEnum<ImageQuality>(this.cmbTileImageQuality);

            _cfg.BuildType = cmbBuildType.SelectedItem.ToString();
            _cfg.BuildTemplatePath = tbBuildTemplate.Text;
            _cfg.UserBuildTemplate = chkUseTemplate.Checked;

            // 放缩级别和默认级别
            _cfg.Zoom.Min = this.rangeZoom.Value.Min;
            _cfg.Zoom.Max = this.rangeZoom.Value.Max;
            _cfg.Zoom.Display = this.sliderZoom.Value;
            _cfg.HDMode = this.chkHDMode.Checked;
        }

        // 检测
        public CheckResult Check()
        {
            if (this.cmbMapType.SelectedIndex == -1)
            {
                cmbMapType.Focus();
                return new CheckResult(cmbMapType, "地图类别不能为空");
            }
            if (this.tbImagePath.Text.IsEmpty())
            {
                this.tbImagePath.Focus();
                return new CheckResult(tbImagePath, "图片路径不能为空");
            }
            if (this.tbSaveFolder.Text.IsEmpty())
            {
                tbSaveFolder.Focus();
                return new CheckResult(tbSaveFolder, "保存路径不能为空");
            }
            return null;
        }

        //------------------------------------------
        private void cmbMapType_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (this.cmbMapType.SelectedIndex != -1)
            {
                var mapType = UI.GetEnum<MapType>(this.cmbMapType);
                this.cmbBuildType.DataSource = MapCutters.GetCutter(mapType).BuildTypes;
                AdjustOutFolder();
                AdjustKey();
            }
        }

        // <summary>根据输出类型自动调整输出文件名</summary>
        private void cmbBuildType_SelectedIndexChanged(object sender, EventArgs e)
        {
            AdjustOutFile();
        }

        /// <summary>自动修改输出目录</summary>
        private void AdjustOutFolder()
        {
            this.tbSaveFolder.Text = TileConfig.FixOutFolder(this.tbImagePath.Text, UI.GetEnum<MapType>(this.cmbMapType));
        }

        /// <summary>自动填充键</summary>
        private void AdjustKey()
        {
            var mapType = UI.GetEnum<MapType>(this.cmbMapType);
            this.tbAPIKey.Text = AppConfig.GetKey(mapType);
        }

        // <summary>根据输出类型自动调整输出文件名</summary>
        private void AdjustOutFile()
        {
            this.tbHtmlName.Text = TileConfig.FixOutHtmlName(this.tbHtmlName.Text, this.cmbBuildType.SelectedItem.ToString());
        }

        // 点击图片设置图片路径
        private void btnImage_Click(object sender, EventArgs e)
        {
            var dlg = new OpenFileDialog();
            dlg.Filter = "Images|*.png;*.jpg;*.jpeg;*.bmp;*.gif;*.tif;*.tiff;*.webp|SVG files|*.svg|All files|*.*";
            if (dlg.ShowDialog() == DialogResult.OK)
            {
                tbImagePath.Text = dlg.FileName;
                SetImage(dlg.FileName);
            }
        }

        // 设置图片路径并按回车
        private void tbImagePath_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                SetImage(tbImagePath.Text);
            }
        }

        // 设置图片
        private void SetImage(string path)
        {
            _cfg.ImagePath = path;
            if (PreprocessImage())
            {
                picThrumbnail.ImageLocation = _cfg.ThrumbnailPath;
                AdjustOutFolder();
                _main.DocChanged();
            }
        }

        /// <summary>预处理图片</summary>
        private bool PreprocessImage()
        {
            Logger.Info("加载图片：" + _cfg.ImagePath);
            FormLoading.ShowForm("加载中...", UI.GetMainForm("FormMain"));
            try
            {
                var size = ImageHelper.GetSize(_cfg.ImagePath);
                _cfg.ImageSize = size;

                // 已注册用户（以后考虑以提示方式，最终版本会打上水印）
                var license = AppLicense.Current;
                if (license.IsRegist)
                {
                    // 超大图片处理授权
                    if (!size.IsNormalImage() && !license.Apply.Features.Contains(nameof(AppFeature.HugeImage)))
                        throw new Exception("您的 License 中未包括超大图片处理功能（像素大于20480 * 20480）");

                    // SVG 图片授权
                }

                // 创建缩略图供预览
                MapCutterRunner.BuildBaseImage(_cfg);
                MapCutterRunner.BuildThrumbnailImage(_cfg);

                // 尝试获取定位
                var rect = GdalHelper.GetTiffRegion(_cfg.ImagePath);
                if (rect != null) _cfg.Rect = rect;
                _cfg.Gps =  GdalHelper.GetExifGps(_cfg.ImagePath);
                _main.ShowDoc();
            }
            catch (Exception ex)
            {
                MessageBox.Show(this, "图像读取失败: " + ex.Message);
                return false;
            }
            FormLoading.CloseForm();
            Logger.Info("加载图片完毕");
                return true;
        }

        /// <summary>APIKey申请</summary>
        private void lnkKey_Click(object sender, EventArgs e)
        {
            new FormAbout().ShowDialog();
        }

        // <summary>彩蛋：出于开发方便，用默认key填充（ctrl+alt+双击）</summary>
        private void tbAPIKey_DoubleClick(object sender, EventArgs e)
        {
            Debug.WriteLine(Win32.GetAsyncKeyState(Win32.VK_CONTROL));
            if (Win32.GetAsyncKeyState(Win32.VK_CONTROL) < 0 && Win32.GetAsyncKeyState(Win32.VK_ALT) < 0)
            {
                var mapType = UI.GetEnum<MapType>(this.cmbMapType); // (MapType)(this.cmbMapType.SelectedIndex);
                var cutter = MapCutters.GetCutter(mapType);
                this.tbAPIKey.Text = cutter.DefaultKey;
            }
        }

        private void sliderZoom_ValueChanged(object sender, EventArgs e)
        {
            this.sliderZoom.Text = sliderZoom.Value.ToString();
        }

        private void rangeZoom_ValueChanged(object sender, EventArgs e)
        {
            this.lblRangeZoom.Text = string.Format("{0}-{1}", this.rangeZoom.Value.Min, this.rangeZoom.Value.Max);
        }

        // 设置输出模板
        private void btnBuildTemplate_Click(object sender, EventArgs e)
        {
            var dlg = new OpenFileDialog();
            dlg.Filter = "Template file|*.tmpl;*.txt;*.htm;*.html;*.md;*.json;|All files|*.*";
            if (dlg.ShowDialog() == DialogResult.OK)
            {
                tbBuildTemplate.Text = dlg.FileName;
                _cfg.BuildTemplatePath = dlg.FileName;
            }

        }

        // 使用输出模板
        private void chkUseTemplate_CheckedChanged(object sender, EventArgs e)
        {
            this.tbBuildTemplate.Visible = chkUseTemplate.Checked;
            this.btnBuildTemplate.Visible = chkUseTemplate.Checked;
        }

        // 显示配置页面
        private void lblConfig_Click(object sender, EventArgs e)
        {
            new FormConfig().ShowDialog();
            AdjustKey();
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\StepBasic.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class StepBasic
    {
        /// <summary> 
        private System.ComponentModel.IContainer components = null;

        /// <summary> 
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region 组件设计器生成的代码

        /// <summary> 
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(StepBasic));
            this.btnSaveFolder = new System.Windows.Forms.Button();
            this.tbSaveFolder = new System.Windows.Forms.TextBox();
            this.label12 = new System.Windows.Forms.Label();
            this.dlg = new System.Windows.Forms.FolderBrowserDialog();
            this.label22 = new System.Windows.Forms.Label();
            this.tbAPIKey = new System.Windows.Forms.TextBox();
            this.label1 = new System.Windows.Forms.Label();
            this.tbHtmlName = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.label3 = new System.Windows.Forms.Label();
            this.chkDebug = new System.Windows.Forms.CheckBox();
            this.tbImagePath = new System.Windows.Forms.TextBox();
            this.label9 = new System.Windows.Forms.Label();
            this.lnkKey = new System.Windows.Forms.LinkLabel();
            this.picThrumbnail = new System.Windows.Forms.PictureBox();
            this.toolTip = new System.Windows.Forms.ToolTip(this.components);
            this.pictureBox1 = new System.Windows.Forms.PictureBox();
            this.pictureBox2 = new System.Windows.Forms.PictureBox();
            this.pictureBox3 = new System.Windows.Forms.PictureBox();
            this.pictureBox4 = new System.Windows.Forms.PictureBox();
            this.lblConfig = new System.Windows.Forms.LinkLabel();
            this.chkHDMode = new System.Windows.Forms.CheckBox();
            this.chkClearOutFolder = new System.Windows.Forms.CheckBox();
            this.label4 = new System.Windows.Forms.Label();
            this.tbTileNameFormat = new System.Windows.Forms.TextBox();
            this.label6 = new System.Windows.Forms.Label();
            this.label7 = new System.Windows.Forms.Label();
            this.label8 = new System.Windows.Forms.Label();
            this.rangeZoom = new DevComponents.DotNetBar.Controls.RangeSlider();
            this.sliderZoom = new DevComponents.DotNetBar.Controls.Slider();
            this.lblRangeZoom = new System.Windows.Forms.Label();
            this.cmbBuildType = new System.Windows.Forms.ComboBox();
            this.label10 = new System.Windows.Forms.Label();
            this.label11 = new System.Windows.Forms.Label();
            this.label13 = new System.Windows.Forms.Label();
            this.btnBuildTemplate = new System.Windows.Forms.Button();
            this.tbBuildTemplate = new System.Windows.Forms.TextBox();
            this.label14 = new System.Windows.Forms.Label();
            this.chkUseTemplate = new System.Windows.Forms.CheckBox();
            this.groupBox1 = new System.Windows.Forms.GroupBox();
            this.cmbTileImageQuality = new System.Windows.Forms.ComboBox();
            this.label5 = new System.Windows.Forms.Label();
            this.cmbTileImageType = new System.Windows.Forms.ComboBox();
            this.groupBox2 = new System.Windows.Forms.GroupBox();
            this.groupBox3 = new System.Windows.Forms.GroupBox();
            this.cmbMapType = new MapCutter.Controls.ComboBoxPro();
            this.groupBox4 = new System.Windows.Forms.GroupBox();
            ((System.ComponentModel.ISupportInitialize)(this.picThrumbnail)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox4)).BeginInit();
            this.groupBox1.SuspendLayout();
            this.groupBox2.SuspendLayout();
            this.groupBox3.SuspendLayout();
            this.groupBox4.SuspendLayout();
            this.SuspendLayout();
            // 
            this.btnSaveFolder.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnSaveFolder.Location = new System.Drawing.Point(327, 25);
            this.btnSaveFolder.Name = "btnSaveFolder";
            this.btnSaveFolder.Size = new System.Drawing.Size(64, 21);
            this.btnSaveFolder.TabIndex = 1;
            this.btnSaveFolder.Text = "设置";
            this.btnSaveFolder.UseVisualStyleBackColor = true;
            this.btnSaveFolder.Click += new System.EventHandler(this.btnChooseOutputPath_Click);
            // 
            this.tbSaveFolder.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbSaveFolder.Location = new System.Drawing.Point(126, 25);
            this.tbSaveFolder.Name = "tbSaveFolder";
            this.tbSaveFolder.Size = new System.Drawing.Size(193, 21);
            this.tbSaveFolder.TabIndex = 0;
            // 
            this.label12.AutoSize = true;
            this.label12.Location = new System.Drawing.Point(17, 30);
            this.label12.Name = "label12";
            this.label12.Size = new System.Drawing.Size(59, 12);
            this.label12.TabIndex = 1;
            this.label12.Text = "输出目录*";
            // 
            this.label22.AutoSize = true;
            this.label22.Location = new System.Drawing.Point(15, 449);
            this.label22.Name = "label22";
            this.label22.Size = new System.Drawing.Size(59, 12);
            this.label22.TabIndex = 6;
            this.label22.Text = "地图类型*";
            // 
            this.tbAPIKey.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbAPIKey.Location = new System.Drawing.Point(80, 480);
            this.tbAPIKey.Name = "tbAPIKey";
            this.tbAPIKey.Size = new System.Drawing.Size(544, 21);
            this.tbAPIKey.TabIndex = 2;
            this.tbAPIKey.DoubleClick += new System.EventHandler(this.tbAPIKey_DoubleClick);
            // 
            this.label1.AutoSize = true;
            this.label1.Location = new System.Drawing.Point(16, 484);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(53, 12);
            this.label1.TabIndex = 8;
            this.label1.Text = "地图Key*";
            // 
            this.tbHtmlName.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbHtmlName.Location = new System.Drawing.Point(126, 57);
            this.tbHtmlName.Name = "tbHtmlName";
            this.tbHtmlName.Size = new System.Drawing.Size(193, 21);
            this.tbHtmlName.TabIndex = 2;
            // 
            this.label2.AutoSize = true;
            this.label2.Location = new System.Drawing.Point(18, 60);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(59, 12);
            this.label2.TabIndex = 10;
            this.label2.Text = "输出网页*";
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(17, 131);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(77, 12);
            this.label3.TabIndex = 12;
            this.label3.Text = "输出调试信息";
            // 
            this.chkDebug.AutoSize = true;
            this.chkDebug.Location = new System.Drawing.Point(126, 129);
            this.chkDebug.Name = "chkDebug";
            this.chkDebug.Size = new System.Drawing.Size(15, 14);
            this.chkDebug.TabIndex = 4;
            this.chkDebug.UseVisualStyleBackColor = true;
            // 
            this.tbImagePath.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbImagePath.Location = new System.Drawing.Point(80, 408);
            this.tbImagePath.Name = "tbImagePath";
            this.tbImagePath.Size = new System.Drawing.Size(655, 21);
            this.tbImagePath.TabIndex = 0;
            this.tbImagePath.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tbImagePath_KeyUp);
            // 
            this.label9.AutoSize = true;
            this.label9.Location = new System.Drawing.Point(15, 408);
            this.label9.Name = "label9";
            this.label9.Size = new System.Drawing.Size(59, 12);
            this.label9.TabIndex = 14;
            this.label9.Text = "图片路径*";
            // 
            this.lnkKey.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.lnkKey.AutoSize = true;
            this.lnkKey.Location = new System.Drawing.Point(706, 484);
            this.lnkKey.Name = "lnkKey";
            this.lnkKey.Size = new System.Drawing.Size(29, 12);
            this.lnkKey.TabIndex = 3;
            this.lnkKey.TabStop = true;
            this.lnkKey.Text = "申请";
            this.toolTip.SetToolTip(this.lnkKey, "申请自己的APIKey，可以获得独立的配额，避免太多人使用而拒绝服务。");
            this.lnkKey.Click += new System.EventHandler(this.lnkKey_Click);
            // 
            this.picThrumbnail.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
            | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.picThrumbnail.BackColor = System.Drawing.Color.White;
            this.picThrumbnail.Cursor = System.Windows.Forms.Cursors.Hand;
            this.picThrumbnail.Image = global::MapCutter.Properties.Resources.image_upload_2x1;
            this.picThrumbnail.Location = new System.Drawing.Point(18, 22);
            this.picThrumbnail.Name = "picThrumbnail";
            this.picThrumbnail.Size = new System.Drawing.Size(717, 368);
            this.picThrumbnail.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
            this.picThrumbnail.TabIndex = 18;
            this.picThrumbnail.TabStop = false;
            this.picThrumbnail.Click += new System.EventHandler(this.btnImage_Click);
            // 
            this.pictureBox1.Image = global::MapCutter.Properties.Resources.information;
            this.pictureBox1.Location = new System.Drawing.Point(99, 129);
            this.pictureBox1.Name = "pictureBox1";
            this.pictureBox1.Size = new System.Drawing.Size(16, 16);
            this.pictureBox1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox1.TabIndex = 19;
            this.pictureBox1.TabStop = false;
            this.toolTip.SetToolTip(this.pictureBox1, "调试信息含叠加层外框、相关区块、区块编号等信息。\r\n注册后可自由设置是否显示这些信息。");
            // 
            this.pictureBox2.Image = global::MapCutter.Properties.Resources.information;
            this.pictureBox2.Location = new System.Drawing.Point(75, 93);
            this.pictureBox2.Name = "pictureBox2";
            this.pictureBox2.Size = new System.Drawing.Size(16, 16);
            this.pictureBox2.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox2.TabIndex = 41;
            this.pictureBox2.TabStop = false;
            this.toolTip.SetToolTip(this.pictureBox2, resources.GetString("pictureBox2.ToolTip"));
            // 
            this.pictureBox3.Image = global::MapCutter.Properties.Resources.information;
            this.pictureBox3.Location = new System.Drawing.Point(75, 97);
            this.pictureBox3.Name = "pictureBox3";
            this.pictureBox3.Size = new System.Drawing.Size(16, 16);
            this.pictureBox3.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox3.TabIndex = 42;
            this.pictureBox3.TabStop = false;
            this.toolTip.SetToolTip(this.pictureBox3, "选中该方式后，切片尺寸为512*512，地图在手机及高清视网膜屏上查看更为清晰。");
            // 
            this.pictureBox4.Image = global::MapCutter.Properties.Resources.information;
            this.pictureBox4.Location = new System.Drawing.Point(96, 30);
            this.pictureBox4.Name = "pictureBox4";
            this.pictureBox4.Size = new System.Drawing.Size(16, 16);
            this.pictureBox4.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize;
            this.pictureBox4.TabIndex = 44;
            this.pictureBox4.TabStop = false;
            this.toolTip.SetToolTip(this.pictureBox4, "一般网页设置为10-18级，手机设置为10-19级。\r\n一般地图商提供的地图框架只支持到20级（空间分辨率约为 0.27米）。\r\n上限值设置得越高，越占空间，切图" +
        "耗费时间越长。");
            // 
            this.lblConfig.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.lblConfig.AutoSize = true;
            this.lblConfig.Location = new System.Drawing.Point(650, 484);
            this.lblConfig.Name = "lblConfig";
            this.lblConfig.Size = new System.Drawing.Size(29, 12);
            this.lblConfig.TabIndex = 2;
            this.lblConfig.TabStop = true;
            this.lblConfig.Text = "配置";
            this.toolTip.SetToolTip(this.lblConfig, "配置好参数，以后会自动填充");
            this.lblConfig.Click += new System.EventHandler(this.lblConfig_Click);
            // 
            this.chkHDMode.AutoSize = true;
            this.chkHDMode.Location = new System.Drawing.Point(126, 98);
            this.chkHDMode.Name = "chkHDMode";
            this.chkHDMode.Size = new System.Drawing.Size(15, 14);
            this.chkHDMode.TabIndex = 3;
            this.chkHDMode.UseVisualStyleBackColor = true;
            // 
            this.chkClearOutFolder.AutoSize = true;
            this.chkClearOutFolder.Location = new System.Drawing.Point(126, 131);
            this.chkClearOutFolder.Name = "chkClearOutFolder";
            this.chkClearOutFolder.Size = new System.Drawing.Size(15, 14);
            this.chkClearOutFolder.TabIndex = 6;
            this.chkClearOutFolder.UseVisualStyleBackColor = true;
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(17, 131);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(89, 12);
            this.label4.TabIndex = 20;
            this.label4.Text = "预清空输出目录";
            // 
            this.tbTileNameFormat.Location = new System.Drawing.Point(158, 29);
            this.tbTileNameFormat.Name = "tbTileNameFormat";
            this.tbTileNameFormat.Size = new System.Drawing.Size(99, 21);
            this.tbTileNameFormat.TabIndex = 0;
            this.tbTileNameFormat.Text = "{x}_{y}";
            // 
            this.label6.AutoSize = true;
            this.label6.Location = new System.Drawing.Point(15, 30);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(89, 12);
            this.label6.TabIndex = 24;
            this.label6.Text = "切块文件名格式";
            // 
            this.label7.AutoSize = true;
            this.label7.Location = new System.Drawing.Point(16, 30);
            this.label7.Name = "label7";
            this.label7.Size = new System.Drawing.Size(77, 12);
            this.label7.TabIndex = 26;
            this.label7.Text = "地图级别范围";
            // 
            this.label8.AutoSize = true;
            this.label8.Location = new System.Drawing.Point(16, 66);
            this.label8.Name = "label8";
            this.label8.Size = new System.Drawing.Size(77, 12);
            this.label8.TabIndex = 27;
            this.label8.Text = "地图默认级别";
            // 
            this.rangeZoom.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.rangeZoom.FocusCuesEnabled = false;
            this.rangeZoom.Location = new System.Drawing.Point(121, 30);
            this.rangeZoom.Maximum = 25;
            this.rangeZoom.Minimum = 1;
            this.rangeZoom.Name = "rangeZoom";
            this.rangeZoom.RangeTooltipFormat = "{0} -  {1}";
            this.rangeZoom.Size = new System.Drawing.Size(144, 24);
            this.rangeZoom.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.rangeZoom.TabIndex = 0;
            this.rangeZoom.Value = new DevComponents.DotNetBar.RangeValue(10, 18);
            this.rangeZoom.ValueChanged += new System.EventHandler(this.rangeZoom_ValueChanged);
            // 
            this.sliderZoom.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.sliderZoom.DecreaseTooltip = "减少";
            this.sliderZoom.IncreaseTooltip = "增加";
            this.sliderZoom.LabelPosition = DevComponents.DotNetBar.eSliderLabelPosition.Right;
            this.sliderZoom.Location = new System.Drawing.Point(124, 66);
            this.sliderZoom.Maximum = 25;
            this.sliderZoom.Minimum = 4;
            this.sliderZoom.Name = "sliderZoom";
            this.sliderZoom.Size = new System.Drawing.Size(173, 23);
            this.sliderZoom.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.sliderZoom.TabIndex = 1;
            this.sliderZoom.Value = 0;
            this.sliderZoom.ValueChanged += new System.EventHandler(this.sliderZoom_ValueChanged);
            // 
            this.lblRangeZoom.AutoSize = true;
            this.lblRangeZoom.Location = new System.Drawing.Point(283, 34);
            this.lblRangeZoom.Name = "lblRangeZoom";
            this.lblRangeZoom.Size = new System.Drawing.Size(23, 12);
            this.lblRangeZoom.TabIndex = 32;
            this.lblRangeZoom.Text = "a-b";
            // 
            this.cmbBuildType.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbBuildType.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbBuildType.FormattingEnabled = true;
            this.cmbBuildType.ItemHeight = 12;
            this.cmbBuildType.Location = new System.Drawing.Point(485, 446);
            this.cmbBuildType.Name = "cmbBuildType";
            this.cmbBuildType.Size = new System.Drawing.Size(250, 20);
            this.cmbBuildType.TabIndex = 3;
            this.cmbBuildType.SelectedIndexChanged += new System.EventHandler(this.cmbBuildType_SelectedIndexChanged);
            // 
            this.label10.AutoSize = true;
            this.label10.Location = new System.Drawing.Point(398, 449);
            this.label10.Name = "label10";
            this.label10.Size = new System.Drawing.Size(59, 12);
            this.label10.TabIndex = 33;
            this.label10.Text = "地图版本*";
            // 
            this.label11.AutoSize = true;
            this.label11.Location = new System.Drawing.Point(124, 31);
            this.label11.Name = "label11";
            this.label11.Size = new System.Drawing.Size(35, 12);
            this.label11.TabIndex = 0;
            this.label11.Text = "\\{z}\\";
            // 
            this.label13.AutoSize = true;
            this.label13.Location = new System.Drawing.Point(17, 98);
            this.label13.Name = "label13";
            this.label13.Size = new System.Drawing.Size(53, 12);
            this.label13.TabIndex = 37;
            this.label13.Text = "高清模式";
            // 
            this.btnBuildTemplate.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnBuildTemplate.Location = new System.Drawing.Point(327, 93);
            this.btnBuildTemplate.Name = "btnBuildTemplate";
            this.btnBuildTemplate.Size = new System.Drawing.Size(64, 21);
            this.btnBuildTemplate.TabIndex = 5;
            this.btnBuildTemplate.Text = "设置";
            this.btnBuildTemplate.UseVisualStyleBackColor = true;
            this.btnBuildTemplate.Visible = false;
            this.btnBuildTemplate.Click += new System.EventHandler(this.btnBuildTemplate_Click);
            // 
            this.tbBuildTemplate.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbBuildTemplate.Location = new System.Drawing.Point(158, 93);
            this.tbBuildTemplate.Name = "tbBuildTemplate";
            this.tbBuildTemplate.Size = new System.Drawing.Size(161, 21);
            this.tbBuildTemplate.TabIndex = 4;
            this.tbBuildTemplate.Visible = false;
            // 
            this.label14.AutoSize = true;
            this.label14.Location = new System.Drawing.Point(18, 96);
            this.label14.Name = "label14";
            this.label14.Size = new System.Drawing.Size(53, 12);
            this.label14.TabIndex = 9;
            this.label14.Text = "网页模板";
            // 
            this.chkUseTemplate.AutoSize = true;
            this.chkUseTemplate.Location = new System.Drawing.Point(126, 96);
            this.chkUseTemplate.Name = "chkUseTemplate";
            this.chkUseTemplate.Size = new System.Drawing.Size(15, 14);
            this.chkUseTemplate.TabIndex = 3;
            this.chkUseTemplate.UseVisualStyleBackColor = true;
            this.chkUseTemplate.CheckedChanged += new System.EventHandler(this.chkUseTemplate_CheckedChanged);
            // 
            this.groupBox1.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.groupBox1.Controls.Add(this.cmbTileImageQuality);
            this.groupBox1.Controls.Add(this.label3);
            this.groupBox1.Controls.Add(this.chkDebug);
            this.groupBox1.Controls.Add(this.label6);
            this.groupBox1.Controls.Add(this.label5);
            this.groupBox1.Controls.Add(this.pictureBox1);
            this.groupBox1.Controls.Add(this.tbTileNameFormat);
            this.groupBox1.Controls.Add(this.cmbTileImageType);
            this.groupBox1.Controls.Add(this.label11);
            this.groupBox1.Controls.Add(this.label13);
            this.groupBox1.Controls.Add(this.chkHDMode);
            this.groupBox1.Controls.Add(this.pictureBox3);
            this.groupBox1.Location = new System.Drawing.Point(793, 210);
            this.groupBox1.Name = "groupBox1";
            this.groupBox1.Size = new System.Drawing.Size(410, 162);
            this.groupBox1.TabIndex = 43;
            this.groupBox1.TabStop = false;
            this.groupBox1.Text = "切块";
            // 
            this.cmbTileImageQuality.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbTileImageQuality.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbTileImageQuality.FormattingEnabled = true;
            this.cmbTileImageQuality.ItemHeight = 12;
            this.cmbTileImageQuality.Items.AddRange(new object[] {
            ".png",
            ".tif",
            ".jpg"});
            this.cmbTileImageQuality.Location = new System.Drawing.Point(126, 65);
            this.cmbTileImageQuality.Name = "cmbTileImageQuality";
            this.cmbTileImageQuality.Size = new System.Drawing.Size(193, 20);
            this.cmbTileImageQuality.TabIndex = 2;
            // 
            this.label5.AutoSize = true;
            this.label5.Location = new System.Drawing.Point(15, 65);
            this.label5.Name = "label5";
            this.label5.Size = new System.Drawing.Size(77, 12);
            this.label5.TabIndex = 46;
            this.label5.Text = "切块图片质量";
            // 
            this.cmbTileImageType.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbTileImageType.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbTileImageType.FormattingEnabled = true;
            this.cmbTileImageType.ItemHeight = 12;
            this.cmbTileImageType.Items.AddRange(new object[] {
            ".png",
            ".tif",
            ".jpg"});
            this.cmbTileImageType.Location = new System.Drawing.Point(263, 29);
            this.cmbTileImageType.Name = "cmbTileImageType";
            this.cmbTileImageType.Size = new System.Drawing.Size(56, 20);
            this.cmbTileImageType.TabIndex = 1;
            // 
            this.groupBox2.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.groupBox2.Controls.Add(this.label4);
            this.groupBox2.Controls.Add(this.chkUseTemplate);
            this.groupBox2.Controls.Add(this.pictureBox2);
            this.groupBox2.Controls.Add(this.chkClearOutFolder);
            this.groupBox2.Controls.Add(this.btnBuildTemplate);
            this.groupBox2.Controls.Add(this.tbBuildTemplate);
            this.groupBox2.Controls.Add(this.label14);
            this.groupBox2.Controls.Add(this.tbHtmlName);
            this.groupBox2.Controls.Add(this.label2);
            this.groupBox2.Controls.Add(this.label12);
            this.groupBox2.Controls.Add(this.tbSaveFolder);
            this.groupBox2.Controls.Add(this.btnSaveFolder);
            this.groupBox2.Location = new System.Drawing.Point(793, 19);
            this.groupBox2.Name = "groupBox2";
            this.groupBox2.Size = new System.Drawing.Size(410, 171);
            this.groupBox2.TabIndex = 13;
            this.groupBox2.TabStop = false;
            this.groupBox2.Text = "目录与文件";
            // 
            this.groupBox3.Controls.Add(this.lblConfig);
            this.groupBox3.Controls.Add(this.picThrumbnail);
            this.groupBox3.Controls.Add(this.tbImagePath);
            this.groupBox3.Controls.Add(this.label9);
            this.groupBox3.Controls.Add(this.cmbBuildType);
            this.groupBox3.Controls.Add(this.label22);
            this.groupBox3.Controls.Add(this.lnkKey);
            this.groupBox3.Controls.Add(this.tbAPIKey);
            this.groupBox3.Controls.Add(this.label1);
            this.groupBox3.Controls.Add(this.cmbMapType);
            this.groupBox3.Controls.Add(this.label10);
            this.groupBox3.Location = new System.Drawing.Point(14, 19);
            this.groupBox3.Name = "groupBox3";
            this.groupBox3.Size = new System.Drawing.Size(752, 517);
            this.groupBox3.TabIndex = 0;
            this.groupBox3.TabStop = false;
            this.groupBox3.Text = "基础配置";
            // 
            this.cmbMapType.DrawMode = System.Windows.Forms.DrawMode.OwnerDrawFixed;
            this.cmbMapType.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbMapType.FormattingEnabled = true;
            this.cmbMapType.ItemHeight = 12;
            this.cmbMapType.Location = new System.Drawing.Point(80, 446);
            this.cmbMapType.Name = "cmbMapType";
            this.cmbMapType.Size = new System.Drawing.Size(291, 18);
            this.cmbMapType.TabIndex = 1;
            this.cmbMapType.SelectedIndexChanged += new System.EventHandler(this.cmbMapType_SelectedIndexChanged);
            // 
            this.groupBox4.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.groupBox4.Controls.Add(this.label7);
            this.groupBox4.Controls.Add(this.lblRangeZoom);
            this.groupBox4.Controls.Add(this.pictureBox4);
            this.groupBox4.Controls.Add(this.sliderZoom);
            this.groupBox4.Controls.Add(this.rangeZoom);
            this.groupBox4.Controls.Add(this.label8);
            this.groupBox4.Location = new System.Drawing.Point(793, 394);
            this.groupBox4.Name = "groupBox4";
            this.groupBox4.Size = new System.Drawing.Size(410, 142);
            this.groupBox4.TabIndex = 46;
            this.groupBox4.TabStop = false;
            this.groupBox4.Text = "地图";
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.Controls.Add(this.groupBox4);
            this.Controls.Add(this.groupBox3);
            this.Controls.Add(this.groupBox2);
            this.Controls.Add(this.groupBox1);
            this.Name = "StepBasic";
            this.Size = new System.Drawing.Size(1216, 554);
            ((System.ComponentModel.ISupportInitialize)(this.picThrumbnail)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.pictureBox4)).EndInit();
            this.groupBox1.ResumeLayout(false);
            this.groupBox1.PerformLayout();
            this.groupBox2.ResumeLayout(false);
            this.groupBox2.PerformLayout();
            this.groupBox3.ResumeLayout(false);
            this.groupBox3.PerformLayout();
            this.groupBox4.ResumeLayout(false);
            this.groupBox4.PerformLayout();
            this.ResumeLayout(false);

        }

        #endregion
        private System.Windows.Forms.Button btnSaveFolder;
        private System.Windows.Forms.TextBox tbSaveFolder;
        private System.Windows.Forms.Label label12;
        private System.Windows.Forms.FolderBrowserDialog dlg;
        private MapCutter.Controls.ComboBoxPro cmbMapType;
        private System.Windows.Forms.Label label22;
        private System.Windows.Forms.TextBox tbAPIKey;
        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox tbHtmlName;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.CheckBox chkDebug;
        private System.Windows.Forms.TextBox tbImagePath;
        private System.Windows.Forms.Label label9;
        private System.Windows.Forms.LinkLabel lnkKey;
        private System.Windows.Forms.PictureBox picThrumbnail;
        private System.Windows.Forms.ToolTip toolTip;
        private System.Windows.Forms.PictureBox pictureBox1;
        private System.Windows.Forms.CheckBox chkClearOutFolder;
        private System.Windows.Forms.Label label4;
        private System.Windows.Forms.TextBox tbTileNameFormat;
        private System.Windows.Forms.Label label6;
        private System.Windows.Forms.Label label7;
        private System.Windows.Forms.Label label8;
        private DevComponents.DotNetBar.Controls.RangeSlider rangeZoom;
        private DevComponents.DotNetBar.Controls.Slider sliderZoom;
        private System.Windows.Forms.Label lblRangeZoom;
        private System.Windows.Forms.ComboBox cmbBuildType;
        private System.Windows.Forms.Label label10;
        private System.Windows.Forms.Label label11;
        private System.Windows.Forms.CheckBox chkHDMode;
        private System.Windows.Forms.Label label13;
        private System.Windows.Forms.Button btnBuildTemplate;
        private System.Windows.Forms.TextBox tbBuildTemplate;
        private System.Windows.Forms.Label label14;
        private System.Windows.Forms.PictureBox pictureBox2;
        private System.Windows.Forms.PictureBox pictureBox3;
        private System.Windows.Forms.CheckBox chkUseTemplate;
        private System.Windows.Forms.GroupBox groupBox1;
        private System.Windows.Forms.PictureBox pictureBox4;
        private System.Windows.Forms.ComboBox cmbTileImageQuality;
        private System.Windows.Forms.Label label5;
        private System.Windows.Forms.ComboBox cmbTileImageType;
        private System.Windows.Forms.GroupBox groupBox2;
        private System.Windows.Forms.GroupBox groupBox3;
        private System.Windows.Forms.LinkLabel lblConfig;
        private System.Windows.Forms.GroupBox groupBox4;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\StepPreview.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Resources;
using System.Diagnostics;
using System.IO;
using System.Drawing.Imaging;
using System.Runtime.InteropServices;
using App.Core;
using MapCutter.Components;
using MapCutter.Components.GIS;
using CefSharp;
using CefSharp.WinForms;
using System.Net;
using MapCutter.Components.Webs;
using MapCutter.Forms;

namespace MapCutter
{
    [ComVisible(true)]
    public partial class StepPreview : UserControl, IUIConfig
    {
        TinyWebServer _server = new TinyWebServer();

        /// <summary>关闭服务器（关闭窗口时请确保使用）</summary>
        public void CloseWebServer()
        {
            this._server.Close();
        }

        public StepPreview()
        {
            InitializeComponent();
        }

        private void StepPreview_Load(object sender, EventArgs e)
        {
            var html = WebRes.PageLoading;
            this.webView.MenuHandler = new WebViewMenuHandler(); 
            this.webView.FrameLoadEnd += new EventHandler<FrameLoadEndEventArgs>(webView_FrameLoadEnd);
            this.webView.JavascriptMessageReceived += webView_JavascriptMessageReceived;
            this.webView.LoadHtml(html);
        }

        //------------------------------------------
        IMain _main;
        TileConfig _cfg;

        public void Set(IMain main, TileConfig cfg)
        {
            _main = main;
            _cfg = cfg;
            ShowSupportPreviewPages();
            //ShowHtml();
            this.tbPointTL.Text = cfg.Rect.TL.ToString();
            this.tbPointBR.Text = cfg.Rect.BR.ToString();
            ShowTileSize();

            if (cfg.PreviewOpacity < 0.0) cfg.PreviewOpacity = 0.0;
            if (cfg.PreviewOpacity > 1.0) cfg.PreviewOpacity = 1.0;
            this.sldOpacity.Value =  (int)(cfg.PreviewOpacity * 100);
            this.tbAddr.Text = cfg.PreviewAddr;
            this.numAngle.Value = (decimal)cfg.RotateAngle;
        }

        public void Get()
        {
            var tl = PointD.Parse(tbPointTL.Text);
            var br = PointD.Parse(tbPointBR.Text);
            if (tl == null || br == null) return;

            _cfg.Rect = new RectD(tl, br);
            _cfg.PreviewOpacity = this.sldOpacity.Value / 100.0;
            _cfg.PreviewAddr = this.tbAddr.Text.Trim();
            _cfg.RotateAngle = (double)this.numAngle.Value;
        }

        // 检测
        public CheckResult Check()
        {
            if (this.tbPointTL.Text.IsEmpty()) return new CheckResult(tbPointTL, "图片左上角经纬度不能为空");
            if (this.tbPointBR.Text.IsEmpty()) return new CheckResult(tbPointBR, "图片右下角经纬度不能为空");
            return null;
        }

        //--------------------------------------------
        private void btnRefresh_Click(object sender, EventArgs e)
        {
            ShowWeb();
        }

        // <summary>彩蛋：出于开发方便，打开开发工具（ctrl+alt+双击）</summary>
        private void toolBar_DoubleClick(object sender, EventArgs e)
        {
            if (Win32.GetAsyncKeyState(Win32.VK_CONTROL) < 0 && Win32.GetAsyncKeyState(Win32.VK_ALT) < 0)
                webView.ShowDevTools();
            else if (Win32.GetAsyncKeyState(Win32.VK_CONTROL) < 0)
                webView.Reload();
        }

        //--------------------------------------------
        public string StartWebServer(string root, string path, string html)
        {
            var ip = IPAddress.Parse("127.0.0.1");
            var port = TinyWebServer.SearchEmptyPort(5000);
            var url = string.Format("http://{0}:{1}{2}", ip, port, path);
            _server.Close();
            _server.AddTextRoute(path, ()=>html);
            _server.Start(root, port, ip);
            return url;
        }

        /// <summary>隐藏滚动条</summary>
        private void webView_FrameLoadEnd(object sender, FrameLoadEndEventArgs e)
        {
            // 不显示难看的滚动轴
            if (e.Frame.IsMain)
                e.Browser.MainFrame.ExecuteJavaScriptAsync("document.body.style.overflow = 'hidden'");
            // 设置图层的不透明度（其它地方设置无效）
            sldOpacity_ValueChanged(null, null);
        }

        /// <summary>调用宿主方法</summary>
        private void webView_JavascriptMessageReceived(object sender, CefSharp.JavascriptMessageReceivedEventArgs e)
        {
            Action action = () =>
            {
                var cmd = e.Message.ToString();
                if (cmd.IsNotEmpty() && cmd.StartsWith("ShowLngLat"))
                {
                    var p = cmd.SplitString();
                    ShowTileRegion(p[1], p[2], p[3], p[4]);
                    Get();
                    ShowTileSize();
                    _main.DocChanged();
                }
            };
            Invoke(action);
        }

        //--------------------------------------------
        void ShowSupportPreviewPages()
        {
            var cmb = this.cmbPage;
            cmb.Items.Clear();
            var pages = MapCutters.GetCutter(_cfg.MapType).PreviewPages;
            foreach ( var item in pages)
                cmb.Items.Add(item);
            cmb.SelectedIndex = 0;
        }

        private void cmbPage_SelectedIndexChanged(object sender, EventArgs e)
        {
            Get();
            ShowHtml();
        }

        /// <summary>显示网页</summary>
        private void ShowHtml()
        {
            if (_cfg.ImagePath.IsEmpty())
            {
                MessageBox.Show(this, "请先设置图片路径", "MapCutter");
                return;
            }
            var page = (cmbPage.SelectedItem as KeyValue).Value.ToString();
            var html = MapCutters.GetCutter(_cfg.MapType).BuildPreviewHtml(_cfg, page);
            var url = StartWebServer(_cfg.ImagePath.GetFileFolder(), "/preview", html);
            webView.LoadUrl(url);
        }

        //------------------------------------------------
        private void btnSearch_Click(object sender, EventArgs e)
        {
            if (this.tbAddr.Text.IsNotEmpty())
            {
                webView.ExecuteScriptAsync("search", this.tbAddr.Text.Replace("'", ""));
            }
        }

        //------------------------------------------------
        private void sldOpacity_ValueChanged(object sender, EventArgs e)
        {
            Action a = () =>
            {
                var n = this.sldOpacity.Value;
                var d = n / 100.0;
                this.sldOpacity.Text = string.Format("{0:0.00}", d);
                webView.ExecuteScriptAsync("setOpacity", d);
            };
            this.Invoke(a);
        }

        //------------------------------------------------
        private void btnMoveCenter_Click(object sender, EventArgs e)
        {
            this.Cursor = Cursors.WaitCursor;

            // 尝试获取图片的 EXIF GPS 信息，如果有坐标，则移动图层
            var gps = _cfg.Gps;  // GdalHelper.GetExifGps(_cfg.ImagePath);
            if (gps != null)
            {
                webView.ExecuteScriptAsync("moveTo", gps.Lng, gps.Lat);
                this.Cursor = Cursors.Default;
                return;
            }

            // 如果图片是 tif，且有经纬度信息，则设置图层区域
            var rect = GdalHelper.GetTiffRegion(_cfg.ImagePath);
            if (rect != null)
            {
                webView.ExecuteScriptAsync("setRegion", rect.TL.X, rect.TL.Y, rect.BR.X, rect.BR.Y);
                this.Cursor = Cursors.Default;
                return;
            }

            // 啥都没有，提示用户
            this.Cursor = Cursors.Default;
            MessageBox.Show(this, "该图像无坐标信息或坐标异常。本软件支持 Exif GPS 坐标数据，以及 GeoTiff 坐标数据。");
        }

        //------------------------------------------------
        private void btnKeepRate_Click(object sender, EventArgs e)
        {
            Get();
            var size = ImageHelper.GetSize(_cfg.ImagePath);
            var rate = size.Width * 1.0 / size.Height;
            SetRectHeightByRate(_cfg.Rect, rate);
            SetTileRegion();
        }

        /// <summary>根据宽高比设置区域高度</summary>
        public void SetRectHeightByRate(RectD rect, double whRate)
        {
            // 计算宽度公里数、计算高度公里数、计算新的纬度
            var width = Earth.GetDistance(rect.TL.X, rect.TL.Y, rect.TR.X, rect.TR.Y);
            var height = width / whRate;
            var lat = Earth.MoveTop(rect.TL.X, rect.TL.Y, -height);
            rect.BL.Y = lat;
            rect.BR.Y = lat;
        }

        //------------------------------------------------
        private void tbPointTL_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Get();
                ShowTileSize();
                SetTileRegion();
            }
        }

        private void tbPointBR_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Get();
                ShowTileSize();
                SetTileRegion();
            }
        }

        /// <summary>变更图层宽度</summary>
        private void numWidth_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Get();
                var dist = (double)this.numWidth.Value;
                _cfg.Rect.BR.X = Earth.MoveRight(_cfg.Rect.TL.X, _cfg.Rect.TL.Y, dist);
                SetTileRegion();
            }
        }

        /// <summary>变更图层高度</summary>
        private void numHeight_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                Get();
                var dist = (double)this.numHeight.Value;
                _cfg.Rect.BR.Y = Earth.MoveTop(_cfg.Rect.TL.X, _cfg.Rect.TL.Y, -dist);
                SetTileRegion();
            }
        }

        /// <summary>根据配置设置图层区域</summary>
        private void SetTileRegion()
        {
            webView.ExecuteScriptAsync("setRegion",
                _cfg.Rect.TL.X,
                _cfg.Rect.TL.Y,
                _cfg.Rect.BR.X,
                _cfg.Rect.BR.Y
                );
            System.Threading.Thread.Sleep(10);
            webView.ExecuteScriptAsync("centerTo", _cfg.Rect.CT.X, _cfg.Rect.CT.Y);
        }

        //------------------------------------------------
        private void ShowWeb()
        {
            var r = Check();
            if (r != null)
                MessageBox.Show(r.Info);
            else
            {
                Get();
                ShowHtml();
            }
        }

        /// <summary>显示图层区域范围（经纬度+公里）</summary>
        public void ShowTileRegion(string lng1, string lat1, string lng2, string lat2)
        {
            this.tbPointTL.Text = string.Format("{0}, {1}", lng1, lat1);
            this.tbPointBR.Text = string.Format("{0}, {1}", lng2, lat2);
        }

        /// <summary>显示图层区域大小（公里）</summary>
        void ShowTileSize()
        {
            var tl = this._cfg.Rect.TL;
            var tr = this._cfg.Rect.TR;
            var bl = this._cfg.Rect.BL;
            var width = Math.Round(Earth.GetDistance(tl.X, tl.Y, tr.X, tr.Y), 6);
            var height = Math.Round(Earth.GetDistance(tl.X, tl.Y, bl.X, bl.Y), 6);
            this.numWidth.Value = (decimal)width;
            this.numHeight.Value = (decimal)height;
        }

        /// <summary>旋转缩略图</summary>
        private void numAngle_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                FormLoading.ShowForm("处理中...", UI.GetMainForm("FormMain"));
                _cfg.RotateAngle = (double)this.numAngle.Value;
                if (_cfg.BaseImage == null)
                    MapCutterRunner.BuildBaseImage(_cfg);
                MapCutterRunner.BuildThrumbnailImage(_cfg);
                FormLoading.CloseForm();
                ShowWeb();
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Forms\StepPreview.Designer.cs
//////////////////////////////////////////////////////
namespace MapCutter
{
    partial class StepPreview
    {
        /// <summary> 
        private System.ComponentModel.IContainer components = null;

        /// <summary> 
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region 组件设计器生成的代码

        /// <summary> 
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.webView = new CefSharp.WinForms.ChromiumWebBrowser();
            this.sldOpacity = new DevComponents.DotNetBar.Controls.Slider();
            this.label4 = new System.Windows.Forms.Label();
            this.tbAddr = new System.Windows.Forms.TextBox();
            this.label3 = new System.Windows.Forms.Label();
            this.tbPointBR = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.tbPointTL = new System.Windows.Forms.TextBox();
            this.label1 = new System.Windows.Forms.Label();
            this.toolTip1 = new System.Windows.Forms.ToolTip(this.components);
            this.btnMoveCenter = new System.Windows.Forms.Button();
            this.btnKeepRate = new System.Windows.Forms.Button();
            this.numWidth = new System.Windows.Forms.NumericUpDown();
            this.numHeight = new System.Windows.Forms.NumericUpDown();
            this.numAngle = new System.Windows.Forms.NumericUpDown();
            this.dotNetBarManager1 = new DevComponents.DotNetBar.DotNetBarManager(this.components);
            this.dockSite4 = new DevComponents.DotNetBar.DockSite();
            this.dockSite1 = new DevComponents.DotNetBar.DockSite();
            this.bar1 = new DevComponents.DotNetBar.Bar();
            this.panelDockContainer1 = new DevComponents.DotNetBar.PanelDockContainer();
            this.cmbPage = new System.Windows.Forms.ComboBox();
            this.label8 = new System.Windows.Forms.Label();
            this.label7 = new System.Windows.Forms.Label();
            this.label5 = new System.Windows.Forms.Label();
            this.label6 = new System.Windows.Forms.Label();
            this.btnRefresh = new System.Windows.Forms.Button();
            this.btnSearch = new System.Windows.Forms.Button();
            this.dockContainerItem1 = new DevComponents.DotNetBar.DockContainerItem();
            this.dockSite2 = new DevComponents.DotNetBar.DockSite();
            this.dockSite8 = new DevComponents.DotNetBar.DockSite();
            this.dockSite5 = new DevComponents.DotNetBar.DockSite();
            this.dockSite6 = new DevComponents.DotNetBar.DockSite();
            this.dockSite7 = new DevComponents.DotNetBar.DockSite();
            this.dockSite3 = new DevComponents.DotNetBar.DockSite();
            ((System.ComponentModel.ISupportInitialize)(this.numWidth)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.numHeight)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.numAngle)).BeginInit();
            this.dockSite1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.bar1)).BeginInit();
            this.bar1.SuspendLayout();
            this.panelDockContainer1.SuspendLayout();
            this.SuspendLayout();
            // 
            this.webView.ActivateBrowserOnCreation = false;
// TODO: “”的代码生成失败，原因是出现异常“无效的基元类型: System.IntPtr。请考虑使用 CodeObjectCreateExpression。”。
            this.webView.Dock = System.Windows.Forms.DockStyle.Fill;
            this.webView.Location = new System.Drawing.Point(248, 0);
            this.webView.Margin = new System.Windows.Forms.Padding(2);
            this.webView.Name = "webView";
            this.webView.Size = new System.Drawing.Size(640, 575);
            this.webView.TabIndex = 18;
            // 
            this.sldOpacity.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            // 
            this.sldOpacity.BackgroundStyle.CornerType = DevComponents.DotNetBar.eCornerType.Square;
            this.sldOpacity.LabelPosition = DevComponents.DotNetBar.eSliderLabelPosition.Right;
            this.sldOpacity.Location = new System.Drawing.Point(67, 400);
            this.sldOpacity.Name = "sldOpacity";
            this.sldOpacity.RightToLeft = System.Windows.Forms.RightToLeft.No;
            this.sldOpacity.Size = new System.Drawing.Size(158, 23);
            this.sldOpacity.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.sldOpacity.TabIndex = 20;
            this.sldOpacity.Value = 50;
            this.sldOpacity.ValueChanged += new System.EventHandler(this.sldOpacity_ValueChanged);
            // 
            this.label4.AutoSize = true;
            this.label4.Location = new System.Drawing.Point(9, 407);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(53, 12);
            this.label4.TabIndex = 7;
            this.label4.Text = "不透明度";
            // 
            this.tbAddr.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbAddr.Location = new System.Drawing.Point(67, 242);
            this.tbAddr.Multiline = true;
            this.tbAddr.Name = "tbAddr";
            this.tbAddr.Size = new System.Drawing.Size(157, 99);
            this.tbAddr.TabIndex = 5;
            this.tbAddr.Text = "北京故宫";
            this.toolTip1.SetToolTip(this.tbAddr, "请输入完整地址（包括省），该服务依赖地图服务商的搜索服务。");
            // 
            this.label3.AutoSize = true;
            this.label3.Location = new System.Drawing.Point(9, 245);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(29, 12);
            this.label3.TabIndex = 4;
            this.label3.Text = "地址";
            // 
            this.tbPointBR.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbPointBR.Location = new System.Drawing.Point(67, 39);
            this.tbPointBR.Name = "tbPointBR";
            this.tbPointBR.Size = new System.Drawing.Size(157, 21);
            this.tbPointBR.TabIndex = 3;
            this.toolTip1.SetToolTip(this.tbPointBR, "输入右下角经纬度，按回车键刷新");
            this.tbPointBR.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tbPointBR_KeyUp);
            // 
            this.label2.AutoSize = true;
            this.label2.Location = new System.Drawing.Point(9, 45);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(47, 12);
            this.label2.TabIndex = 2;
            this.label2.Text = "右下(C)";
            // 
            this.tbPointTL.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.tbPointTL.Location = new System.Drawing.Point(67, 9);
            this.tbPointTL.Name = "tbPointTL";
            this.tbPointTL.Size = new System.Drawing.Size(157, 21);
            this.tbPointTL.TabIndex = 1;
            this.toolTip1.SetToolTip(this.tbPointTL, "输入左上角经纬度，按回车键刷新");
            this.tbPointTL.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tbPointTL_KeyUp);
            // 
            this.label1.AutoSize = true;
            this.label1.Location = new System.Drawing.Point(9, 18);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(47, 12);
            this.label1.TabIndex = 0;
            this.label1.Text = "左上(A)";
            // 
            this.btnMoveCenter.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.btnMoveCenter.Image = global::MapCutter.Properties.Resources.bullet_go;
            this.btnMoveCenter.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.btnMoveCenter.Location = new System.Drawing.Point(67, 201);
            this.btnMoveCenter.Name = "btnMoveCenter";
            this.btnMoveCenter.Size = new System.Drawing.Size(158, 30);
            this.btnMoveCenter.TabIndex = 23;
            this.btnMoveCenter.Text = "移到图片内置坐标";
            this.toolTip1.SetToolTip(this.btnMoveCenter, "将图片及地图中心移动到图片内置的坐标处，这些图片通常是航拍图片，内置经纬度和海拔高度");
            this.btnMoveCenter.UseVisualStyleBackColor = true;
            this.btnMoveCenter.Click += new System.EventHandler(this.btnMoveCenter_Click);
            // 
            this.btnKeepRate.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.btnKeepRate.Image = global::MapCutter.Properties.Resources.bullet_shape;
            this.btnKeepRate.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.btnKeepRate.Location = new System.Drawing.Point(67, 165);
            this.btnKeepRate.Name = "btnKeepRate";
            this.btnKeepRate.Size = new System.Drawing.Size(158, 30);
            this.btnKeepRate.TabIndex = 21;
            this.btnKeepRate.Text = "保持源图长宽比";
            this.toolTip1.SetToolTip(this.btnKeepRate, "调整图片，与源图长宽比一致");
            this.btnKeepRate.UseVisualStyleBackColor = true;
            this.btnKeepRate.Click += new System.EventHandler(this.btnKeepRate_Click);
            // 
            this.numWidth.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.numWidth.DecimalPlaces = 3;
            this.numWidth.Location = new System.Drawing.Point(67, 72);
            this.numWidth.Maximum = new decimal(new int[] {
            999999999,
            0,
            0,
            0});
            this.numWidth.Minimum = new decimal(new int[] {
            999999999,
            0,
            0,
            -2147483648});
            this.numWidth.Name = "numWidth";
            this.numWidth.Size = new System.Drawing.Size(158, 21);
            this.numWidth.TabIndex = 28;
            this.toolTip1.SetToolTip(this.numWidth, "输入宽度公里数，按回车键刷新");
            this.numWidth.KeyUp += new System.Windows.Forms.KeyEventHandler(this.numWidth_KeyUp);
            // 
            this.numHeight.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.numHeight.DecimalPlaces = 3;
            this.numHeight.Location = new System.Drawing.Point(67, 100);
            this.numHeight.Maximum = new decimal(new int[] {
            999999999,
            0,
            0,
            0});
            this.numHeight.Minimum = new decimal(new int[] {
            999999999,
            0,
            0,
            -2147483648});
            this.numHeight.Name = "numHeight";
            this.numHeight.Size = new System.Drawing.Size(158, 21);
            this.numHeight.TabIndex = 29;
            this.toolTip1.SetToolTip(this.numHeight, "输入高度公里数，按回车键刷新");
            this.numHeight.KeyUp += new System.Windows.Forms.KeyEventHandler(this.numHeight_KeyUp);
            // 
            this.numAngle.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.numAngle.DecimalPlaces = 2;
            this.numAngle.Location = new System.Drawing.Point(67, 439);
            this.numAngle.Maximum = new decimal(new int[] {
            360,
            0,
            0,
            0});
            this.numAngle.Minimum = new decimal(new int[] {
            360,
            0,
            0,
            -2147483648});
            this.numAngle.Name = "numAngle";
            this.numAngle.Size = new System.Drawing.Size(158, 21);
            this.numAngle.TabIndex = 31;
            this.toolTip1.SetToolTip(this.numAngle, "输入宽度公里数，按回车键刷新");
            this.numAngle.KeyUp += new System.Windows.Forms.KeyEventHandler(this.numAngle_KeyUp);
            // 
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.F1);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlC);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlA);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlV);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlX);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlZ);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.CtrlY);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Del);
            this.dotNetBarManager1.AutoDispatchShortcuts.Add(DevComponents.DotNetBar.eShortcut.Ins);
            this.dotNetBarManager1.BottomDockSite = this.dockSite4;
            this.dotNetBarManager1.EnableFullSizeDock = false;
            this.dotNetBarManager1.LeftDockSite = this.dockSite1;
            this.dotNetBarManager1.LicenseKey = "F962CEC7-CD8F-4911-A9E9-CAB39962FC1F";
            this.dotNetBarManager1.ParentForm = null;
            this.dotNetBarManager1.ParentUserControl = this;
            this.dotNetBarManager1.RightDockSite = this.dockSite2;
            this.dotNetBarManager1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.dotNetBarManager1.ToolbarBottomDockSite = this.dockSite8;
            this.dotNetBarManager1.ToolbarLeftDockSite = this.dockSite5;
            this.dotNetBarManager1.ToolbarRightDockSite = this.dockSite6;
            this.dotNetBarManager1.ToolbarTopDockSite = this.dockSite7;
            this.dotNetBarManager1.TopDockSite = this.dockSite3;
            // 
            this.dockSite4.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite4.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite4.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite4.Location = new System.Drawing.Point(0, 575);
            this.dockSite4.Name = "dockSite4";
            this.dockSite4.Size = new System.Drawing.Size(888, 0);
            this.dockSite4.TabIndex = 25;
            this.dockSite4.TabStop = false;
            // 
            this.dockSite1.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite1.Controls.Add(this.bar1);
            this.dockSite1.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite1.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer(new DevComponents.DotNetBar.DocumentBaseContainer[] {
            ((DevComponents.DotNetBar.DocumentBaseContainer)(new DevComponents.DotNetBar.DocumentBarContainer(this.bar1, 245, 575)))}, DevComponents.DotNetBar.eOrientation.Horizontal);
            this.dockSite1.Location = new System.Drawing.Point(0, 0);
            this.dockSite1.Name = "dockSite1";
            this.dockSite1.Size = new System.Drawing.Size(248, 575);
            this.dockSite1.TabIndex = 22;
            this.dockSite1.TabStop = false;
            // 
            this.bar1.AccessibleDescription = "DotNetBar Bar (bar1)";
            this.bar1.AccessibleName = "DotNetBar Bar";
            this.bar1.AccessibleRole = System.Windows.Forms.AccessibleRole.Grouping;
            this.bar1.AutoSyncBarCaption = true;
            this.bar1.CanDockBottom = false;
            this.bar1.CanDockTop = false;
            this.bar1.CloseSingleTab = true;
            this.bar1.Controls.Add(this.panelDockContainer1);
            this.bar1.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.bar1.GrabHandleStyle = DevComponents.DotNetBar.eGrabHandleStyle.Caption;
            this.bar1.IsMaximized = false;
            this.bar1.Items.AddRange(new DevComponents.DotNetBar.BaseItem[] {
            this.dockContainerItem1});
            this.bar1.LayoutType = DevComponents.DotNetBar.eLayoutType.DockContainer;
            this.bar1.Location = new System.Drawing.Point(0, 0);
            this.bar1.Name = "bar1";
            this.bar1.Size = new System.Drawing.Size(245, 575);
            this.bar1.Stretch = true;
            this.bar1.Style = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.bar1.TabIndex = 0;
            this.bar1.TabStop = false;
            this.bar1.Text = "区域设置";
            // 
            this.panelDockContainer1.ColorSchemeStyle = DevComponents.DotNetBar.eDotNetBarStyle.StyleManagerControlled;
            this.panelDockContainer1.Controls.Add(this.cmbPage);
            this.panelDockContainer1.Controls.Add(this.label8);
            this.panelDockContainer1.Controls.Add(this.numAngle);
            this.panelDockContainer1.Controls.Add(this.label7);
            this.panelDockContainer1.Controls.Add(this.numHeight);
            this.panelDockContainer1.Controls.Add(this.numWidth);
            this.panelDockContainer1.Controls.Add(this.label5);
            this.panelDockContainer1.Controls.Add(this.label6);
            this.panelDockContainer1.Controls.Add(this.btnMoveCenter);
            this.panelDockContainer1.Controls.Add(this.btnRefresh);
            this.panelDockContainer1.Controls.Add(this.btnSearch);
            this.panelDockContainer1.Controls.Add(this.btnKeepRate);
            this.panelDockContainer1.Controls.Add(this.label1);
            this.panelDockContainer1.Controls.Add(this.label4);
            this.panelDockContainer1.Controls.Add(this.tbPointTL);
            this.panelDockContainer1.Controls.Add(this.sldOpacity);
            this.panelDockContainer1.Controls.Add(this.label2);
            this.panelDockContainer1.Controls.Add(this.tbPointBR);
            this.panelDockContainer1.Controls.Add(this.tbAddr);
            this.panelDockContainer1.Controls.Add(this.label3);
            this.panelDockContainer1.DisabledBackColor = System.Drawing.Color.Empty;
            this.panelDockContainer1.Location = new System.Drawing.Point(3, 23);
            this.panelDockContainer1.Name = "panelDockContainer1";
            this.panelDockContainer1.Size = new System.Drawing.Size(239, 549);
            this.panelDockContainer1.Style.Alignment = System.Drawing.StringAlignment.Center;
            this.panelDockContainer1.Style.BackColor1.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.BarBackground;
            this.panelDockContainer1.Style.ForeColor.ColorSchemePart = DevComponents.DotNetBar.eColorSchemePart.ItemText;
            this.panelDockContainer1.Style.GradientAngle = 90;
            this.panelDockContainer1.TabIndex = 0;
            this.panelDockContainer1.DoubleClick += new System.EventHandler(this.toolBar_DoubleClick);
            // 
            this.cmbPage.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.cmbPage.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbPage.FormattingEnabled = true;
            this.cmbPage.Location = new System.Drawing.Point(67, 473);
            this.cmbPage.Name = "cmbPage";
            this.cmbPage.Size = new System.Drawing.Size(157, 20);
            this.cmbPage.TabIndex = 33;
            this.cmbPage.SelectedIndexChanged += new System.EventHandler(this.cmbPage_SelectedIndexChanged);
            // 
            this.label8.AutoSize = true;
            this.label8.Location = new System.Drawing.Point(9, 477);
            this.label8.Name = "label8";
            this.label8.Size = new System.Drawing.Size(53, 12);
            this.label8.TabIndex = 32;
            this.label8.Text = "预览网页";
            // 
            this.label7.AutoSize = true;
            this.label7.Location = new System.Drawing.Point(9, 441);
            this.label7.Name = "label7";
            this.label7.Size = new System.Drawing.Size(53, 12);
            this.label7.TabIndex = 30;
            this.label7.Text = "旋转角度";
            // 
            this.label5.AutoSize = true;
            this.label5.Location = new System.Drawing.Point(9, 74);
            this.label5.Name = "label5";
            this.label5.Size = new System.Drawing.Size(53, 12);
            this.label5.TabIndex = 24;
            this.label5.Text = "宽度(km)";
            // 
            this.label6.AutoSize = true;
            this.label6.Location = new System.Drawing.Point(9, 102);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(53, 12);
            this.label6.TabIndex = 26;
            this.label6.Text = "高度(km)";
            // 
            this.btnRefresh.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.btnRefresh.Image = global::MapCutter.Properties.Resources.arrow_rotate_anticlockwise;
            this.btnRefresh.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.btnRefresh.Location = new System.Drawing.Point(67, 129);
            this.btnRefresh.Name = "btnRefresh";
            this.btnRefresh.Size = new System.Drawing.Size(158, 30);
            this.btnRefresh.TabIndex = 22;
            this.btnRefresh.Text = "刷新地图";
            this.btnRefresh.UseVisualStyleBackColor = true;
            this.btnRefresh.Click += new System.EventHandler(this.btnRefresh_Click);
            // 
            this.btnSearch.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
            | System.Windows.Forms.AnchorStyles.Right)));
            this.btnSearch.Image = global::MapCutter.Properties.Resources.magnifier;
            this.btnSearch.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.btnSearch.Location = new System.Drawing.Point(67, 350);
            this.btnSearch.Name = "btnSearch";
            this.btnSearch.Size = new System.Drawing.Size(158, 30);
            this.btnSearch.TabIndex = 6;
            this.btnSearch.Text = "查找";
            this.btnSearch.UseVisualStyleBackColor = true;
            this.btnSearch.Click += new System.EventHandler(this.btnSearch_Click);
            // 
            this.dockContainerItem1.Control = this.panelDockContainer1;
            this.dockContainerItem1.Name = "dockContainerItem1";
            this.dockContainerItem1.Text = "区域设置";
            // 
            this.dockSite2.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite2.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite2.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite2.Location = new System.Drawing.Point(888, 0);
            this.dockSite2.Name = "dockSite2";
            this.dockSite2.Size = new System.Drawing.Size(0, 575);
            this.dockSite2.TabIndex = 23;
            this.dockSite2.TabStop = false;
            // 
            this.dockSite8.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite8.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.dockSite8.Location = new System.Drawing.Point(0, 575);
            this.dockSite8.Name = "dockSite8";
            this.dockSite8.Size = new System.Drawing.Size(888, 0);
            this.dockSite8.TabIndex = 29;
            this.dockSite8.TabStop = false;
            // 
            this.dockSite5.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite5.Dock = System.Windows.Forms.DockStyle.Left;
            this.dockSite5.Location = new System.Drawing.Point(0, 0);
            this.dockSite5.Name = "dockSite5";
            this.dockSite5.Size = new System.Drawing.Size(0, 575);
            this.dockSite5.TabIndex = 26;
            this.dockSite5.TabStop = false;
            // 
            this.dockSite6.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite6.Dock = System.Windows.Forms.DockStyle.Right;
            this.dockSite6.Location = new System.Drawing.Point(888, 0);
            this.dockSite6.Name = "dockSite6";
            this.dockSite6.Size = new System.Drawing.Size(0, 575);
            this.dockSite6.TabIndex = 27;
            this.dockSite6.TabStop = false;
            // 
            this.dockSite7.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite7.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite7.Location = new System.Drawing.Point(0, 0);
            this.dockSite7.Name = "dockSite7";
            this.dockSite7.Size = new System.Drawing.Size(888, 0);
            this.dockSite7.TabIndex = 28;
            this.dockSite7.TabStop = false;
            // 
            this.dockSite3.AccessibleRole = System.Windows.Forms.AccessibleRole.Window;
            this.dockSite3.Dock = System.Windows.Forms.DockStyle.Top;
            this.dockSite3.DocumentDockContainer = new DevComponents.DotNetBar.DocumentDockContainer();
            this.dockSite3.Location = new System.Drawing.Point(0, 0);
            this.dockSite3.Name = "dockSite3";
            this.dockSite3.Size = new System.Drawing.Size(888, 0);
            this.dockSite3.TabIndex = 24;
            this.dockSite3.TabStop = false;
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 12F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.Controls.Add(this.webView);
            this.Controls.Add(this.dockSite2);
            this.Controls.Add(this.dockSite1);
            this.Controls.Add(this.dockSite3);
            this.Controls.Add(this.dockSite4);
            this.Controls.Add(this.dockSite5);
            this.Controls.Add(this.dockSite6);
            this.Controls.Add(this.dockSite7);
            this.Controls.Add(this.dockSite8);
            this.Name = "StepPreview";
            this.Size = new System.Drawing.Size(888, 575);
            this.Load += new System.EventHandler(this.StepPreview_Load);
            ((System.ComponentModel.ISupportInitialize)(this.numWidth)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.numHeight)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.numAngle)).EndInit();
            this.dockSite1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.bar1)).EndInit();
            this.bar1.ResumeLayout(false);
            this.panelDockContainer1.ResumeLayout(false);
            this.panelDockContainer1.PerformLayout();
            this.ResumeLayout(false);

        }

        #endregion
        private CefSharp.WinForms.ChromiumWebBrowser webView;
        private DevComponents.DotNetBar.Controls.Slider sldOpacity;
        private System.Windows.Forms.Button btnRefresh;
        private System.Windows.Forms.Button btnKeepRate;
        private System.Windows.Forms.ToolTip toolTip1;
        private System.Windows.Forms.Label label4;
        private System.Windows.Forms.Button btnSearch;
        private System.Windows.Forms.TextBox tbAddr;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.TextBox tbPointBR;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.TextBox tbPointTL;
        private System.Windows.Forms.Label label1;
        private DevComponents.DotNetBar.DotNetBarManager dotNetBarManager1;
        private DevComponents.DotNetBar.DockSite dockSite4;
        private DevComponents.DotNetBar.DockSite dockSite1;
        private DevComponents.DotNetBar.Bar bar1;
        private DevComponents.DotNetBar.PanelDockContainer panelDockContainer1;
        private DevComponents.DotNetBar.DockContainerItem dockContainerItem1;
        private DevComponents.DotNetBar.DockSite dockSite2;
        private DevComponents.DotNetBar.DockSite dockSite3;
        private DevComponents.DotNetBar.DockSite dockSite5;
        private DevComponents.DotNetBar.DockSite dockSite6;
        private DevComponents.DotNetBar.DockSite dockSite7;
        private DevComponents.DotNetBar.DockSite dockSite8;
        private System.Windows.Forms.Button btnMoveCenter;
        private System.Windows.Forms.Label label5;
        private System.Windows.Forms.Label label6;
        private System.Windows.Forms.NumericUpDown numHeight;
        private System.Windows.Forms.NumericUpDown numWidth;
        private System.Windows.Forms.NumericUpDown numAngle;
        private System.Windows.Forms.Label label7;
        private System.Windows.Forms.ComboBox cmbPage;
        private System.Windows.Forms.Label label8;
        //private CefSharp.WinForms.ChromiumWebBrowser webView;
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Properties\AssemblyInfo.cs
//////////////////////////////////////////////////////
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// 有关程序集的一般信息由以下
[assembly: AssemblyTitle("MapTiler")]
[assembly: AssemblyDescription("Map tile cutter tools")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("MapCutter.com")]
[assembly: AssemblyProduct("MapCutter")]
[assembly: AssemblyCopyright("Copyright ©  2023")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// 将 ComVisible 设置为 false 会使此程序集中的类型
[assembly: ComVisible(false)]

// 如果此项目向 COM 公开，则下列 GUID 用于类型库的 ID
[assembly: Guid("5a9acf7e-0872-48b6-9324-5fa1b80d153b")]

// 程序集的版本信息由下列四个值组成: 
[assembly: AssemblyVersion("3.11.3.*")]
[assembly: AssemblyFileVersion("3.11.3.0")]


//////////////////////////////////////////////////////
// \MapCutter\Properties\Resources.Designer.cs
//////////////////////////////////////////////////////
//------------------------------------------------------------------------------

namespace MapCutter.Properties {
    using System;
    
    
    /// <summary>
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "17.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if (object.ReferenceEquals(resourceMan, null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("MapCutter.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
        
        /// <summary>
        internal static string About {
            get {
                return ResourceManager.GetString("About", resourceCulture);
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap add {
            get {
                object obj = ResourceManager.GetObject("add", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap anchor {
            get {
                object obj = ResourceManager.GetObject("anchor", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap arrow_in_longer {
            get {
                object obj = ResourceManager.GetObject("arrow_in_longer", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap arrow_in_longer1 {
            get {
                object obj = ResourceManager.GetObject("arrow_in_longer1", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap arrow_refresh {
            get {
                object obj = ResourceManager.GetObject("arrow_refresh", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap arrow_rotate_anticlockwise {
            get {
                object obj = ResourceManager.GetObject("arrow_rotate_anticlockwise", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap book_open {
            get {
                object obj = ResourceManager.GetObject("book_open", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap bug {
            get {
                object obj = ResourceManager.GetObject("bug", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap build {
            get {
                object obj = ResourceManager.GetObject("build", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap bullet_feed {
            get {
                object obj = ResourceManager.GetObject("bullet_feed", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap bullet_go {
            get {
                object obj = ResourceManager.GetObject("bullet_go", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap bullet_shape {
            get {
                object obj = ResourceManager.GetObject("bullet_shape", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap cancel {
            get {
                object obj = ResourceManager.GetObject("cancel", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap chart_pie_lightning {
            get {
                object obj = ResourceManager.GetObject("chart_pie_lightning", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap clock {
            get {
                object obj = ResourceManager.GetObject("clock", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap cog {
            get {
                object obj = ResourceManager.GetObject("cog", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap connect {
            get {
                object obj = ResourceManager.GetObject("connect", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap disconnect {
            get {
                object obj = ResourceManager.GetObject("disconnect", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap disk {
            get {
                object obj = ResourceManager.GetObject("disk", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap folder {
            get {
                object obj = ResourceManager.GetObject("folder", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap folder_home {
            get {
                object obj = ResourceManager.GetObject("folder_home", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap forward {
            get {
                object obj = ResourceManager.GetObject("forward", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap help {
            get {
                object obj = ResourceManager.GetObject("help", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap hourglass {
            get {
                object obj = ResourceManager.GetObject("hourglass", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap html {
            get {
                object obj = ResourceManager.GetObject("html", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap image_upload_2x1 {
            get {
                object obj = ResourceManager.GetObject("image-upload@2x1", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap information {
            get {
                object obj = ResourceManager.GetObject("information", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap lightning {
            get {
                object obj = ResourceManager.GetObject("lightning", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap link {
            get {
                object obj = ResourceManager.GetObject("link", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap magnifier {
            get {
                object obj = ResourceManager.GetObject("magnifier", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap map {
            get {
                object obj = ResourceManager.GetObject("map", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap map__3_ {
            get {
                object obj = ResourceManager.GetObject("map (3)", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap map_go {
            get {
                object obj = ResourceManager.GetObject("map_go", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap page_world {
            get {
                object obj = ResourceManager.GetObject("page_world", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap pencil {
            get {
                object obj = ResourceManager.GetObject("pencil", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap reverse_green {
            get {
                object obj = ResourceManager.GetObject("reverse_green", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonCalligraphy2 {
            get {
                object obj = ResourceManager.GetObject("RibbonCalligraphy2", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonCircuit {
            get {
                object obj = ResourceManager.GetObject("RibbonCircuit", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonDoodleDiamonds {
            get {
                object obj = ResourceManager.GetObject("RibbonDoodleDiamonds", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonGeometry {
            get {
                object obj = ResourceManager.GetObject("RibbonGeometry", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonSchoolStuff {
            get {
                object obj = ResourceManager.GetObject("RibbonSchoolStuff", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonSpring {
            get {
                object obj = ResourceManager.GetObject("RibbonSpring", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap RibbonUnderwater {
            get {
                object obj = ResourceManager.GetObject("RibbonUnderwater", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap shield {
            get {
                object obj = ResourceManager.GetObject("shield", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap tag {
            get {
                object obj = ResourceManager.GetObject("tag", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap text_align_justify {
            get {
                object obj = ResourceManager.GetObject("text_align_justify", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap wand {
            get {
                object obj = ResourceManager.GetObject("wand", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap world {
            get {
                object obj = ResourceManager.GetObject("world", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap world_edit {
            get {
                object obj = ResourceManager.GetObject("world_edit", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap world_go {
            get {
                object obj = ResourceManager.GetObject("world_go", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap wrench {
            get {
                object obj = ResourceManager.GetObject("wrench", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
        
        /// <summary>
        internal static System.Drawing.Bitmap zoom {
            get {
                object obj = ResourceManager.GetObject("zoom", resourceCulture);
                return ((System.Drawing.Bitmap)(obj));
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter\Properties\Settings.Designer.cs
//////////////////////////////////////////////////////
//------------------------------------------------------------------------------

namespace MapCutter.Properties {
    
    
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "16.7.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter.Components\AppConfig.cs
//////////////////////////////////////////////////////
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using App.Core;

namespace MapCutter.Components
{
    /// <summary>
    public class AppConfig
    {
        [DisplayName("百度地图 KEY")]
        public string KeyBaidu { get; set; }

        [DisplayName("高德地图 KEY")]
        public string KeyGaode { get; set; }

        [DisplayName("腾讯地图 KEY")]
        public string KeyTencent { get; set; }

        [DisplayName("天地图 KEY")]
        public string KeyTiandi { get; set; }

        [DisplayName("微软地图 KEY")]
        public string KeyBing { get; set; }

        [DisplayName("谷歌地图 KEY")]
        public string KeyGoogle { get; set; }

        [DisplayName("Cesium KEY")]
        public string KeyCesium { get; set; }

        [DisplayName("MapBox KEY")]
        public string KeyMapbox { get; set; }

        //
        static string _fileName = "app.cfg";

        public static AppConfig Instance;

        static AppConfig()
        {
            var cfg = JsonHelper.LoadJsonFile<AppConfig>(_fileName);
            if (cfg == null)
            {
                cfg = new AppConfig();
                cfg.Save();
            }
            Instance = cfg;
        }
        public void Save()
        {
            this.SaveJsonFile(_fileName);
        }

        /// <summary>获取地图 Key 值</summary>
        public static string GetKey(MapType type)
        {
            switch (type)
            {
                case MapType.Baidu:   { return AppConfig.Instance.KeyBaidu;   }
                case MapType.BaiduGL: { return AppConfig.Instance.KeyBaidu;   }
                case MapType.Gaode:   { return AppConfig.Instance.KeyGaode;   }
                case MapType.Tencent: { return AppConfig.Instance.KeyTencent; }
                case MapType.Tiandi:  { return AppConfig.Instance.KeyTiandi;  }
                case MapType.Bing:    { return AppConfig.Instance.KeyBing;    }
                case MapType.Google:  { return AppConfig.Instance.KeyGoogle;  }
                case MapType.MapBox:  { return AppConfig.Instance.KeyMapbox;  }
            }
            return "";
        }
    }
}


//////////////////////////////////////////////////////
// \MapCutter.Components\Enums.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MapCutter.Components
{
    /// <summary>
    public enum ImageType
    {
        [UI(".png")] Png,
        [UI(".tif")] Tif,
        [UI(".jpg")] Jpg,
        [UI(".webp")] WebP
    }

    /// <summary>
    public enum ImageQuality : int
    {
        [UI("高")] High = 100,
        [UI("中")] Medium = 60,
        [UI("低")] Low = 30,
    }

}


//////////////////////////////////////////////////////
// \MapCutter.Components\Extensions.cs
//////////////////////////////////////////////////////
using App.Core;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MapCutter.Components
{
    public static class Extensions
    {

        /// <summary>裁掉尾部的匹配字符串（及后面的字符串）。如"a.asp".TrimEndFrom(".") => "a"</summary>
        public static string TrimEndFrom(this string name, string key, bool keepKey = false)
        {
            if (name.IsEmpty())
                return "";
            var n = name.LastIndexOf(key);
            if (n != -1)
            {
                if (keepKey)
                    return name.Substring(0, n + key.Length);
                else
                    return name.Substring(0, n);
            }
            return name;
        }

    }
}


//////////////////////////////////////////////////////
// \MapCutter.Components\MapCutter.Components.csproj
//////////////////////////////////////////////////////
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{F2AB397E-239A-47B5-AA7C-ED6EB6819E83}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>MapCutter.Components</RootNamespace>
    <AssemblyName>MapCutter.Components</AssemblyName>
    <TargetFrameworkVersion>v4.6.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <Deterministic>true</Deterministic>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.IO.Compression" />
    <Reference Include="System.IO.Compression.FileSystem" />
    <Reference Include="System.Runtime.Caching" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="AppConfig.cs" />
    <Compile Include="Cutters\BaiduCutter.cs" />
    <Compile Include="Cutters\BaiduMercator.cs" />
    <Compile Include="Cutters\BingCutter.cs" />
    <Compile Include="Cutters\GaodeCutter.cs" />
    <Compile Include="Cutters\GoogleCutter.cs" />
    <Compile Include="Cutters\IMapCutter.cs" />
    <Compile Include="Cutters\BaiduGLCuttter.cs" />
    <Compile Include="Cutters\MapboxCutter.cs" />
    <Compile Include="Cutters\MapCutterBase.cs" />
    <Compile Include="Cutters\MapCutters.cs" />
    <Compile Include="Cutters\TencentCutter.cs" />
    <Compile Include="Cutters\TiandiCutter.cs" />
    <Compile Include="Drawing\BaiduAI.cs" />
    <Compile Include="Drawing\EasingAnimation.cs" />
    <Compile Include="Drawing\GDIImageHelper.cs" />
    <Compile Include="Drawing\ImageBlock.cs" />
    <Compile Include="Drawing\ImageHelper.cs" />
    <Compile Include="Drawing\ImageV.cs" />
    <Compile Include="Drawing\TagHelper.cs" />
    <Compile Include="Enums.cs" />
    <Compile Include="Extensions.cs" />
    <Compile Include="GIS\GdalHelper.cs" />
    <Compile Include="GIS\Earth.cs" />
    <Compile Include="GIS\LngLat.cs" />
    <Compile Include="GIS\Topology.cs" />
    <Compile Include="Cutters\MapCutterRunner.cs" />
    <Compile Include="Mergers\MapFolderMerger.cs" />
    <Compile Include="Mergers\MapTileMerger.cs" />
    <Compile Include="Networks\CacheHelper.cs" />
    <Compile Include="Networks\TinyWebServer.cs" />
    <Compile Include="Overlay.cs" />
    <Compile Include="GIS\PointD.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="GIS\RectD.cs" />
    <Compile Include="TileConfig.cs" />
    <Compile Include="Tools\AppFeature.cs" />
    <Compile Include="Tools\EmbedHelper.cs" />
    <Compile Include="Tools\GithubRelease.cs" />
    <Compile Include="Tools\HtmlHelper.cs" />
    <Compile Include="Tools\Logger.cs" />
    <Compile Include="Tools\ZipHelper.cs" />
    <Compile Include="Webs\WebRes.cs" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="App.Corer">
      <Version>2.2.3</Version>
    </PackageReference>
    <PackageReference Include="GDAL">
      <Version>3.6.3</Version>
    </PackageReference>
    <PackageReference Include="NetVips">
      <Version>2.1.0</Version>
    </PackageReference>
    <PackageReference Include="NetVips.Extensions">
      <Version>2.1.0</Version>
    </PackageReference>
    <PackageReference Include="RestSharp">
      <Version>106.15.0</Version>
    </PackageReference>
    <PackageReference Include="SharpZipLib">
      <Version>1.3.3</Version>
    </PackageReference>
    <PackageReference Include="TagLibSharp">
      <Version>2.3.0</Version>
    </PackageReference>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Webs\Leaflet\v171\images\layers-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\v171\images\layers.png" />
    <EmbeddedResource Include="Webs\Leaflet\v171\images\marker-icon-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\v171\images\marker-icon.png" />
    <EmbeddedResource Include="Webs\Leaflet\v171\images\marker-shadow.png" />
    <EmbeddedResource Include="Webs\Leaflet\v171\leaflet.css" />
    <EmbeddedResource Include="Webs\Leaflet\v171\leaflet.js" />
    <EmbeddedResource Include="Webs\Page404.html" />
  </ItemGroup>
  <ItemGroup>
    <Content Include="界面无关类库.txt" />
    <EmbeddedResource Include="Webs\PageLoading.html" />
    <Content Include="Cutters\切图类库.txt" />
    <Content Include="Drawing\绘图相关类库.txt" />
    <Content Include="GIS\地理信息处理.txt" />
    <Content Include="Mergers\切块合并.txt" />
    <Content Include="Networks\网络类库.txt" />
    <Content Include="Tools\辅助类库.txt" />
    <Content Include="Webs\网页资源.txt" />
    <EmbeddedResource Include="Webs\BaiduGL\t-preview.html" />
    <EmbeddedResource Include="Webs\BaiduGL\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\BaiduGL\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\BaiduGL\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\BaiduGL\t-tile-gl.html" />
    <None Include="Webs\BaiduGL\webgl\ground.html" />
    <None Include="Webs\BaiduGL\webgl\location.html" />
    <None Include="Webs\BaiduGL\webgl\poi.html" />
    <None Include="Webs\BaiduGL\webgl\style.html" />
    <None Include="Webs\BaiduGL\webgl\tile.html" />
    <None Include="Webs\BaiduGL\webgl\tile2.html" />
    <None Include="Webs\BaiduGL\webgl\boundary.html" />
    <Content Include="Webs\BaiduGL\webgl\tiles\10\843_387.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\11\1686_775.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\12\3372_1551.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\13\6744_3103.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\14\13489_6207.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\15\26978_12414.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\15\26978_12415.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\15\26979_12414.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\15\26979_12415.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53956_24828.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53956_24829.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53956_24830.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53956_24831.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53957_24828.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53957_24829.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53957_24830.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53957_24831.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53958_24828.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53958_24829.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53958_24830.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\16\53958_24831.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49657.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49658.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49659.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49660.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49661.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107912_49662.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49657.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49658.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49659.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49660.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49661.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107913_49662.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49657.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49658.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49659.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49660.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49661.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107914_49662.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49657.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49658.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49659.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49660.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49661.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107915_49662.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49657.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49658.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49659.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49660.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49661.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\17\107916_49662.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215825_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215826_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215827_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215828_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215829_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215830_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215831_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215832_99325.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99314.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99315.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99316.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99317.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99318.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99319.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99320.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99321.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99322.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99323.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99324.png" />
    <Content Include="Webs\BaiduGL\webgl\tiles\18\215833_99325.png" />
    <None Include="Webs\BaiduGL\webgl\view3d.html" />
    <EmbeddedResource Include="Webs\BaiduGL\webgl\要用服务器方式看.txt" />
    <Content Include="Webs\BaiduGL\webgl\palace.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\10\197_73.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\11\395_147.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\12\790_294.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\13\1581_589.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\14\3163_1178.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\15\6326_2356.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\15\6326_2357.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\15\6327_2356.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\15\6327_2357.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12653_4713.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12653_4714.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12654_4713.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12654_4714.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12655_4713.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\16\12655_4714.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25307_9426.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25307_9427.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25307_9428.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25307_9429.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25308_9426.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25308_9427.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25308_9428.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25308_9429.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25309_9426.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25309_9427.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25309_9428.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25309_9429.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25310_9426.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25310_9427.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25310_9428.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\17\25310_9429.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50614_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50615_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50616_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50617_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50618_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50619_18859.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18853.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18854.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18855.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18856.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18857.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18858.png" />
    <Content Include="Webs\Baidu\v2.0\tiles\18\50620_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\10\197_73.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\11\395_147.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\12\790_294.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\13\1581_589.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\14\3163_1178.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\15\6326_2356.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\15\6326_2357.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\15\6327_2356.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\15\6327_2357.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12653_4713.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12653_4714.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12654_4713.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12654_4714.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12655_4713.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\16\12655_4714.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25307_9426.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25307_9427.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25307_9428.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25307_9429.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25308_9426.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25308_9427.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25308_9428.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25308_9429.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25309_9426.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25309_9427.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25309_9428.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25309_9429.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25310_9426.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25310_9427.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25310_9428.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\17\25310_9429.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50614_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50615_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50616_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50617_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50618_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50619_18859.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18853.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18854.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18855.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18856.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18857.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18858.png" />
    <Content Include="Webs\Baidu\v3.0\tiles\18\50620_18859.png" />
    <Content Include="Webs\clipboard.min.js" />
    <Content Include="Webs\Gaode\rect-maptalk.html" />
    <None Include="Webs\Gaode\v1.4\DistrictSearch.html" />
    <None Include="Webs\Gaode\v1.4\DistrictSearch2.html" />
    <EmbeddedResource Include="Webs\Gaode\t-preview-v2.html" />
    <Content Include="Webs\Gaode\v1.4\tile.html" />
    <Content Include="Webs\Google\jsdemo\base.html" />
    <Content Include="Webs\Google\jsdemo\baseAsync.html" />
    <Content Include="Webs\Google\jsdemo\geo.html" />
    <Content Include="Webs\Google\jsdemo\ground.html" />
    <Content Include="Webs\Google\jsdemo\pos.html" />
    <Content Include="Webs\Google\jsdemo\rect.html" />
    <Content Include="Webs\Google\jsdemo\tile.html" />
    <Content Include="Webs\Leaflet\about.txt" />
    <Content Include="Webs\Leaflet\eg\basic.html" />
    <Content Include="Webs\Leaflet\eg\bingmap\index.html" />
    <Content Include="Webs\Leaflet\eg\bingmap\index.js" />
    <Content Include="Webs\Leaflet\eg\bingmap\leaflet-bing-layer.js" />
    <Content Include="Webs\Leaflet\eg\bingmap\leaflet-bing-layer.min.js" />
    <Content Include="Webs\Leaflet\eg\chinese\google_tile%28ok%29.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-BaiDu.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-GaoDe.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-Geoq.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-Google.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-OSM.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-Tencent.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet-TianDiTu.html" />
    <Content Include="Webs\Leaflet\eg\chinese\leaflet.ChineseTmsProviders.js" />
    <Content Include="Webs\Leaflet\eg\chinese\rect-tiandi.html" />
    <Content Include="Webs\Leaflet\eg\control-logo.html" />
    <Content Include="Webs\Leaflet\eg\dist\ChineseProvider.js" />
    <Content Include="Webs\Leaflet\eg\dist\leaflet-src.esm.js" />
    <Content Include="Webs\Leaflet\eg\dist\leaflet-src.js" />
    <Content Include="Webs\Leaflet\eg\dist\leaflet.ChineseTmsProviders.js" />
    <Content Include="Webs\Leaflet\eg\dist\leaflet.css" />
    <Content Include="Webs\Leaflet\eg\dist\leaflet.js" />
    <Content Include="Webs\Leaflet\eg\event.html" />
    <Content Include="Webs\Leaflet\eg\geo.html" />
    <Content Include="Webs\Leaflet\eg\geo2.html" />
    <Content Include="Webs\Leaflet\eg\geo2.js" />
    <Content Include="Webs\Leaflet\eg\geo3.js" />
    <Content Include="Webs\Leaflet\eg\graphy.html" />
    <Content Include="Webs\Leaflet\eg\image.html" />
    <Content Include="Webs\Leaflet\eg\images\layers-2x.png" />
    <Content Include="Webs\Leaflet\eg\images\layers.png" />
    <Content Include="Webs\Leaflet\eg\images\marker-icon-2x.png" />
    <Content Include="Webs\Leaflet\eg\images\marker-icon.png" />
    <Content Include="Webs\Leaflet\eg\images\marker-shadow.png" />
    <Content Include="Webs\Leaflet\eg\index.html" />
    <Content Include="Webs\Leaflet\eg\layers.html" />
    <Content Include="Webs\Leaflet\eg\src-mapbox.html" />
    <Content Include="Webs\Leaflet\eg\tile.html" />
    <Content Include="Webs\Leaflet\eg\tiles\10\843_387.png" />
    <Content Include="Webs\Leaflet\eg\tiles\11\1686_775.png" />
    <Content Include="Webs\Leaflet\eg\tiles\12\3372_1551.png" />
    <Content Include="Webs\Leaflet\eg\tiles\13\6744_3103.png" />
    <Content Include="Webs\Leaflet\eg\tiles\14\13489_6207.png" />
    <Content Include="Webs\Leaflet\eg\tiles\15\26978_12414.png" />
    <Content Include="Webs\Leaflet\eg\tiles\15\26978_12415.png" />
    <Content Include="Webs\Leaflet\eg\tiles\15\26979_12414.png" />
    <Content Include="Webs\Leaflet\eg\tiles\15\26979_12415.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53956_24828.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53956_24829.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53956_24830.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53956_24831.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53957_24828.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53957_24829.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53957_24830.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53957_24831.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53958_24828.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53958_24829.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53958_24830.png" />
    <Content Include="Webs\Leaflet\eg\tiles\16\53958_24831.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49657.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49658.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49659.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49660.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49661.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107912_49662.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49657.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49658.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49659.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49660.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49661.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107913_49662.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49657.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49658.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49659.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49660.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49661.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107914_49662.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49657.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49658.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49659.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49660.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49661.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107915_49662.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49657.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49658.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49659.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49660.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49661.png" />
    <Content Include="Webs\Leaflet\eg\tiles\17\107916_49662.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215825_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215826_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215827_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215828_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215829_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215830_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215831_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215832_99325.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99314.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99315.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99316.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99317.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99318.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99319.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99320.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99321.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99322.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99323.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99324.png" />
    <Content Include="Webs\Leaflet\eg\tiles\18\215833_99325.png" />
    <Content Include="Webs\Leaflet\eg\wms-control.html" />
    <Content Include="Webs\Leaflet\eg\wms.html" />
    <EmbeddedResource Include="Webs\Leaflet\v160\images\layers-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\v160\images\layers.png" />
    <EmbeddedResource Include="Webs\Leaflet\v160\images\marker-icon-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\v160\images\marker-icon.png" />
    <EmbeddedResource Include="Webs\Leaflet\v160\images\marker-shadow.png" />
    <EmbeddedResource Include="Webs\Leaflet\v160\leaflet.css" />
    <EmbeddedResource Include="Webs\Leaflet\v160\leaflet.js" />
    <Content Include="Webs\Leaflet\v193\leaflet-src.esm.js" />
    <Content Include="Webs\Leaflet\v193\leaflet-src.js" />
    <Content Include="Webs\MapBox\etc\wtms.xml" />
    <Content Include="Webs\MapBox\gl\3d-building-model.html" />
    <Content Include="Webs\MapBox\gl\3d-building.html" />
    <Content Include="Webs\MapBox\gl\3d-earth-rotate.html" />
    <Content Include="Webs\MapBox\gl\3d-earth.html" />
    <Content Include="Webs\MapBox\gl\3d-model.html" />
    <Content Include="Webs\MapBox\gl\3d-terrain-fog.html" />
    <Content Include="Webs\MapBox\gl\3d-terrain-road.html" />
    <Content Include="Webs\MapBox\gl\3d-terrain.html" />
    <Content Include="Webs\MapBox\gl\basic-lang.html" />
    <Content Include="Webs\MapBox\gl\basic-project.html" />
    <Content Include="Webs\MapBox\gl\basic-raster.html" />
    <Content Include="Webs\MapBox\gl\basic-wms.html" />
    <Content Include="Webs\MapBox\gl\basic-zh-Hans.html" />
    <Content Include="Webs\MapBox\gl\basic.html" />
    <Content Include="Webs\MapBox\gl\control-draw-polygon.html" />
    <Content Include="Webs\MapBox\gl\control-flyto.html" />
    <Content Include="Webs\MapBox\gl\control-geocoder.html" />
    <Content Include="Webs\MapBox\gl\control-lang.html" />
    <Content Include="Webs\MapBox\gl\control-style.html" />
    <Content Include="Webs\MapBox\gl\controls.html" />
    <Content Include="Webs\MapBox\gl\layer-geojson2.html" />
    <Content Include="Webs\MapBox\gl\layer-gif-animate.html" />
    <Content Include="Webs\MapBox\gl\layer-gif.html" />
    <Content Include="Webs\MapBox\gl\layer-image-json.html" />
    <Content Include="Webs\MapBox\gl\layer-image-mapboxsource.html" />
    <Content Include="Webs\MapBox\gl\layer-image-opacity.html" />
    <Content Include="Webs\MapBox\gl\layer-image.html" />
    <Content Include="Webs\MapBox\gl\layer-polygen-geojson.html" />
    <Content Include="Webs\MapBox\gl\layer-polygon-popup.html" />
    <Content Include="Webs\MapBox\gl\layer-rect.html" />
    <Content Include="Webs\MapBox\gl\layer-shader.html" />
    <Content Include="Webs\MapBox\gl\layer-vedio.html" />
    <Content Include="Webs\MapBox\gl\layer.html" />
    <Content Include="Webs\MapBox\gl\map-baidu.html" />
    <Content Include="Webs\MapBox\gl\mapbox-gl-rtl-text.js" />
    <Content Include="Webs\MapBox\gl\mapbox-gl.css" />
    <Content Include="Webs\MapBox\gl\mapbox-gl.js" />
    <Content Include="Webs\MapBox\gl\mapboxlang.js" />
    <Content Include="Webs\MapBox\gl\marker-drag.html" />
    <Content Include="Webs\MapBox\gl\marker-fromjson.html" />
    <Content Include="Webs\MapBox\gl\marker-vertical3d.html" />
    <Content Include="Webs\MapBox\gl\marker.html" />
    <Content Include="Webs\MapBox\gl\style-dark-light.html" />
    <Content Include="Webs\MapBox\gl\style-mapboxstudio-3d.html" />
    <Content Include="Webs\MapBox\gl\style-mapboxstudio-decimal.html" />
    <Content Include="Webs\MapBox\gl\style-mapboxstudio-standard.html" />
    <Content Include="Webs\MapBox\gl\style-outdoors.html" />
    <Content Include="Webs\MapBox\gl\style-satelite-global.html" />
    <Content Include="Webs\MapBox\gl\style-satelite.html" />
    <Content Include="Webs\MapBox\gl\style-streets.html" />
    <Content Include="Webs\MapBox\leaflet\basic.html" />
    <Content Include="Webs\MapTalks\eg\animate-fly.html" />
    <Content Include="Webs\MapTalks\eg\animate-line.html" />
    <Content Include="Webs\MapTalks\eg\basic-baidu.html" />
    <Content Include="Webs\MapTalks\eg\basic-tiandi.html" />
    <Content Include="Webs\MapTalks\eg\basic.html" />
    <Content Include="Webs\MapTalks\eg\chart-echarts.html" />
    <Content Include="Webs\MapTalks\eg\chart-highcharts.html" />
    <Content Include="Webs\MapTalks\eg\compare.html" />
    <Content Include="Webs\MapTalks\eg\compare2.html" />
    <Content Include="Webs\MapTalks\eg\event-drag.html" />
    <Content Include="Webs\MapTalks\eg\event.html" />
    <Content Include="Webs\MapTalks\eg\guizhou\guizhou.html" />
    <Content Include="Webs\MapTalks\eg\layer-extend.html" />
    <Content Include="Webs\MapTalks\eg\layer-image.html" />
    <Content Include="Webs\MapTalks\eg\layer-rect.html" />
    <Content Include="Webs\MapTalks\eg\layer-selector.html" />
    <Content Include="Webs\MapTalks\eg\layer-tile.html" />
    <Content Include="Webs\MapTalks\eg\layer-vector.html" />
    <Content Include="Webs\MapTalks\eg\savemap.html" />
    <Content Include="Webs\MapTalks\eg\ui-infowin.html" />
    <Content Include="Webs\MapTalks\eg\ui-label.html" />
    <Content Include="Webs\MapTalks\eg\ui-marker.html" />
    <Content Include="Webs\MapTalks\eg\ui-menu.html" />
    <Content Include="Webs\MapTalks\eg\ui-panel.html" />
    <Content Include="Webs\MapTalks\eg\ui-toolbar.html" />
    <Content Include="Webs\MapTalks\eg\zindex.html" />
    <Content Include="Webs\OpenLayers\readme.txt" />
    <Content Include="Webs\OpenLayers\v4\pos-fail.html" />
    <Content Include="Webs\OpenLayers\v5\gps.js" />
    <Content Include="Webs\OpenLayers\v5\openlayer-gaode-fail.html" />
    <Content Include="Webs\OpenLayers\v5\openlayer-tencent-fail.html" />
    <Content Include="Webs\OpenLayers\v5\openlayer-tiandi-fail.html" />
    <Content Include="Webs\OpenLayers\v5\ref.txt" />
    <Content Include="Webs\OpenLayers\v6\demo-project.html" />
    <Content Include="Webs\OpenLayers\v6\demo-source.html" />
    <Content Include="Webs\OpenLayers\v6\demo.html" />
    <Content Include="Webs\OpenLayers\v6\demo2-fail.html" />
    <Content Include="Webs\OpenLayers\v6\marker.html" />
    <EmbeddedResource Include="Webs\OpenLayers\v6\bd09.js" />
    <Content Include="Webs\OpenLayers\v6\openlayer-baidu2.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-baidu-ok.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-baidu.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-bing-ok.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-bing.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-gaode-3857.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-gaode-4326.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-google-calc.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-google.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-openStreetMap-ok.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-tencent-fail.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-tiandi-layers.html" />
    <Content Include="Webs\OpenLayers\v6\openlayer-tiandi-ok.html" />
    <Content Include="Webs\OpenLayers\v6\tiandituLayers.js" />
    <Content Include="Webs\SupperMap\classic\include-web.js" />
    <Content Include="Webs\SupperMap\classic\tiles\10\197_73.png" />
    <Content Include="Webs\SupperMap\classic\tiles\11\395_147.png" />
    <Content Include="Webs\SupperMap\classic\tiles\12\790_294.png" />
    <Content Include="Webs\SupperMap\classic\tiles\13\1581_589.png" />
    <Content Include="Webs\SupperMap\classic\tiles\14\3163_1178.png" />
    <Content Include="Webs\SupperMap\classic\tiles\15\6326_2356.png" />
    <Content Include="Webs\SupperMap\classic\tiles\15\6326_2357.png" />
    <Content Include="Webs\SupperMap\classic\tiles\15\6327_2356.png" />
    <Content Include="Webs\SupperMap\classic\tiles\15\6327_2357.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12653_4713.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12653_4714.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12654_4713.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12654_4714.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12655_4713.png" />
    <Content Include="Webs\SupperMap\classic\tiles\16\12655_4714.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25307_9426.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25307_9427.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25307_9428.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25307_9429.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25308_9426.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25308_9427.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25308_9428.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25308_9429.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25309_9426.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25309_9427.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25309_9428.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25309_9429.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25310_9426.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25310_9427.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25310_9428.png" />
    <Content Include="Webs\SupperMap\classic\tiles\17\25310_9429.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50614_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50615_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50616_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50617_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50618_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50619_18859.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18853.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18854.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18855.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18856.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18857.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18858.png" />
    <Content Include="Webs\SupperMap\classic\tiles\18\50620_18859.png" />
    <Content Include="Webs\Tencent\ChineseProvider.js" />
    <EmbeddedResource Include="Webs\Tencent\t-preview-gl.html" />
    <Content Include="Webs\Tencent\v2.0\preview.html" />
    <Content Include="Webs\Tencent\v2.0\tmp.html" />
    <EmbeddedResource Include="Webs\Leaflet\v160\leaflet.js.map" />
    <None Include="Webs\Tencent\webgl\ground.html" />
    <Content Include="Webs\Tencent\webgl\preview.html" />
    <Content Include="Webs\Tencent\webgl\district2.html" />
    <Content Include="Webs\Tencent\webgl\district.html" />
    <Content Include="Webs\Tencent\webgl\base.html" />
    <Content Include="Webs\Tencent\webgl\tiles\10\843_387.png" />
    <Content Include="Webs\Tencent\webgl\tiles\11\1686_775.png" />
    <Content Include="Webs\Tencent\webgl\tiles\12\3372_1551.png" />
    <Content Include="Webs\Tencent\webgl\tiles\13\6744_3103.png" />
    <Content Include="Webs\Tencent\webgl\tiles\14\13489_6207.png" />
    <Content Include="Webs\Tencent\webgl\tiles\15\26978_12414.png" />
    <Content Include="Webs\Tencent\webgl\tiles\15\26978_12415.png" />
    <Content Include="Webs\Tencent\webgl\tiles\15\26979_12414.png" />
    <Content Include="Webs\Tencent\webgl\tiles\15\26979_12415.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53956_24828.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53956_24829.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53956_24830.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53956_24831.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53957_24828.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53957_24829.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53957_24830.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53957_24831.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53958_24828.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53958_24829.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53958_24830.png" />
    <Content Include="Webs\Tencent\webgl\tiles\16\53958_24831.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49657.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49658.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49659.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49660.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49661.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107912_49662.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49657.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49658.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49659.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49660.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49661.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107913_49662.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49657.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49658.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49659.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49660.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49661.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107914_49662.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49657.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49658.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49659.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49660.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49661.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107915_49662.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49657.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49658.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49659.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49660.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49661.png" />
    <Content Include="Webs\Tencent\webgl\tiles\17\107916_49662.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215825_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215826_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215827_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215828_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215829_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215830_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215831_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215832_99325.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99314.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99315.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99316.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99317.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99318.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99319.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99320.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99321.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99322.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99323.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99324.png" />
    <Content Include="Webs\Tencent\webgl\tiles\18\215833_99325.png" />
    <Content Include="Webs\Tiandi\v3.0\base.html" />
    <Content Include="Webs\Tiandi\v3.0\geo.html" />
    <Content Include="Webs\Tiandi\v3.0\mix.html" />
    <Content Include="Webs\Tiandi\v3.0\pos.html" />
    <Content Include="Webs\Tiandi\v3.0\rect.html" />
    <Content Include="Webs\Tiandi\v3.0\search.html" />
    <Content Include="Webs\Tiandi\v3.0\tile.html" />
    <Content Include="Webs\Tiandi\v4.0\basic.html" />
    <Content Include="Webs\Tiandi\v4.0\compare.html" />
    <Content Include="Webs\Tiandi\v4.0\pos.html" />
    <Content Include="Webs\Tiandi\v4.0\tile.html" />
    <Content Include="Webs\Tiandi\v4.0\wms.html" />
    <Content Include="Webs\toast.js" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-v4.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-v3.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-maptalks.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-preview.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-preview-tiandi.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-preview-old.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-preview-220624.html" />
    <EmbeddedResource Include="Webs\Tiandi\t-pos.html" />
    <None Include="Webs\Tencent\webgl\tile2.html" />
    <None Include="Webs\Tencent\webgl\tile.html" />
    <None Include="Webs\Tencent\webgl\graphy.html" />
    <None Include="Webs\Tencent\v2.0\zoomlevel.html" />
    <None Include="Webs\Tencent\v2.0\tilemap.html" />
    <None Include="Webs\Tencent\v2.0\tile.html" />
    <None Include="Webs\Tencent\v2.0\rect.html" />
    <None Include="Webs\Tencent\v2.0\pos.html" />
    <None Include="Webs\Tencent\v2.0\polyline.html" />
    <None Include="Webs\Tencent\v2.0\markergif.html" />
    <None Include="Webs\Tencent\v2.0\marker.html" />
    <None Include="Webs\Tencent\v2.0\locator.png" />
    <None Include="Webs\Tencent\v2.0\ground.html" />
    <None Include="Webs\Tencent\v2.0\center.gif" />
    <None Include="Webs\Tencent\v2.0\base.html" />
    <EmbeddedResource Include="Webs\Tencent\t-tile-webgl.html" />
    <EmbeddedResource Include="Webs\Tencent\t-tile-v2.html" />
    <EmbeddedResource Include="Webs\Tencent\t-tile-maptalks.html" />
    <EmbeddedResource Include="Webs\Tencent\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Tencent\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Tencent\t-preview.html" />
    <EmbeddedResource Include="Webs\Tencent\t-pos.html" />
    <EmbeddedResource Include="Webs\SupperMap\t-tile-classic.html" />
    <EmbeddedResource Include="Webs\SupperMap\t-preview.html" />
    <EmbeddedResource Include="Webs\SupperMap\t-pos.html" />
    <None Include="Webs\SupperMap\classic\rect.html" />
    <None Include="Webs\SupperMap\classic\pos.html" />
    <None Include="Webs\SupperMap\classic\marker.html" />
    <None Include="Webs\SupperMap\classic\layers.html" />
    <None Include="Webs\SupperMap\classic\Image.html" />
    <None Include="Webs\SupperMap\classic\basic.html" />
    <EmbeddedResource Include="Webs\SupperMap\basic.html" />
    <EmbeddedResource Include="Webs\Proj4leaflet\v101\proj4leaflet.min.js" />
    <EmbeddedResource Include="Webs\Proj4js\v243\proj4.js" />
    <EmbeddedResource Include="Webs\OpenLayers\v6\ol.js" />
    <EmbeddedResource Include="Webs\OpenLayers\v6\ol.css" />
    <EmbeddedResource Include="Webs\OpenLayers\v6\icon-a.png" />
    <EmbeddedResource Include="Webs\OpenLayers\t-tile.html" />
    <EmbeddedResource Include="Webs\OpenLayers\t-preview.html" />
    <EmbeddedResource Include="Webs\markers.png" />
    <EmbeddedResource Include="Webs\MapTalks\maptalks.min.js" />
    <EmbeddedResource Include="Webs\MapTalks\maptalks.min.css" />
    <EmbeddedResource Include="Webs\MapTalks\eg\icon-a.png" />
    <EmbeddedResource Include="Webs\MapBox\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\MapBox\t-tile-gl.html" />
    <EmbeddedResource Include="Webs\MapBox\t-preview.html" />
    <EmbeddedResource Include="Webs\MapBox\t-preview-raw.html" />
    <EmbeddedResource Include="Webs\MapBox\preview-raw.html" />
    <EmbeddedResource Include="Webs\MapBox\preview-leaflet.html" />
    <EmbeddedResource Include="Webs\MapBox\gl\mapbox-icon.png" />
    <EmbeddedResource Include="Webs\Leaflet\v193\leaflet.js" />
    <EmbeddedResource Include="Webs\Leaflet\v193\leaflet.css" />
    <EmbeddedResource Include="Webs\Leaflet\v193\images\marker-shadow.png" />
    <EmbeddedResource Include="Webs\Leaflet\v193\images\marker-icon.png" />
    <EmbeddedResource Include="Webs\Leaflet\v193\images\marker-icon-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\v193\images\layers.png" />
    <EmbeddedResource Include="Webs\Leaflet\v193\images\layers-2x.png" />
    <EmbeddedResource Include="Webs\Leaflet\res\icon-c.png" />
    <EmbeddedResource Include="Webs\Leaflet\res\icon-b.png" />
    <EmbeddedResource Include="Webs\Leaflet\res\icon-a.png" />
    <EmbeddedResource Include="Webs\Leaflet\proj4leaflet.min.js" />
    <EmbeddedResource Include="Webs\Leaflet\proj4.js" />
    <EmbeddedResource Include="Webs\Leaflet\leaflet.js" />
    <EmbeddedResource Include="Webs\Leaflet\leaflet.css" />
    <EmbeddedResource Include="Webs\Leaflet\leaflet.ChineseTmsProviders.js" />
    <EmbeddedResource Include="Webs\Leaflet\leaflet-mapbox-gl.js" />
    <EmbeddedResource Include="Webs\Leaflet\leaflet-bing-layer.js" />
    <EmbeddedResource Include="Webs\icon-o.png" />
    <EmbeddedResource Include="Webs\icon-d.png" />
    <EmbeddedResource Include="Webs\icon-c.png" />
    <EmbeddedResource Include="Webs\icon-b.png" />
    <EmbeddedResource Include="Webs\icon-a.png" />
    <EmbeddedResource Include="Webs\Google\t-tile.html" />
    <EmbeddedResource Include="Webs\Google\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\Google\t-tile-maptalks.html" />
    <EmbeddedResource Include="Webs\Google\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Google\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Google\t-preview.html" />
    <EmbeddedResource Include="Webs\Google\t-preview-old.html" />
    <EmbeddedResource Include="Webs\Google\t-pos.html" />
    <EmbeddedResource Include="Webs\gis.js" />
    <None Include="Webs\Gaode\v2.0\form.html" />
    <None Include="Webs\Gaode\v2.0\controls.html" />
    <None Include="Webs\Gaode\v2.0\basic3d.html" />
    <None Include="Webs\Gaode\v2.0\basic.html" />
    <None Include="Webs\Gaode\v1.4\tile-watermark.html" />
    <None Include="Webs\Gaode\v1.4\tile-canvas.html" />
    <None Include="Webs\Gaode\v1.4\search.html" />
    <None Include="Webs\Gaode\v1.4\region.html" />
    <None Include="Webs\Gaode\v1.4\rect2.html" />
    <None Include="Webs\Gaode\v1.4\rect.html" />
    <None Include="Webs\Gaode\v1.4\pos.html" />
    <None Include="Webs\Gaode\v1.4\poly.html" />
    <None Include="Webs\Gaode\v1.4\marker.html" />
    <None Include="Webs\Gaode\v1.4\layer.html" />
    <None Include="Webs\Gaode\v1.4\layer-image.html" />
    <None Include="Webs\Gaode\v1.4\component.html" />
    <None Include="Webs\Gaode\v1.4\basic.html" />
    <None Include="Webs\Gaode\v1.4\3d.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-v2.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-v1.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-maptalks.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Gaode\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Gaode\t-preview.html" />
    <EmbeddedResource Include="Webs\Gaode\t-preview-old.html" />
    <EmbeddedResource Include="Webs\Gaode\t-preview-220624.html" />
    <EmbeddedResource Include="Webs\Gaode\t-pos.html" />
    <None Include="Webs\Cesium\readme.txt" />
    <None Include="Webs\Cesium\hello.html" />
    <None Include="Webs\Cesium\cm-tiandi.html" />
    <None Include="Webs\Cesium\cm-tencent.html" />
    <None Include="Webs\Cesium\cm-google.html" />
    <None Include="Webs\Cesium\cm-gaode.html" />
    <None Include="Webs\Cesium\cm-baidu.html" />
    <None Include="Webs\Cesium\cesium-tiandi.html" />
    <EmbeddedResource Include="Webs\Cesium\cesium-map.js" />
    <None Include="Webs\Cesium\cesium-gaode.html" />
    <None Include="Webs\Cesium\cesium-bing.html" />
    <None Include="Webs\Cesium\cesium-baidu.html" />
    <EmbeddedResource Include="Webs\Bing\t-tile.html" />
    <EmbeddedResource Include="Webs\Bing\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\Bing\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Bing\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Bing\t-preview.html" />
    <EmbeddedResource Include="Webs\Bing\t-preview-old.html" />
    <EmbeddedResource Include="Webs\Bing\t-preview-220624.html" />
    <EmbeddedResource Include="Webs\Bing\t-pos.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\tile.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\rect.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\pos.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\poly.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\marker.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\ground.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\coord.html" />
    <EmbeddedResource Include="Webs\Bing\jsdemo\base.html" />
    <None Include="Webs\Baidu\v3.0\tile.html" />
    <None Include="Webs\Baidu\v3.0\style.html" />
    <None Include="Webs\Baidu\v3.0\region.html" />
    <None Include="Webs\Baidu\v3.0\rect.html" />
    <None Include="Webs\Baidu\v3.0\pos.html" />
    <None Include="Webs\Baidu\v3.0\event.html" />
    <None Include="Webs\Baidu\v3.0\basic.html" />
    <None Include="Webs\Baidu\v2.0\rect.html" />
    <None Include="Webs\Baidu\v2.0\pos.html" />
    <None Include="Webs\Baidu\v2.0\marker.html" />
    <None Include="Webs\Baidu\v2.0\ground.html" />
    <None Include="Webs\Baidu\v2.0\custom-control.html" />
    <None Include="Webs\Baidu\v2.0\bmap.html" />
    <None Include="Webs\Baidu\v2.0\basic.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-webgl.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-v3.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-v2.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-openlayers.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-maptalks.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-leaflet.html" />
    <EmbeddedResource Include="Webs\Baidu\t-tile-cesium.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-v3.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-old.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-ok.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-3.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-220624.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-220618.html" />
    <EmbeddedResource Include="Webs\Baidu\t-preview-2.html" />
    <EmbeddedResource Include="Webs\Baidu\t-pos.html" />
    <EmbeddedResource Include="Webs\Baidu\t-pos-v3.html" />
    <EmbeddedResource Include="Webs\Cesium\Cesium.zip" />
    <None Include="Webs\Leaflet\eg\bingmap\CHANGELOG.md" />
    <None Include="Webs\Leaflet\eg\bingmap\package.json" />
    <None Include="Webs\Leaflet\eg\bingmap\README.md" />
    <None Include="Webs\Leaflet\eg\chinese\package.json" />
    <None Include="Webs\Leaflet\eg\chinese\README.md" />
    <None Include="Webs\Leaflet\eg\dist\leaflet-src.esm.js.map" />
    <None Include="Webs\Leaflet\eg\dist\leaflet-src.js.map" />
    <None Include="Webs\Leaflet\eg\dist\leaflet.js.map" />
    <None Include="Webs\Leaflet\v193\leaflet-src.esm.js.map" />
    <None Include="Webs\Leaflet\v193\leaflet-src.js.map" />
    <None Include="Webs\Leaflet\v193\leaflet.js.map" />
    <None Include="Webs\MapBox\etc\tutorials--mapbox-arcgis-qgis--qgis-create-wmts-connection-960-bce2d82109d05c7be23e97292efe559c.webp" />
    <None Include="Webs\MapTalks\eg\guizhou\guizhou-border.json" />
    <None Include="Webs\MapTalks\eg\guizhou\guizhou.json" />
    <None Include="Webs\MapTalks\readme.md" />
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>


